---
title: 'Runtime Config'
description: 'Next.jsアプリにクライアントとサーバーのランタイム設定を追加します。'
---

> **警告：**
>
> - **この機能は廃止予定です。** 代わりに[環境変数](https://nextjs.org/docs/canary/pages/building-your-application/configuring/environment-variables)を使用することをお勧めします；これによりランタイム値の読み込みもサポートできます。
> - サーバーの起動時にコードを実行するには、[`register` 関数](/docs/app/building-your-application/optimizing/instrumentation)を使用できます。
> - この機能は[Automatic Static Optimization](https://nextjs.org/docs/canary/pages/building-your-application/rendering/automatic-static-optimization)、[Output File Tracing](https://nextjs.org/docs/canary/pages/api-reference/config/next-config-js/output#automatically-copying-traced-files)、または[React Server Components](/docs/app/building-your-application/rendering/server-components)と一緒に動作しません。

アプリにランタイム設定を追加するには、`next.config.js` を開いて、`publicRuntimeConfig` と `serverRuntimeConfig` の設定を追加してください：

```js title="next.config.js"
module.exports = {
  serverRuntimeConfig: {
    // サーバー側でのみ利用可能
    mySecret: 'secret',
    secondSecret: process.env.SECOND_SECRET, // 環境変数を通過
  },
  publicRuntimeConfig: {
    // サーバーおよびクライアントの両方で使用可能
    staticFolder: '/static',
  },
}
```

サーバー専用のランタイム設定は `serverRuntimeConfig` の下に配置してください。

クライアントとサーバーのコードの両方にアクセス可能なものは `publicRuntimeConfig` の下に配置する必要があります。

> `publicRuntimeConfig` に依存するページは、`getInitialProps` または `getServerSideProps` を使用する**必要**があります；もしくは、`getInitialProps` を持つ[カスタムApp](https://nextjs.org/docs/canary/pages/building-your-application/routing/custom-app)を使用して、[Automatic Static Optimization](https://nextjs.org/docs/canary/pages/building-your-application/rendering/automatic-static-optimization)を無効化する必要があります；ランタイム設定はサーバーサイドでレンダリングされない限り、ページ（またはページ内のコンポーネント）には使用できません。

アプリ内でランタイム設定にアクセスするには、次のように `next/config` を使用します：

```jsx
import getConfig from 'next/config'
import Image from 'next/image'

// serverRuntimeConfig と publicRuntimeConfig のみを保持
const { serverRuntimeConfig, publicRuntimeConfig } = getConfig()
// サーバー側でのみ利用可能
console.log(serverRuntimeConfig.mySecret)
// サーバーとクライアントの両方で利用可能
console.log(publicRuntimeConfig.staticFolder)

function MyImage() {
  return (
    <div>
      <Image
        src={`${publicRuntimeConfig.staticFolder}/logo.png`}
        alt="logo"
        layout="fill"
      />
    </div>
  )
}

export default MyImage
```

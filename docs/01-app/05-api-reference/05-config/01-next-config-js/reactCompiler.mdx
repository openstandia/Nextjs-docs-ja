---
title: 'reactCompiler'
description: 'React Compilerを有効にして、コンポーネントのレンダリングを自動的に最適化します。'
version: 'experimental'
---

Next.jsは、コンポーネントのレンダリングを自動的に最適化することでパフォーマンスを向上させるために設計された[React Compiler](https://react.dev/learn/react-compiler)をサポートしています。これにより、`useMemo`や`useCallback`を使用した手動のメモ化の必要性が減少します。

Next.jsには、React Compilerをより効率的にするためにSWCで書かれたカスタムのパフォーマンス最適化が含まれています。すべてのファイルに対してコンパイラを実行するのではなく、Next.jsはプロジェクトを分析し、関連するファイルにのみReact Compilerを適用します。これにより、不要な作業を避け、Babelプラグインを単独で使用する場合と比較してビルドが高速化されます。

## 仕組み {#how-it-works}

React CompilerはBabelプラグインを通じて実行されます。ビルドを高速に保つために、Next.jsはカスタムのSWC最適化を使用し、JSXやReact Hooksを含む関連ファイルにのみReact Compilerを適用します。

これにより、すべてをコンパイルすることを避け、パフォーマンスコストを最小限に抑えます。デフォルトのRustベースのコンパイラと比較して、ビルドがわずかに遅くなることがありますが、その影響は小さく局所的です。

使用するには、`babel-plugin-react-compiler`をインストールします：

```bash title="Terminal"
npm install babel-plugin-react-compiler
```

次に、`next.config.js`に`experimental.reactCompiler`オプションを追加します：

<Tabs>
<TabItem value="ts" label="TypeScript">

```ts title="next.config.ts" switcher
import type { NextConfig } from 'next'

const nextConfig: NextConfig = {
  experimental: {
    reactCompiler: true,
  },
}

export default nextConfig
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="next.config.js" switcher
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    reactCompiler: true,
  },
}

module.exports = nextConfig
```

</TabItem>
</Tabs>

## アノテーション {#annotations}

コンパイラを「オプトイン」モードで実行するように設定できます：

<Tabs>
<TabItem value="ts" label="TypeScript">

```ts title="next.config.ts" switcher
import type { NextConfig } from 'next'

const nextConfig: NextConfig = {
  experimental: {
    reactCompiler: {
      compilationMode: 'annotation',
    },
  },
}

export default nextConfig
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="next.config.js" switcher
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    reactCompiler: {
      compilationMode: 'annotation',
    },
  },
}

module.exports = nextConfig
```

</TabItem>
</Tabs>

次に、特定のコンポーネントやフックに対してReactの`"use memo"`ディレクティブを使用してオプトインできます：

<Tabs>
<TabItem value="ts" label="TypeScript">

```ts title="app/page.tsx" switcher
export default function Page() {
  'use memo'
  // ...
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/page.js" switcher
export default function Page() {
  'use memo'
  // ...
}
```

</TabItem>
</Tabs>

> **Note:** 逆の効果を得るために、コンポーネントやフックをオプトアウトするには、Reactの`"use no memo"`ディレクティブを使用することもできます。

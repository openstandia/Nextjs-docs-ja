---
title: 'カスタム Next.js キャッシュハンドラー'
nav_title: 'cacheHandler'
description: 'Redis、Memcached、その他の外部サービスを使用してデータを保存および再検証するための Next.js キャッシュを設定します。'
---

ページのキャッシュと再検証（Incremental Static Regeneration を使用）は、同じ共有キャッシュを使用します。[Vercel にデプロイする際](https://vercel.com/docs/incremental-static-regeneration?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)、ISR キャッシュは自動的に耐久性のあるストレージに保存されます。

セルフホスティングの場合、ISR キャッシュは Next.js サーバーのファイルシステム（ディスク上）に保存されます。これは、Pages Router と App Router の両方を使用してセルフホスティングする場合に自動的に機能します。

キャッシュされたページとデータを耐久性のあるストレージに保存したり、Next.js アプリケーションの複数のコンテナやインスタンス間でキャッシュを共有したりする場合は、Next.js キャッシュの場所を設定できます。

```js title="next.config.js"
module.exports = {
  cacheHandler: require.resolve('./cache-handler.js'),
  cacheMaxMemorySize: 0, // デフォルトのメモリ内キャッシュを無効にする
}
```

[カスタムキャッシュハンドラー](/docs/app/guides/self-hosting#configuring-caching)の例を参照し、実装について詳しく学んでください。

## API リファレンス {#api-reference}

キャッシュハンドラーは、次のメソッドを実装できます：`get`、`set`、および `revalidateTag`。

### `get()` {#get}

| パラメーター | 型       | 説明                       |
| ------------ | -------- | -------------------------- |
| `key`        | `string` | キャッシュされた値のキー。 |

キャッシュされた値を返すか、見つからない場合は `null` を返します。

### `set()` {#set}

| パラメーター | 型                 | 説明                       |
| ------------ | ------------------ | -------------------------- |
| `key`        | `string`           | データを保存するキー。     |
| `data`       | Data または `null` | キャッシュするデータ。     |
| `ctx`        | `{ tags: [] }`     | 提供されたキャッシュタグ。 |

`Promise<void>` を返します。

### `revalidateTag()` {#revalidatetag}

| パラメーター | 型                         | 説明                       |
| ------------ | -------------------------- | -------------------------- |
| `tag`        | `string` または `string[]` | 再検証するキャッシュタグ。 |

`Promise<void>` を返します。[データの再検証](/docs/app/building-your-application/data-fetching/incremental-static-regeneration)や [`revalidateTag()`](/docs/app/api-reference/functions/revalidateTag) 関数について詳しく学んでください。

**Good to know:**

- `revalidatePath` はキャッシュタグの上にある便利なレイヤーです。`revalidatePath` を呼び出すと、`revalidateTag` 関数が呼び出され、その後、パスに基づいてキャッシュキーにタグを付けるかどうかを選択できます。

## バージョン履歴 {#version-history}

| バージョン | 変更内容                                                            |
| ---------- | ------------------------------------------------------------------- |
| `v14.1.0`  | `cacheHandler` に名前が変更され、安定版になりました。               |
| `v13.4.0`  | `revalidateTag` のための `incrementalCacheHandlerPath` サポート。   |
| `v13.4.0`  | スタンドアロン出力のための `incrementalCacheHandlerPath` サポート。 |
| `v12.2.0`  | 実験的な `incrementalCacheHandlerPath` が追加されました。           |

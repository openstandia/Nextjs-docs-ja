---
title: 'カスタム Next.js キャッシュハンドラー'
nav_title: 'cacheHandler'
description: 'Next.js のキャッシュを Redis、Memcached などの外部サービスで使用するように設定します。'
---

Next.js のキャッシュの保存場所を設定することで、キャッシュされたページやデータを永続的なストレージに保存したり、複数のコンテナや Next.js アプリケーションのインスタンス間でキャッシュを共有したりできます。

```js title="next.config.js"
module.exports = {
  cacheHandler: require.resolve('./cache-handler.js'),
  cacheMaxMemorySize: 0, // デフォルトのメモリ内キャッシュを無効化
}
```

[カスタムキャッシュハンドラー](/docs/app/guides/self-hosting#configuring-caching)の例を参照し、実装について詳しく学んでください。

## API リファレンス {#api-reference}

キャッシュハンドラーは、次のメソッドを実装できます：`get`、`set`、`revalidateTag`、および `resetRequestCache`。

### `get()` {#get}

| パラメーター | 型       | 説明                       |
| ------------ | -------- | -------------------------- |
| `key`        | `string` | キャッシュされた値のキー。 |

キャッシュされた値を返すか、見つからない場合は `null` を返します。

### `set()` {#set}

| パラメーター | 型                 | 説明                       |
| ------------ | ------------------ | -------------------------- |
| `key`        | `string`           | データを保存するキー。     |
| `data`       | Data または `null` | キャッシュするデータ。     |
| `ctx`        | `{ tags: [] }`     | 提供されたキャッシュタグ。 |

`Promise<void>` を返します。

### `revalidateTag()` {#revalidatetag}

| パラメーター | 型                         | 説明                       |
| ------------ | -------------------------- | -------------------------- |
| `tag`        | `string` または `string[]` | 再検証するキャッシュタグ。 |

`Promise<void>` を返します。[データの再検証](/docs/app/building-your-application/data-fetching/incremental-static-regeneration)や [`revalidateTag()`](/docs/app/api-reference/functions/revalidateTag) 関数について詳しく学んでください。

### `resetRequestCache()` {#resetrequestcache}

このメソッドは、次のリクエストの前に単一のリクエストの一時的なメモリ内キャッシュをリセットします。

`void` を返します。

**Good to know:**

- `revalidatePath` はキャッシュタグの上にある便利なレイヤーです。`revalidatePath` を呼び出すと、`revalidateTag` 関数が呼び出され、その後、パスに基づいてキャッシュキーにタグを付けるかどうかを選択できます。

## プラットフォームサポート {#platform-support}

| デプロイオプション                                                    | サポート状況         |
| --------------------------------------------------------------------- | -------------------- |
| [Node.js サーバー](/docs/app/getting-started/deploying#nodejs-server) | はい                 |
| [Docker コンテナ](/docs/app/getting-started/deploying#docker)         | はい                 |
| [静的エクスポート](/docs/app/getting-started/deploying#static-export) | いいえ               |
| [アダプター](/docs/app/getting-started/deploying#adapters)            | プラットフォーム固有 |

Next.js をセルフホスティングする際の [ISR の設定](/docs/app/guides/self-hosting#caching-and-isr)方法を学んでください。

## バージョン履歴 {#version-history}

| バージョン | 変更内容                                                            |
| ---------- | ------------------------------------------------------------------- |
| `v14.1.0`  | `cacheHandler` に名前が変更され、安定版になりました。               |
| `v13.4.0`  | `revalidateTag` のための `incrementalCacheHandlerPath` サポート。   |
| `v13.4.0`  | スタンドアロン出力のための `incrementalCacheHandlerPath` サポート。 |
| `v12.2.0`  | 実験的な `incrementalCacheHandlerPath` が追加されました。           |

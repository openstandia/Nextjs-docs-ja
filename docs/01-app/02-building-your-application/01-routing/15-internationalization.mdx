---
title: 'Internationalization'
description: '国際化されたルーティングとローカライズされたコンテンツで複数の言語をサポートする方法を追加します。'
---

Next.jsを使用すると、ルーティングとコンテンツのレンダリングを設定して複数の言語をサポートすることができます。サイトをさまざまなロケールに適応させるには、翻訳されたコンテンツ（ローカライズ）と国際化されたルートを含める必要があります。

## 用語 {#terminology}

- **Locale（ロケール）:** 言語と書式設定のプリファレンスのセットを識別するための識別子です。通常、ユーザーの好みの言語および場合によっては地理的な地域を含みます。
  - `en-US`: アメリカ英語
  - `nl-NL`: オランダのオランダ語
  - `nl`: 地域を指定しないオランダ語

## ルーティングの概要 {#routing-overview}

ユーザーのブラウザーでの言語プリファレンスを使用して、使用するロケールを選択することをお勧めします。優先言語を変更すると、アプリケーションへの受信 `Accept-Language` ヘッダーが変更されます。

たとえば、次のライブラリを使用して、受信した `Request` を見て、サポートする予定のロケールやデフォルトのロケールに基づいてどのロケールを選択するかを決定することができます。

```js title="middleware.js"
import { match } from '@formatjs/intl-localematcher'
import Negotiator from 'negotiator'

// ヘッダーを定義します
let headers = { 'accept-language': 'en-US,en;q=0.5' }
// 言語をネゴシエーターで取得します
let languages = new Negotiator({ headers }).languages()
// サポートするロケールを配列で定義します
let locales = ['en-US', 'nl-NL', 'nl']
// デフォルトロケールを設定します
let defaultLocale = 'en-US'

// 言語をマッチさせます
match(languages, locales, defaultLocale) // -> 'en-US'
```

ルーティングはサブパス (`/fr/products`) またはドメイン (`my-site.fr/products`) によって国際化できます。この情報があれば、次に示す[Middleware](/docs/app/building-your-application/routing/middleware)内部でロケールに基づいてユーザーをリダイレクトできるようになります。

```js title="middleware.js"
import { NextResponse } from "next/server";

let locales = ['en-US', 'nl-NL', 'nl']

// 上記と同様に、ロケールを取得する、またはライブラリを使用する
function getLocale(request) { ... }

export function middleware(request) {
  // パス名にサポートされているロケールが含まれているかを確認します
  const { pathname } = request.nextUrl
  const pathnameHasLocale = locales.some(
    (locale) => pathname.startsWith(`/${locale}/`) || pathname === `/${locale}`
  )

  if (pathnameHasLocale) return

  // ロケールがない場合はリダイレクトします
  const locale = getLocale(request)
  request.nextUrl.pathname = `/${locale}${pathname}`
  // 例: 受信リクエストが /products の場合
  // 新しいURLは /en-US/products になります
  return NextResponse.redirect(request.nextUrl)
}

export const config = {
  matcher: [
    // すべての内部パス (_next) をスキップします
    '/((?!_next).*)',
    // オプション: ルート (/) URL のみで実行します
    // '/'
  ],
}
```

最後に、`app/`内のすべての特別なファイルが`app/[lang]`の下にネストされていることを確認します。これにより、Next.js routerはルート内で異なるロケールを動的に処理でき、`lang`パラメーターをすべてのレイアウトやページに転送します。例えば：

```jsx title="app/[lang]/page.js"
// 現在のロケールにアクセスできます
// 例: /en-US/products -> `lang`は "en-US"
export default async function Page({ params: { lang } }) {
  return ...
}
```

root レイアウトも新しいフォルダにネストできます（例：`app/[lang]/layout.js`）。

## ローカライズ {#localization}

ユーザーの好みのロケールに基づいて表示されるコンテンツを変更すること、つまりローカライズは、Next.jsに特有のものではありません。以下に示すパターンは、どのWebアプリケーションでも同じように動作します。

アプリケーション内で英語とオランダ語のコンテンツの両方をサポートしたいと仮定します。2つの異なる「辞書」を維持する必要があります。それらは、いくつかのキーからローカライズされた文字列へのマッピングを提供するオブジェクトです。例えば：

```json title="dictionaries/en.json"
{
  "products": {
    "cart": "Add to Cart"
  }
}
```

```json title="dictionaries/nl.json"
{
  "products": {
    "cart": "Toevoegen aan Winkelwagen"
  }
}
```

次に、要求されたロケールの翻訳をロードするための`getDictionary`関数を作成できます：

```jsx title="app/[lang]/dictionaries.js"
import 'server-only'

// 辞書へのインポートを定義します
const dictionaries = {
  en: () => import('./dictionaries/en.json').then((module) => module.default),
  nl: () => import('./dictionaries/nl.json').then((module) => module.default),
}

// `getDictionary`関数で辞書を取得します
export const getDictionary = async (locale) => dictionaries[locale]()
```

選択された現在の言語をもとに、レイアウトまたはページ内で辞書を取得できます。

```jsx title="app/[lang]/page.js"
import { getDictionary } from './dictionaries'

export default async function Page({ params: { lang } }) {
  const dict = await getDictionary(lang) // en
  return <button>{dict.products.cart}</button> // Add to Cart
}
```

`app/`ディレクトリ内のすべてのレイアウトとページはデフォルトで[Server Components](/docs/app/building-your-application/rendering/server-components)のため、トランスレーションファイルのサイズがクライアントサイドのJavaScriptバンドルサイズに影響を与えることを心配する必要はありません。このコードは**サーバーでのみ実行され**、結果のHTMLのみがブラウザーに送信されます。

## 静的生成 {#static-generation}

特定のロケールセットに対して静的ルートを生成するには、ページやレイアウトごとに`generateStaticParams`を使用できます。これはグローバルに設定できます。たとえば、root レイアウトで：

```jsx title="app/[lang]/layout.js"
export async function generateStaticParams() {
  return [{ lang: 'en-US' }, { lang: 'de' }]
}

export default function Root({ children, params }) {
  return (
    <html lang={params.lang}>
      <body>{children}</body>
    </html>
  )
}
```

## リソース {#resources}

- [Minimal i18n routing and translations](https://github.com/vercel/next.js/tree/canary/examples/i18n-routing)
- [`next-intl`](https://next-intl-docs.vercel.app/docs/next-13)
- [`next-international`](https://github.com/QuiiBz/next-international)
- [`next-i18n-router`](https://github.com/i18nexus/next-i18n-router)
- [`paraglide-next`](https://inlang.com/m/osslbuzt/paraglide-next-i18n)
- [`lingui`](https://lingui.dev)

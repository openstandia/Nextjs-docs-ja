---
title: 'Video Optimization'
nav_title: 'Videos'
description: 'Next.jsアプリケーションでのビデオ最適化に関する推奨事項とベストプラクティス。'
---

このページでは、Next.jsアプリケーションでビデオを使用する方法を説明し、パフォーマンスに影響を与えずにビデオファイルを保存し表示する方法を紹介します。

## `<video>`および`<iframe>`の使用 {#using-video-and-iframe}

ビデオは、直接動画ファイル用のHTML **`<video>`**タグと外部プラットフォームにホストされた動画用の **`<iframe>`**を使用してページに埋め込むことができます。

### `<video>` {#video}

HTMLの[`<video>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video)タグは、自己ホストまたは直接配信されたビデオコンテンツを埋め込むことができ、再生と外観に完全な制御を提供します。

```jsx title="app/ui/video.jsx"
export function Video() {
  return (
    <video width="320" height="240" controls preload="none">
      <source src="/path/to/video.mp4" type="video/mp4" />
      <track
        src="/path/to/captions.vtt"
        kind="subtitles"
        srcLang="en"
        label="English"
      />
      Your browser does not support the video tag.
    </video>
  )
}
```

### 一般的な`<video>`タグの属性 {#common-video-tag-attributes}

| 属性          | 説明                                                                                                            | 例                                   |
| ------------- | --------------------------------------------------------------------------------------------------------------- | ------------------------------------ |
| `src`         | 動画ファイルのソースを指定します                                                                                | `<video src="/path/to/video.mp4" />` |
| `width`       | ビデオプレーヤーの幅を設定します                                                                                | `<video width="320" />`              |
| `height`      | ビデオプレーヤーの高さを設定します                                                                              | `<video height="240" />`             |
| `controls`    | 存在する場合、デフォルトの再生コントロールセットを表示します                                                    | `<video controls />`                 |
| `autoPlay`    | ページがロードされたときに自動でビデオの再生を開始します；注意：オートプレイポリシーはブラウザ間で異なります；  | `<video autoPlay />`                 |
| `loop`        | ビデオの再生をループします                                                                                      | `<video loop />`                     |
| `muted`       | デフォルトでオーディオをミュートにします；`autoPlay`と一緒に使用されることがよくあります；                      | `<video muted />`                    |
| `preload`     | ビデオのプリロード方法を指定します；値：`none`、`metadata`、`auto`；                                            | `<video preload="none" />`           |
| `playsInline` | iOSデバイスでのインライン再生を可能にします；iOS Safariでの自動再生を機能させるために必要なことがよくあります； | `<video playsInline />`              |

> **Good to know**: `autoPlay`属性を使用する場合、ほとんどのブラウザでビデオが自動再生されるようにするために`muted`属性も追加することが重要で、iOSデバイスとの互換性のために`playsInline`属性を追加します；

ビデオ属性の完全なリストについては、[MDNドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video#attributes)を参照してください。

### ビデオのベストプラクティス {#video-best-practices}

- **フォールバックコンテンツ:** `<video>`タグを使用する場合、ビデオ再生をサポートしていないブラウザのためにタグ内にフォールバックコンテンツを含めます
- **字幕またはキャプション:** 聴覚障がいのあるユーザーのために字幕やキャプションを含めます；`<track>`タグをビデオ要素と共に利用して字幕ファイルのソースを指定します
- **アクセス可能なコントロール:** 標準のHTML5ビデオコントロールは、キーボードナビゲーションとスクリーンリーダーとの互換性のために推奨されます；高度なニーズには、[react-player](https://github.com/cookpete/react-player)や[video.js](https://videojs.com/)など、アクセス可能なコントロールと一貫性のあるブラウザ体験を提供するサードパーティープレーヤーを検討してください

### `<iframe>` {#iframe}

HTMLの`<iframe>`タグを使用すると、YouTubeやVimeoのような外部プラットフォームからビデオを埋め込むことができます；

```jsx title="app/page.jsx"
export default function Page() {
  return (
    <iframe src="https://www.youtube.com/embed/19g66ezsKAg" allowFullScreen />
  )
}
```

### 一般的な`<iframe>`タグの属性 {#common-iframe-tag-attributes}

| 属性              | 説明                                                               | 例                                     |
| ----------------- | ------------------------------------------------------------------ | -------------------------------------- |
| `src`             | 埋め込むページのURLです；                                          | `<iframe src="https://example.com" />` |
| `width`           | iframeの幅を設定します；                                           | `<iframe width="500" />`               |
| `height`          | iframeの高さを設定します；                                         | `<iframe height="300" />`              |
| `allowFullScreen` | iframeコンテンツを全画面モードで表示することを許可します；         | `<iframe allowFullScreen />`           |
| `sandbox`         | iframe内のコンテンツに追加の制限をかけます；                       | `<iframe sandbox />`                   |
| `loading`         | 読み込みの動作を最適化します（例：遅延読み込み）；                 | `<iframe loading="lazy" />`            |
| `title`           | iframeのアクセシビリティをサポートするためのタイトルを提供します； | `<iframe title="Description" />`       |

iframeの属性の完全なリストについては、[MDNドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attributes)を参照してください。

### ビデオ埋め込み方法の選択 {#choosing-a-video-embedding-method}

Next.jsアプリケーションでビデオを埋め込むには、以下の2つの方法があります：

- **自己ホストまたは直接動画ファイルの場合：** `<video>`タグを使用して自己ホストのビデオを埋め込むことで、プレーヤーの機能や外観に対する詳細な制御が必要なシナリオに対応します；この統合方法は、Next.js内でビデオコンテンツのカスタマイズと制御を可能にします
- **ビデオホスティングサービス（YouTube、Vimeoなど）を使用する場合：** YouTubeやVimeoのような動画ホスティングサービスには、`<iframe>`タグを使用するiframeベースのプレーヤーを埋め込みます；この方法はプレーヤーに対する制御が多少制限されますが、これらのプラットフォームが提供する使いやすさと機能を享受できます

アプリケーションの要件や提供したいユーザーエクスペリエンスに合わせて適切な埋め込み方法を選択してください；

### 外部ホストビデオの埋め込み {#embedding-externally-hosted-videos}

外部プラットフォームからビデオを埋め込むために、Next.jsを使用してビデオ情報を取得し、React Suspenseを使ってロード中のフォールバック状態を処理することができます；

**1. ビデオ埋め込み用のServer Componentを作成する**

まず、適切なiframeを生成するための[Server Component](https://nextjs.org/docs/app/building-your-application/rendering/server-components)を作成します。このコンポーネントはビデオのソースURLを取得し、iframeをレンダリングします；

```jsx title="app/ui/video-component.jsx"
export default async function VideoComponent() {
  const src = await getVideoSrc()

  return <iframe src={src} allowFullScreen />
}
```

**2. React Suspenseを使用してビデオコンポーネントをストリーム配信する**

ビデオを埋め込むためのServer Componentを作成した後、次に [React Suspense](https://react.dev/reference/react/Suspense)を使用してコンポーネントを[ストリーム配信](https://nextjs.org/docs/app/building-your-application/routing/loading-ui-and-streaming)するステップに進みます。

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import VideoComponent from '../ui/VideoComponent.jsx'

export default function Page() {
  return (
    <section>
      <Suspense fallback={<p>Loading video...</p>}>
        <VideoComponent />
      </Suspense>
      {/* その他のページコンテンツ */}
    </section>
  )
}
```

> **Good to know**: 外部プラットフォームからビデオを埋め込む際は、以下のベストプラクティスを考慮してください：
>
> - ビデオ埋め込みがレスポンシブであることを確認してください；iframeやビデオプレーヤーをさまざまな画面サイズに適応させるためにCSSを使用します；
> - 特にデータプランが限られているユーザーのために、ネットワーク状況に基づく[ビデオ読み込み戦略](https://yoast.com/site-speed-tips-for-faster-video/)を実装してください；

このアプローチを取ることで、ページがブロックされることを防ぎ、ユーザーがビデオコンポーネントがストリーム配信される間にページとインタラクトできるようにすることで、より良いユーザーエクスペリエンスを提供します；

より魅力的で情報的な読み込み体験を提供するために、フォールバックUIとして読み込みスケルトンを使用することを検討してください；単純な読み込みメッセージを表示する代わりに、ビデオプレーヤーに似たスケルトンを表示することで、次のようにすることができます：

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import VideoComponent from '../ui/VideoComponent.jsx'
import VideoSkeleton from '../ui/VideoSkeleton.jsx'

export default function Page() {
  return (
    <section>
      <Suspense fallback={<VideoSkeleton />}>
        <VideoComponent />
      </Suspense>
      {/* その他のページコンテンツ */}
    </section>
  )
}
```

## 自己ホストビデオ {#self-hosted-videos}

自己ホストビデオには、いくつかの理由で優れた選択肢となるかもしれません：

- **完全な制御と独立性**: 自己ホストングは、再生から外観まで、ビデオコンテンツを直接管理することを可能にし、外部プラットフォームの制約から自由な完全な所有権と制御を確保できます；
- **特定のニーズに合わせたカスタマイズ**: 動的な背景ビデオのような特別な要件に最適であり、デザインや機能のニーズに合わせたカスタマイズを許可します；
- **パフォーマンスとスケーラビリティの考慮**: 効果的にトラフィックとコンテンツサイズの増加をサポートするために、高性能でスケーラブルなストレージソリューションを選択してください；
- **コストと統合**: Next.jsフレームワークおよび広範な技術エコシステムへの簡単な統合とのバランスを考慮しつつ、ストレージと帯域幅のコストを調整してください；

### Vercel Blobを使用したビデオホスティング {#using-vercel-blob-for-video-hosting}

[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)は、Next.jsとよく連携するスケーラブルなクラウドストレージソリューションを提供し、ビデオをホストする効率的な方法を提供します。Vercel Blobを使用してビデオをホストする方法は次のとおりです：

**1. Vercel Blobにビデオをアップロードする**

Vercelダッシュボードで、「ストレージ」タブに進み、[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)ストアを選択します；Blobテーブルの右上隅にある「アップロード」ボタンを見つけてクリックします。そして、アップロードしたい動画ファイルを選択します；アップロードが完了すると、ビデオファイルがBlobテーブルに表示されます；

または、サーバーアクションを使用して動画をアップロードすることもできます。詳しい手順については、[サーバー側アップロード](https://vercel.com/docs/storage/vercel-blob/server-upload)に関するVercelのドキュメントを参照してください；Vercelはまた、[クライアント側アップロード](https://vercel.com/docs/storage/vercel-blob/client-upload)もサポートしています。この方法は特定の使用ケースに適しているかもしれません；

**2. Next.jsでビデオを表示する**

ビデオがアップロードされ、保存されたら、Next.jsアプリケーションで表示できます。以下に、`<video>`タグとReact Suspenseを使用してこれを行う方法の例を示します：

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import { list } from '@vercel/blob'

export default function Page() {
  return (
    <Suspense fallback={<p>Loading video...</p>}>
      <VideoComponent fileName="my-video.mp4" />
    </Suspense>
  )
}

async function VideoComponent({ fileName }) {
  const { blobs } = await list({
    prefix: fileName,
    limit: 1,
  })
  const { url } = blobs[0]

  return (
    <video controls preload="none" aria-label="Video player">
      <source src={url} type="video/mp4" />
      Your browser does not support the video tag.
    </video>
  )
}
```

このアプローチでは、ページがビデオの`@vercel/blob` URLを使用してビデオを表示します；React Suspenseを使用してビデオURLが取得され、ビデオが表示可能になるまでフォールバックを表示します；

### ビデオに字幕を追加する {#adding-subtitles-to-your-video}

ビデオに字幕がある場合は、`<video>`タグ内にある`<track>`要素を使用して簡単に追加できます。ビデオファイルと同様に、[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)から字幕ファイルを取得することができます；ここでは、字幕を含むように`<VideoComponent>`を更新する方法を示します；

```jsx title="app/page.jsx"
async function VideoComponent({ fileName }) {
  const { blobs } = await list({
    prefix: fileName,
    limit: 2,
  })
  const { url } = blobs[0]
  const { url: captionsUrl } = blobs[1]

  return (
    <video controls preload="none" aria-label="Video player">
      <source src={url} type="video/mp4" />
      <track src={captionsUrl} kind="subtitles" srcLang="en" label="English" />
      Your browser does not support the video tag.
    </video>
  )
}
```

このアプローチに従うことで、Next.jsアプリケーションにビデオを効果的に自己ホストし統合できます；

## リソース {#resources}

ビデオの最適化とベストプラクティスの学習を継続するために、以下のリソースを参照してください：

- **ビデオフォーマットとコーデックの理解**: 互換性のためのMP4やWeb最適化のためのWebMなど、ビデオのニーズに合った適切なフォーマットとコーデックを選択してください；詳細は[Mozillaのビデオコーデックに関するガイド](https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Video_codecs)を参照してください；
- **ビデオ圧縮**: FFmpegのようなツールを使用して、品質とファイルサイズをバランスよく圧縮します；圧縮技術について[FFmpeg公式サイト](https://www.ffmpeg.org/)で学ぶことができます；
- **解像度とビットレートの調整**: [解像度とビットレート](https://www.dacast.com/blog/bitrate-vs-resolution/#:~:text=The%20two%20measure%20different%20aspects,yield%20different%20qualities%20of%20video)を閲覧プラットフォームに基づいて調整し、モバイルデバイス用に低い設定を選択します；
- **コンテンツデリバリーネットワーク（CDN）**: 仮想的にビデオ配信速度を向上させ、高トラフィックを管理するためにCDNを利用します；一部のストレージソリューションを使用する場合、例えばVercel Blobのように、CDN機能が自動的に処理されます；[CDNとその利点](https://vercel.com/docs/edge-network/overview?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)について学んでください；

Next.jsプロジェクトにビデオを統合するためのこれらのビデオストリーミングプラットフォームを探求してください：

### オープンソース`next-video`コンポーネント {#open-source-next-video-component}

- [Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)、S3、Backblaze、Muxを含むさまざまなホスティングサービスと互換性のあるNext.js用`<Video>`コンポーネントを提供します；
- 異なるホスティングサービスでの`next-video.dev`の使用に関する[詳細なドキュメント](https://next-video.dev/docs)；

### Cloudinary連携 {#cloudinary-integration}

- Next.jsとのCloudinaryの使用に関する公式の[ドキュメントと統合ガイド](https://next.cloudinary.dev/)；
- [ドロップインビデオサポート](https://next.cloudinary.dev/cldvideoplayer/basic-usage)向けの`<CldVideoPlayer>`コンポーネントを含みます；
- Next.jsとのCloudinary統合の[例](https://github.com/cloudinary-community/cloudinary-examples/?tab=readme-ov-file#nextjs)を見つけることができ、[自適応ビットレートストリーミング](https://github.com/cloudinary-community/cloudinary-examples/tree/main/examples/nextjs-cldvideoplayer-abr)を含みます；
- Node.js SDKを含む他の[Cloudinaryライブラリ](https://cloudinary.com/documentation)も利用可能です；

### Mux Video API {#mux-video-api}

- Muxは、MuxとNext.jsを使用したビデオコース作成のための[スターターテンプレート](https://github.com/muxinc/video-course-starter-kit)を提供します；
- [Next.jsアプリケーションにおける高パフォーマンスビデオ埋め込み](https://www.mux.com/for/nextjs)に関するMuxの推奨事項を学んでください；
- Next.jsを使用したMuxの[サンプルプロジェクト](https://with-mux-video.vercel.app/)を探し、体験してください；

### Fastly {#fastly}

- Next.jsにおける[オンデマンドビデオ](https://www.fastly.com/products/streaming-media/video-on-demand)とストリーミングメディアのためのFastlyソリューションの統合についてもっと学んでください；

### ImageKit.io Integration {#imagekit-io-integration}

- Next.jsとのImageKit統合のための[公式クイックスタートガイド](https://imagekit.io/docs/integration/nextjs)を確認してください；
- 統合は、[シームレスなビデオサポート](https://imagekit.io/docs/integration/nextjs#rendering-videos)を提供する`<IKVideo>`コンポーネントを提供します；
- Node.js SDKのような他の[ImageKitライブラリ](https://imagekit.io/docs)も探索することができます；

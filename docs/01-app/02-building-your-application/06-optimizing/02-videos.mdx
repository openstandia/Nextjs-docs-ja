---
title: 'Video Optimization'
nav_title: 'Videos'
description: 'Next.jsアプリケーションでのビデオ最適化に関する推奨事項とベストプラクティス'
---

このページでは、Next.jsアプリケーションでビデオを使用する方法を示し、パフォーマンスに影響を与えないようにビデオファイルを保存し表示する方法を解説します。

## `<video>`と`<iframe>`の使用 {#using-video-and-iframe}

ビデオは、HTMLの **`<video>`** タグを使用して直接ビデオファイルを埋め込み、**`<iframe>`** を使用して外部プラットフォームにホストされたビデオを表示できます。

### `<video>` {#video}

HTMLの [`<video>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video) タグを使用すると、セルフホスティングされたビデオコンテンツや直接提供されるビデオコンテンツを埋め込むことができ、再生や外観を完全に制御できます。

```jsx title="app/ui/video.jsx"
export function Video() {
  return (
    <video width="320" height="240" controls preload="none">
      <source src="/path/to/video.mp4" type="video/mp4" />
      <track
        src="/path/to/captions.vtt"
        kind="subtitles"
        srcLang="en"
        label="English"
      />
      ビデオタグをサポートしていないブラウザです。
    </video>
  )
}
```

### よく使用される`<video>`タグの属性 {#common-video-tag-attributes}

| 属性          | 説明                                                                                               | 例                                   |
| ------------- | -------------------------------------------------------------------------------------------------- | ------------------------------------ |
| `src`         | ビデオファイルのソースを指定します。                                                               | `<video src="/path/to/video.mp4" />` |
| `width`       | ビデオプレーヤーの幅を設定します。                                                                 | `<video width="320" />`              |
| `height`      | ビデオプレーヤーの高さを設定します。                                                               | `<video height="240" />`             |
| `controls`    | この属性が存在すると、既定の再生コントロールが表示されます。                                       | `<video controls />`                 |
| `autoPlay`    | ページが読み込まれると自動的にビデオを再生します。注意: 再生ポリシーはブラウザによって異なります。 | `<video autoPlay />`                 |
| `loop`        | ビデオの再生をループします。                                                                       | `<video loop />`                     |
| `muted`       | デフォルトで音声を消します。通常、`autoPlay`と併用します。                                         | `<video muted />`                    |
| `preload`     | ビデオをどのようにプリロードするかを指定します。値: `none`、`metadata`、`auto`。                   | `<video preload="none" />`           |
| `playsInline` | iOSデバイスでのインライン再生を可能にし、iOS Safariでの自動再生を動作させるのに必要です。          | `<video playsInline />`              |

> **Good to know**: `autoPlay`属性を使用するときは、多くのブラウザでビデオを自動的に再生するために`muted`属性も含めることが重要です。また、iOSデバイスとの互換性を確保するために`playsInline`属性を追加してください。

ビデオ属性の詳しいリストについては、[MDNのドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video#attributes)を参照してください。

### ビデオのベストプラクティス {#video-best-practices}

- **フォールバックコンテンツ:** `<video>`タグを使用するときは、ビデオ再生をサポートしていないブラウザのためにタグ内でフォールバックコンテンツを提供してください
- **字幕またはキャプション:** 聴覚障害があるユーザーのために字幕やキャプションを含めてください。 `<video>`要素内の[`<track>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/track)タグを使用してキャプションファイルのソースを指定します
- **アクセシブルなコントロール:** HTML5の標準ビデオコントロールは、キーボードナビゲーションやスクリーンリーダーとの互換性に推奨されます。高度なニーズのために、[react-player](https://github.com/cookpete/react-player)や[video.js](https://videojs.com/)などのサードパーティプレーヤーを検討してください。これらは、アクセス可能なコントロールと一貫したブラウザ体験を提供します

### `<iframe>` {#iframe}

HTML `<iframe>`タグを使用すると、YouTubeやVimeoなどの外部プラットフォームから動画を埋め込むことができます。

```jsx title="app/page.jsx"
export default function Page() {
  return (
    <iframe src="https://www.youtube.com/embed/19g66ezsKAg" allowFullScreen />
  )
}
```

### よく使用される`<iframe>`タグの属性 {#common-iframe-tag-attributes}

| 属性              | 説明                                                               | 例                                     |
| ----------------- | ------------------------------------------------------------------ | -------------------------------------- |
| `src`             | 埋め込むページのURLを指定します。                                  | `<iframe src="https://example.com" />` |
| `width`           | iframeの幅を設定します。                                           | `<iframe width="500" />`               |
| `height`          | iframeの高さを設定します。                                         | `<iframe height="300" />`              |
| `allowFullScreen` | iframeのコンテンツをフルスクリーンモードで表示できるようにします。 | `<iframe allowFullScreen />`           |
| `sandbox`         | iframe内のコンテンツに追加の制限を適用します。                     | `<iframe sandbox />`                   |
| `loading`         | 読み込み動作を最適化します（例：遅延読み込み）。                   | `<iframe loading="lazy" />`            |
| `title`           | iframeにタイトルを提供し、アクセシビリティをサポートします。       | `<iframe title="Description" />`       |

iframe属性の詳しいリストについては、[MDNのドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attributes)を参照してください。

### ビデオ埋め込み方法の選択 {#choosing-a-video-embedding-method}

Next.jsアプリケーションでビデオを埋め込む方法は2通りあります：

- **セルフホストまたは直接ビデオファイル:** 詳細なプレーヤーの機能や外観の制御が必要な場合、`<video>`タグを使用してセルフホストビデオを埋め込みます。このNext.jsでの統合方法により、ビデオコンテンツのカスタマイズと制御が可能です
- **ビデオホスティングサービス（YouTube、Vimeoなど）を使用する:** YouTubeやVimeoのようなビデオホスティングサービスを使用する場合、`<iframe>`タグを使用してそのiframeベースのプレーヤーを埋め込みます。この方法はプレーヤーの制御が一部制限されますが、これらのプラットフォームが提供する使いやすさと機能を提供します

アプリケーションの要件と提供したいユーザー体験に合わせ、埋め込み方法を選択してください。

### 外部にホストされたビデオの埋め込み {#embedding-externally-hosted-videos}

外部プラットフォームからビデオを埋め込むには、Next.jsを使用してビデオ情報を取得し、ReactのSuspenseで読み込み中のフォールバック状態を処理できます。

**1. ビデオ埋め込みのためのサーバーコンポーネントの作成**

最初のステップは、ビデオを埋め込むための適切なiframeを生成する[Server Component](https://nextjs.org/docs/app/building-your-application/rendering/server-components)を作成することです。このコンポーネントはビデオのソースURLを取得し、iframeをレンダリングします。

```jsx title="app/ui/video-component.jsx"
export default async function VideoComponent() {
  const src = await getVideoSrc()

  return <iframe src={src} allowFullScreen />
}
```

**2. React Suspenseを使ってビデオコンポーネントをストリーミングする**

ビデオを埋め込むためのサーバーコンポーネントを作成した後、次のステップは[React Suspense](https://react.dev/reference/react/Suspense)を使用してコンポーネントを[ストリーミング](https://nextjs.org/docs/app/building-your-application/routing/loading-ui-and-streaming)することです。

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import VideoComponent from '../ui/VideoComponent.jsx'

export default function Page() {
  return (
    <section>
      <Suspense fallback={<p>Loading video...</p>}>
        <VideoComponent />
      </Suspense>
      {/* 他のページコンテンツ */}
    </section>
  )
}
```

> **Good to know**: 外部プラットフォームからビデオを埋め込む際には、次のベストプラクティスを考慮してください：
>
> - ビデオ埋め込みがレスポンシブであることを確認します。iframeやビデオプレーヤーがさまざまな画面サイズに適応するようにCSSを使用してください
> - 特にデータプランが限られているユーザー向けに、[ネットワーク状況に基づく動画の読み込み戦略](https://yoast.com/site-speed-tips-for-faster-video/)を実装します

このアプローチは、ビデオコンポーネントがストリーミングされる間にユーザーがページと操作できるようにすることで、優れたユーザー体験につながります。

より魅力的で情報量の多い読み込み体験を提供するために、フォールバックUIとして読み込みスケルトンを使用することを検討してください。単純な読み込みメッセージを表示する代わりに、ビデオプレーヤーに似たスケルトンを次のように表示できます：

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import VideoComponent from '../ui/VideoComponent.jsx'
import VideoSkeleton from '../ui/VideoSkeleton.jsx'

export default function Page() {
  return (
    <section>
      <Suspense fallback={<VideoSkeleton />}>
        <VideoComponent />
      </Suspense>
      {/* 他のページコンテンツ */}
    </section>
  )
}
```

## セルフホストのビデオ {#self-hosted-videos}

セルフホスティングされたビデオが望ましい場合がある理由はいくつかあります：

- **完全な管理と独立性**：セルフホスティングにより、再生から外観に至るまでビデオコンテンツを直接管理することができ、外部プラットフォームの制約から自由に完全な所有権と管理が確保されます
- **特定のニーズに合わせたカスタマイズ**：動的な背景ビデオなどの特定の要件に最適で、デザインや機能のニーズに合わせたカスタマイズが可能です
- **パフォーマンスとスケーラビリティの考慮**：高トラフィックやコンテンツサイズの増加を効果的にサポートするため、高性能でスケーラブルなストレージソリューションを選択してください
- **コストと統合**：ストレージと帯域幅のコストや、Next.jsフレームワークや広範な技術エコシステムへの統合の要件とのバランスを考慮しましょう

### 動画ホスティングにVercel Blobを使用する {#using-vercel-blob-for-video-hosting}

[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)は、Next.jsと連携して効率的にビデオをホスティングできるクラウドストレージソリューションを提供します。ここではVercel Blobを使ってビデオをホスティングする方法を紹介します：

**1. Vercel Blobにビデオをアップロードする**

Vercelのダッシュボードで「ストレージ」タブに移動し、[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)ストアを選択します。Blobテーブルの右上にある「アップロード」ボタンを見つけ、クリックします。それから、アップロードしたいビデオファイルを選びます。アップロードが完了すると、ビデオファイルがBlobテーブルに表示されます。

また、サーバーアクションを使用してビデオをアップロードすることもできます。詳しい指示については[Vercelのサーバーサイドアップロードドキュメント](https://vercel.com/docs/storage/vercel-blob/server-upload)を参照してください。Vercelは[クライアントサイドのアップロードもサポートしています](https://vercel.com/docs/storage/vercel-blob/client-upload)。この方法は特定のユースケースに対して好ましいかもしれません。

**2. ビデオをNext.jsで表示する**

ビデオがアップロードされ、保存されたら、Next.jsアプリケーションで表示できます。ここでは、`<video>`タグとReact Suspenseを使用してこれを行う方法を示します：

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import { list } from '@vercel/blob'

export default function Page() {
  return (
    <Suspense fallback={<p>Loading video...</p>}>
      <VideoComponent fileName="my-video.mp4" />
    </Suspense>
  )
}

async function VideoComponent({ fileName }) {
  const { blobs } = await list({
    prefix: fileName,
    limit: 1,
  })
  const { url } = blobs[0]

  return (
    <video controls preload="none" aria-label="Video player">
      <source src={url} type="video/mp4" />
      ビデオタグをサポートしていないブラウザです。
    </video>
  )
}
```

このアプローチでは、ページがビデオの`@vercel/blob` URLを使用してビデオを表示し、`VideoComponent`を利用します。React Suspenseは、ビデオURLがフェッチされ、ビデオが表示できるまでフォールバックを表示するために使用されます。

### ビデオに字幕を追加する {#adding-subtitles-to-your-video}

ビデオに字幕がある場合、`<video>`タグ内に`<track>`要素を使って簡単に追加できます。字幕ファイルもビデオファイルと同様に[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)からフェッチできます。`<VideoComponent>`を字幕を含むように更新する方法を以下に示します。

```jsx title="app/page.jsx"
async function VideoComponent({ fileName }) {
  const { blobs } = await list({
    prefix: fileName,
    limit: 2,
  })
  const { url } = blobs[0]
  const { url: captionsUrl } = blobs[1]

  return (
    <video controls preload="none" aria-label="Video player">
      <source src={url} type="video/mp4" />
      <track src={captionsUrl} kind="subtitles" srcLang="en" label="English" />
      ビデオタグをサポートしていないブラウザです。
    </video>
  )
}
```

このアプローチに従うことで、Next.jsアプリケーションにビデオを効果的にセルフホストし、統合することができます。

## リソース {#resources}

ビデオ最適化の関連知識とベストプラクティスについて学び続けるには、次のリソースを参照してください：

- **ビデオフォーマットとコーデックの理解**：互換性のためにMP4、ウェブ最適化のためにWebMなど、ビデオニーズに合ったフォーマットとコーデックを選択してください。詳細は[Mozillaのビデオコーデックガイド](https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Video_codecs) を参照してください
- **ビデオ圧縮**：FFmpegのようなツールを使用して、品質とファイルサイズのバランスを保ちながら効果的にビデオを圧縮します。圧縮技術については[FFmpegの公式サイト](https://www.ffmpeg.org/)を参照してください
- **解像度とビットレートの調整**：視聴プラットフォームに基づいて[解像度とビットレート](https://www.dacast.com/blog/bitrate-vs-resolution/#:~:text=The%20two%20measure%20different%20aspects,yield%20different%20qualities%20of%20video)を調整し、モバイルデバイスには低い設定を適用します
- **コンテンツデリバリネットワーク（CDN）**：CDNを利用して、ビデオの配信速度を向上させ、高トラフィックを管理します。一部のストレージソリューション（例: Vercel Blob）を使用する場合、CDN機能が自動的に処理されます。CDNとその利点についての詳細は、[こちら](https://vercel.com/docs/edge-network/overview?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)をご覧ください

あなたのNext.jsプロジェクトにビデオを統合するために、これらのビデオストリーミングプラットフォームを探ってください：

### オープンソースの`next-video`コンポーネント {#open-source-next-video-component}

- [Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)、S3、Backblaze、Muxなど様々なホスティングサービスと互換性のあるNext.js用の`<Video>`コンポーネントを提供します
- 異なるホスティングサービスで`next-video.dev`を使用するための[詳細なドキュメント](https://next-video.dev/docs)

### Cloudinary統合 {#cloudinary-integration}

- Next.jsとCloudinaryを使うための[公式ドキュメントと統合ガイド](https://next.cloudinary.dev/)
- [簡単なビデオサポート](https://next.cloudinary.dev/cldvideoplayer/basic-usage)のための`<CldVideoPlayer>`コンポーネントを含む
- [適応ビットレートストリーミング](https://github.com/cloudinary-community/cloudinary-examples/tree/main/examples/nextjs-cldvideoplayer-abr)を含む、Next.jsとCloudinaryを統合した[例](https://github.com/cloudinary-community/cloudinary-examples/?tab=readme-ov-file#nextjs)を見つけよう
- Node.js SDKを含む他の[Cloudinaryライブラリー](https://cloudinary.com/documentation)も利用可能

### Mux Video API {#mux-video-api}

- MuxとNext.jsを使用してビデオコースを作成するための[Muxのスターターテンプレート](https://github.com/muxinc/video-course-starter-kit)
- Next.jsアプリケーション用の[高パフォーマンスのビデオ埋め込み](https://www.mux.com/for/nextjs)のためのMuxの推奨事項を学ぼう
- MuxとNext.jsを使用した[サンプルプロジェクト](https://with-mux-video.vercel.app/)を探そう

### Fastly {#fastly}

- Next.jsへの[ビデオ・オン・デマンド](https://www.fastly.com/products/streaming-media/video-on-demand)とストリーミングメディアのFastlyソリューションとの統合について詳しく学ぼう

### ImageKit.ioとの統合 {#imagekit-io-integration}

- Next.jsとImageKitを統合するための[公式クイックスタートガイド](https://imagekit.io/docs/integration/nextjs)をチェックしよう
- 統合はシームレスなビデオサポートを提供する`<IKVideo>`コンポーネントを提供し、他の[ImageKitライブラリー](https://imagekit.io/docs)、例えばNode.js SDKも利用できます

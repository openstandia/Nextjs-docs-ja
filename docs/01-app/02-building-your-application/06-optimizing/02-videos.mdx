---
title: 'Video Optimization'
nav_title: 'Videos'
description: 'Next.jsアプリケーションでのビデオ最適化に関する推奨事項とベストプラクティス。'
---

このページでは、Next.jsアプリケーションでのビデオの使用方法を説明し、パフォーマンスに影響を与えずにビデオファイルを保存および表示する方法を紹介します。

## `<video>` と `<iframe>` の使用 {#using-video-and-iframe}

動画は、直接のビデオファイルにはHTMLの **`<video>`** タグを、外部プラットフォームにホストされた動画には **`<iframe>`** を使用してページに埋め込むことができます。

### `<video>` {#video}

HTMLの[`<video>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video) タグを使用すると、自己ホスティングまたは直接配信されるビデオコンテンツを埋め込み、再生と外観を完全に制御できます。

```jsx title="app/ui/video.jsx"
export function Video() {
  return (
    <video width="320" height="240" controls preload="none">
      <source src="/path/to/video.mp4" type="video/mp4" />
      <track
        src="/path/to/captions.vtt"
        kind="subtitles"
        srcLang="en"
        label="English"
      />
      Your browser does not support the video tag.
    </video>
  )
}
```

### よく使用される `<video>` タグの属性 {#common-video-tag-attributes}

| 属性          | 説明                                                                                                           | サンプル値                           |
| ------------- | -------------------------------------------------------------------------------------------------------------- | ------------------------------------ |
| `src`         | 動画ファイルのソースを指定します                                                                               | `<video src="/path/to/video.mp4" />` |
| `width`       | ビデオプレーヤーの幅を設定します                                                                               | `<video width="320" />`              |
| `height`      | ビデオプレーヤーの高さを設定します                                                                             | `<video height="240" />`             |
| `controls`    | 存在する場合、デフォルトの再生コントロールセットが表示されます                                                 | `<video controls />`                 |
| `autoPlay`    | ページが読み込まれると自動的にビデオの再生を開始します。注意：自動再生のポリシーはブラウザによって異なります； | `<video autoPlay />`                 |
| `loop`        | ビデオの再生をループさせます                                                                                   | `<video loop />`                     |
| `muted`       | デフォルトで音声を無音にします。通常は`autoPlay`と共に使用します                                               | `<video muted />`                    |
| `preload`     | ビデオのプリロード方法を指定します。値：`none`、`metadata`、`auto`                                             | `<video preload="none" />`           |
| `playsInline` | iOSデバイスでインライン再生を有効にします。通常、iOSのSafariで自動再生を機能させるために必要です               | `<video playsInline />`              |

> **Good to know**: `autoPlay` 属性を使用する際は、ほとんどのブラウザでビデオを自動再生するには、`muted` 属性も含めることが重要です。また、`playsInline` 属性はiOSデバイスとの互換性を確保します；

ビデオ属性の包括的なリストについては、[MDNドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video#attributes)を参照してください。

### ビデオのベストプラクティス {#video-best-practices}

- **フォールバックコンテンツ**：`<video>` タグを使用する際に、ビデオ再生をサポートしないブラウザ向けにフォールバックコンテンツをタグ内に含めてください。
- **字幕またはキャプション**：聴覚に障害のあるユーザーのために、字幕やキャプションを含めてください。`<video>` 要素と[`<track>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/track) タグを使用してキャプションファイルのソースを指定します。
- **アクセシブルなコントロール**：キーボードナビゲーションとスクリーンリーダーと互換性のある標準HTML5ビデオコントロールが推奨されます。高度なニーズには、[react-player](https://github.com/cookpete/react-player)や[video.js](https://videojs.com/)のようなサードパーティプレーヤーを検討してください。これらはアクセシブルなコントロールと一貫したブラウザ体験を提供します。

### `<iframe>` {#iframe}

HTMLの `<iframe>` タグを使用すると、YouTubeやVimeoなど外部プラットフォームからビデオを埋め込むことができます。

```jsx title="app/page.jsx"
export default function Page() {
  return (
    <iframe src="https://www.youtube.com/embed/19g66ezsKAg" allowFullScreen />
  )
}
```

### よく使用される `<iframe>` タグの属性 {#common-iframe-tag-attributes}

| 属性              | 説明                                                                   | サンプル値                             |
| ----------------- | ---------------------------------------------------------------------- | -------------------------------------- |
| `src`             | 埋め込むページのURLを指定します。                                      | `<iframe src="https://example.com" />` |
| `width`           | iframeの幅を設定します。                                               | `<iframe width="500" />`               |
| `height`          | iframeの高さを設定します。                                             | `<iframe height="300" />`              |
| `allowFullScreen` | iframeのコンテンツがフルスクリーンモードで表示されることを許可します。 | `<iframe allowFullScreen />`           |
| `sandbox`         | iframe内のコンテンツに追加の制約セットを有効にします。                 | `<iframe sandbox />`                   |
| `loading`         | 読み込み動作を最適化します（例：遅延読み込み）。                       | `<iframe loading="lazy" />`            |
| `title`           | アクセシビリティをサポートするためにiframeにタイトルを付けます。       | `<iframe title="Description" />`       |

iframe属性の包括的なリストについては、[MDNドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attributes)を参照してください。

### ビデオ埋め込み方法の選択 {#choosing-a-video-embedding-method}

Next.jsアプリケーションでビデオを埋め込む方法は2つあります：

- **自己ホストまたは直接のビデオファイル**：`<video>` タグを使用して与えられた細かな制御が必要な場合、自己ホストのビデオを埋め込む方法です。このNext.jsとの連携方法により、ビデオコンテンツのカスタマイズと制御が可能になります。
- **ビデオホスティングサービスの利用（YouTube、Vimeoなど）**：YouTubeやVimeoのようなビデオホスティングサービスを利用する場合、`<iframe>` タグを使ってそれらのiframe形式のプレーヤーを埋め込みます。この方法はプレーヤーに対する制御が限られるものの、使いやすさとこれらのプラットフォームが提供する機能を提供します。

アプリケーションの要件や提供したいユーザー体験に応じた埋め込み方法を選択してください。

### 外部にホストされた動画の埋め込み {#embedding-externally-hosted-videos}

外部プラットフォームからのビデオを埋め込むためには、Next.jsを使用してビデオ情報を取得し、ReactのSuspenseを使用して読み込み中のフォールバック状態を処理できます。

**1. ビデオ埋め込み用のServer Componentを作成する**

最初のステップはビデオを埋め込むための適切なiframeを生成する[server component](https://nextjs.org/docs/app/building-your-application/rendering/server-components)を作成することです。このコンポーネントはビデオのソースURLを取得してiframeをレンダリングします。

```jsx title="app/ui/video-component.jsx"
export default async function VideoComponent() {
  const src = await getVideoSrc()

  return <iframe src={src} allowFullScreen />
}
```

**2. React Suspenseを使ったビデオコンポーネントのストリーミング**

ビデオを埋め込むためのserver componentを作成した後は、[React Suspense](https://react.dev/reference/react/Suspense)を使用して[コンポーネントをストリーミング](https://nextjs.org/docs/app/building-your-application/routing/loading-ui-and-streaming)するステップがあります。

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import VideoComponent from '../ui/VideoComponent.jsx'

export default function Page() {
  return (
    <section>
      <Suspense fallback={<p>Loading video...</p>}>
        <VideoComponent />
      </Suspense>
      {/* その他のページ内容 */}
    </section>
  )
}
```

> **Good to know**: 外部プラットフォームからの動画を埋め込む際には、次のベストプラクティスに留意してください：
>
> - 埋め込み動画がレスポンシブであることを確認しましょう。CSSを使用してiframeまたはビデオプレーヤーがさまざまな画面サイズに適応するようにします；
> - 特にデータプランが限定的なユーザー向けにネットワーク条件に基づいて動画を読み込む[戦略](https://yoast.com/site-speed-tips-for-faster-video/)を実装してください；

このアプローチはユーザーがページとやり取りしながらビデオコンポーネントがストリーミングされるため、ページがブロックされるのを防ぎ、より良いユーザー体験をもたらします。

より魅力的で情報性のある読み込み体験を提供するために、フォールバックUIとして読み込みスケルトンを使用することを考慮しましょう。簡単な読み込みメッセージを表示する代わりに、ビデオプレーヤーに似たスケルトンを表示することができます；：

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import VideoComponent from '../ui/VideoComponent.jsx'
import VideoSkeleton from '../ui/VideoSkeleton.jsx'

export default function Page() {
  return (
    <section>
      <Suspense fallback={<VideoSkeleton />}>
        <VideoComponent />
      </Suspense>
      {/* その他のページ内容 */}
    </section>
  )
}
```

## 自己ホスト動画 {#self-hosted-videos}

次のような理由から、自己ホストが好ましい場合があります：

- **完全な管理と独立性**：自己ホストでは動画コンテンツを直接管理できます。再生から外観まで、完全な所有権と制御が可能で、外部プラットフォームの制約を受けません；
- **特定のニーズへのカスタマイズ**：ダイナミックな背景ビデオなどの特有の要求に最適で、デザインや機能要件に合わせたカスタマイズを可能にします；
- **パフォーマンスとスケーラビリティへの配慮**：増大するトラフィックとコンテンツサイズを効果的にサポートできる、パフォーマンスが高くスケーラブルなストレージソリューションを選択してください；
- **コストと連携**：Next.jsフレームワークや広範な技術エコシステムへの統合の容易さと、ストレージや帯域幅のコストのバランスを取ります；

### Vercel Blobを使用した動画ホスティング {#using-vercel-blob-for-video-hosting}

[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)はNext.jsとよく連携する、スケーラブルなクラウドストレージ解決策を提供する効率的なホスティング方法です。以下の方法でVercel Blobを用いてビデオをホスティングできます：

**1. ビデオをVercel Blobにアップロードする**

Vercelダッシュボードで「ストレージ」タブを開き、[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)ストアを選択します。Blobテーブルの右上にある「アップロード」ボタンをクリックし、アップロードしたいビデオファイルを選びます。アップロードが完了すると、ビデオファイルはBlobテーブルに表示されます。

別の方法として、server actionを使ってビデオをアップロードすることもできます。詳しい手順はVercelの[サーバーサイドアップロード](https://vercel.com/docs/storage/vercel-blob/server-upload)に関するドキュメントを参照してください。Vercelは[クライアントサイドアップロード](https://vercel.com/docs/storage/vercel-blob/client-upload)もサポートしており、特定のユースケースではこの方法が適しているかもしれません；

**2. Next.jsでビデオを表示する**

ビデオをアップロードし保存したら、Next.jsアプリケーションで表示できます。以下に、`<video>` タグとReact Suspenseを使用した例を示します：

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import { list } from '@vercel/blob'

export default function Page() {
  return (
    <Suspense fallback={<p>Loading video...</p>}>
      <VideoComponent fileName="my-video.mp4" />
    </Suspense>
  )
}

async function VideoComponent({ fileName }) {
  const { blobs } = await list({
    prefix: fileName,
    limit: 1,
  })
  const { url } = blobs[0]

  return (
    <video controls preload="none" aria-label="Video player">
      <source src={url} type="video/mp4" />
      Your browser does not support the video tag.
    </video>
  )
}
```

このアプローチでは、ページがビデオの`@vercel/blob` URLを使用してビデオを表示し、`VideoComponent`を使用します。React Suspenseを使って、ビデオのURLが取得され表示準備ができるまでフォールバックを表示します。

### ビデオに字幕を追加する {#adding-subtitles-to-your-video}

ビデオに字幕がある場合、`<video>` タグ内で`<track>`要素を使って簡単に追加できます。ビデオファイルと同様に、[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)から字幕ファイルを取得できます。以下は字幕を含むように`<VideoComponent>`を更新する方法です：

```jsx title="app/page.jsx"
async function VideoComponent({ fileName }) {
  const { blobs } = await list({
    prefix: fileName,
    limit: 2,
  })
  const { url } = blobs[0]
  const { url: captionsUrl } = blobs[1]

  return (
    <video controls preload="none" aria-label="Video player">
      <source src={url} type="video/mp4" />
      <track src={captionsUrl} kind="subtitles" srcLang="en" label="English" />
      Your browser does not support the video tag.
    </video>
  )
}
```

このアプローチに従うことで、Next.jsアプリケーションにビデオを効果的に自己ホストし、統合することができます。

## リソース {#resources}

ビデオ最適化とベストプラクティスについての学びを続けるには、以下のリソースを参照してください：

- **ビデオフォーマットおよびコーデックの理解**：ビデオニーズに応じて、互換性に優れたMP4やウェブ最適化向けのWebMなど、適切なフォーマットとコーデックを選択します。詳細は[Mozillaのビデオコーデックに関するガイド](https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Video_codecs)を参照してください；
- **ビデオ圧縮**：FFmpegのようなツールを使って、品質とファイルサイズのバランスを取りながらビデオを効果的に圧縮します。圧縮技術については[FFmpegの公式サイト](https://www.ffmpeg.org/)を参照してください；
- **解像度とビットレートの調整**：視聴プラットフォームに応じて解像度とビットレートを調整します。モバイルデバイス向けには低い設定を選びます。[詳細はこちら](https://www.dacast.com/blog/bitrate-vs-resolution/#:~:text=The%20two%20measure%20different%20aspects,yield%20different%20qualities%20of%20video)；
- **コンテンツ配信ネットワーク（CDNs）**：CDNを活用してビデオ配信速度を向上させ、高トラフィックを処理します。一部のストレージソリューションを使用する場合、例えばVercel Blobでは、CDN機能が自動的に管理されます。CDNとそのメリットについて[さらに学ぶ](https://vercel.com/docs/edge-network/overview?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)；

Next.jsプロジェクトにビデオを統合するための以下のビデオストリーミングプラットフォームを探索してください：

### オープンソースの `next-video` コンポーネント {#open-source-next-video-component}

- [Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)、S3、Backblaze、Muxなどのホスティングサービスと互換性がある`<Video>`コンポーネントをNext.jsに提供します；
- 異なるホスティングサービスで`next-video.dev`を使用するための[詳細なドキュメント](https://next-video.dev/docs)；

### Cloudinaryインテグレーション {#cloudinary-integration}

- CloudinaryとNext.jsの公式な[ドキュメンテーションと統合ガイド](https://next.cloudinary.dev/)；
- [ドロップインビデオサポート](https://next.cloudinary.dev/cldvideoplayer/basic-usage)のための`<CldVideoPlayer>`コンポーネントを含みます；
- Adaptive Bitrate Streamingを含むNext.jsとCloudinaryの統合[例](https://github.com/cloudinary-community/cloudinary-examples/?tab=readme-ov-file#nextjs)を見つけます；[適応ビットレートストリーミング](https://github.com/cloudinary-community/cloudinary-examples/tree/main/examples/nextjs-cldvideoplayer-abr)；
- Node.js SDKなど他の[Cloudinaryライブラリ](https://cloudinary.com/documentation)も利用可能です；

### Mux Video API {#mux-video-api}

- Muxは、MuxとNext.jsでビデオコースを作成するための[スターターテンプレート](https://github.com/muxinc/video-course-starter-kit)を提供します；
- 次.jsアプリケーション向けの[高性能ビデオ埋め込み](https://www.mux.com/for/nextjs)のためのMuxの推奨事項を学びます；
- MuxとNext.jsを用いた[サンプルプロジェクト](https://with-mux-video.vercel.app/)を探索します；

### Fastly {#fastly}

- Next.jsにビデオオンデマンドやストリーミングメディアを統合するためのFastlyのソリューションについて[さらに学びます](https://www.fastly.com/products/streaming-media/video-on-demand)；

### ImageKit.io インテグレーション {#imagekit-io-integration}

- Next.jsとImageKitを統合するための[公式クイックスタートガイド](https://imagekit.io/docs/integration/nextjs)をチェックします；
- 統合は、[シームレスなビデオサポート](https://imagekit.io/docs/integration/nextjs#rendering-videos)を提供する`<IKVideo>`コンポーネントを提供します；
- Node.js SDKなど、他の[ImageKitライブラリ](https://imagekit.io/docs)も探索できます；

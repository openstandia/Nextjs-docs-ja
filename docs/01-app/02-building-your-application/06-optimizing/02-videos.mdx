---
title: 'Video Optimization'
nav_title: 'Videos'
description: 'Next.jsアプリケーションでの動画最適化の推奨事項とベストプラクティス'
---

このページでは、Next.jsアプリケーションで動画を使用する方法を概説し、パフォーマンスに影響を与えずに動画ファイルを保存および表示する方法を示します。

## `<video>`と`<iframe>`の使用 {#using-video-and-iframe}

動画は、直接動画ファイル用にHTMLの**`<video>`**タグを使用し、外部プラットフォームでホストされている動画には**`<iframe>`**を使用してページに埋め込むことができます。

### `<video>` {#video}

HTML [`<video>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video) タグは自己ホストまたは直接提供される動画コンテンツを埋め込むことができ、再生や外観を完全に制御できます。

```jsx title="app/ui/video.jsx"
export function Video() {
  return (
    <video width="320" height="240" controls preload="none">
      <source src="/path/to/video.mp4" type="video/mp4" />
      <track
        src="/path/to/captions.vtt"
        kind="subtitles"
        srcLang="en"
        label="English"
      />
      Your browser does not support the video tag.
    </video>
  )
}
```

### 一般的な`<video>`タグの属性 {#common-video-tag-attributes}

| 属性          | 説明                                                                                            | 例                                   |
| ------------- | ----------------------------------------------------------------------------------------------- | ------------------------------------ |
| `src`         | 動画ファイルのソースを指定します                                                                | `<video src="/path/to/video.mp4" />` |
| `width`       | 動画プレーヤーの幅を設定します                                                                  | `<video width="320" />`              |
| `height`      | 動画プレーヤーの高さを設定します                                                                | `<video height="240" />`             |
| `controls`    | 存在する場合、デフォルトの再生コントロールセットを表示します                                    | `<video controls />`                 |
| `autoPlay`    | ページロード時に動画を自動再生します。注：自動再生ポリシーはブラウザによって異なります          | `<video autoPlay />`                 |
| `loop`        | 動画の再生をループさせます                                                                      | `<video loop />`                     |
| `muted`       | デフォルトでオーディオをミュートにします。通常`autoPlay`と一緒に使用されます                    | `<video muted />`                    |
| `preload`     | 動画がどのようにプリロードされるかを指定します。値: `none`, `metadata`, `auto`                  | `<video preload="none" />`           |
| `playsInline` | iOSデバイスでインライン再生を有効にし、多くの場合、iOS Safariで自動再生が機能するために必要です | `<video playsInline />`              |

> **Good to know**: `autoPlay`属性を使用する際には、`muted`属性を含めることが重要です。これにより、ほとんどのブラウザで動画が自動的に再生され、iOSデバイスでの互換性も確保されます。

動画属性の一覧については、[MDNのドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video#attributes)を参照してください。

### 動画のベストプラクティス {#video-best-practices}

- **フォールバックコンテンツ:** `<video>`タグを使用する場合、動画再生をサポートしていないブラウザのためにタグ内にフォールバックコンテンツを含めます
- **字幕またはキャプション:** 聴覚障がいのあるユーザーのために字幕やキャプションを含めます。あなたの`<video>`要素で[`<track>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/track)タグを使用してキャプションファイルのソースを指定します
- **アクセシブルコントロール:** キーボードナビゲーションやスクリーンリーダーの互換性のために、標準的なHTML5動画コントロールを推奨します。高度なニーズのためには、[react-player](https://github.com/cookpete/react-player)や[video.js](https://videojs.com/)のようなサードパーティのプレーヤーを検討してみてください。これらはアクセシブルなコントロールと一貫したブラウザ体験を提供します

### `<iframe>` {#iframe}

HTMLの`<iframe>`タグを使用すると、YouTubeやVimeoのような外部プラットフォームから動画を埋め込むことができます。

```jsx title="app/page.jsx"
export default function Page() {
  return (
    <iframe src="https://www.youtube.com/embed/19g66ezsKAg" allowFullScreen />
  )
}
```

### 一般的な`<iframe>`タグの属性 {#common-iframe-tag-attributes}

| 属性              | 説明                                                             | 例                                     |
| ----------------- | ---------------------------------------------------------------- | -------------------------------------- |
| `src`             | 埋め込むページのURLです                                          | `<iframe src="https://example.com" />` |
| `width`           | iframeの幅を設定します                                           | `<iframe width="500" />`               |
| `height`          | iframeの高さを設定します                                         | `<iframe height="300" />`              |
| `allowFullScreen` | iframe コンテンツを全画面モードで表示することを許可します        | `<iframe allowFullScreen />`           |
| `sandbox`         | iframe 内のコンテンツに対して追加の制約セットを有効にします      | `<iframe sandbox />`                   |
| `loading`         | 読み込み動作を最適化します (例: レイジーローディング)            | `<iframe loading="lazy" />`            |
| `title`           | アクセシビリティをサポートするためにiframeにタイトルを提供します | `<iframe title="Description" />`       |

iframe属性の一覧については、[MDNのドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attributes)を参照してください。

### 動画埋め込み方法の選択 {#choosing-a-video-embedding-method}

Next.jsアプリケーションで動画を埋め込む方法は2つあります。

- **自己ホストまたは直接動画ファイル:** プレーヤーの機能や外観に詳細な制御を要するシナリオでは、`<video>`タグを使用して自己ホストした動画を埋め込みます。この統合方法により、Next.jsで動画コンテンツのカスタマイズと制御が可能になります
- **ビデオホスティングサービスの使用 (YouTube、Vimeo など):** YouTubeやVimeoなどのビデオホスティングサービスに対しては、`<iframe>`タグを使用してこれらのiframeベースのプレーヤーを埋め込みます。この方法ではプレーヤーに対する一部の制御が制限されますが、これらのプラットフォームの提供する使いやすさと機能を活用できます

アプリケーションの要件と提供したいユーザー体験に合った埋め込み方法を選んでください。

### 外部ホストの動画を埋め込む {#embedding-externally-hosted-videos}

外部プラットフォームから動画を埋め込むには、Next.jsを使用して動画情報を取得し、React Suspenseを使用して読み込み中にフォールバック状態を処理できます。

**1. 動画埋め込み用のサーバーコンポーネントを作成する**

最初のステップは、動画を埋め込むための適切なiframeを生成する[Server Component](https://nextjs.org/docs/app/building-your-application/rendering/server-components)を作成することです。このコンポーネントは動画のソースURLを取得し、iframeをレンダリングします。

```jsx title="app/ui/video-component.jsx"
export default async function VideoComponent() {
  const src = await getVideoSrc()

  return <iframe src={src} allowFullScreen />
}
```

**2. React Suspenseを使用して動画コンポーネントをストリーム配信する**

動画を埋め込む恒久コンポーネントを作成した後、次のステップはReactのSuspenseを使用してコンポーネントを[ストリーム配信](https://nextjs.org/docs/app/building-your-application/routing/loading-ui-and-streaming)することです。

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import VideoComponent from '../ui/VideoComponent.jsx'

export default function Page() {
  return (
    <section>
      <Suspense fallback={<p>Loading video...</p>}>
        <VideoComponent />
      </Suspense>
      {/* その他のページコンテンツ */}
    </section>
  )
}
```

> **Good to know**: 外部プラットフォームから動画を埋め込む際には、次のベストプラクティスを考慮してください:
>
> - 動画の埋め込みはレスポンシブにしましょう。CSSを使用して、iframeや動画プレーヤーを異なる画面サイズに適応させます
> - 特に限られたデータプランを持つユーザーに対して、ネットワーク状況に基づいた[動画の読み込み戦略](https://yoast.com/site-speed-tips-for-faster-video/)を実装します

このアプローチは、ページのブロックを防ぎ、ユーザーが動画コンポーネントがストリーム配信中でもページと対話できることにより、優れたユーザーエクスペリエンスを提供します。

より魅力的で情報豊富な読み込み体験を提供するために、フォールバックUIとして読み込み用スケルトンを使用することを検討してください。簡単な読み込みメッセージを表示する代わりに、このように動画プレーヤーに似たスケルトンを表示することができます。

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import VideoComponent from '../ui/VideoComponent.jsx'
import VideoSkeleton from '../ui/VideoSkeleton.jsx'

export default function Page() {
  return (
    <section>
      <Suspense fallback={<VideoSkeleton />}>
        <VideoComponent />
      </Suspense>
      {/* その他のページコンテンツ */}
    </section>
  )
}
```

## 自己ホストの動画 {#self-hosted-videos}

自己ホストされた動画は、以下のような理由で好まれることがあります。

- **完全な管理と独立性:** 自己ホストは、動画コンテンツの管理を直接行うことができ、再生から外観に至るまで外部プラットフォームの制約を受けずに、所有権と制御を完全に確保します
- **特定のニーズに合わせたカスタマイズ:** 動的な背景動画のような特定のニーズに理想的で、デザインや機能要件に合わせたカスタマイズが可能です
- **パフォーマンスと拡張性に関する考慮:** 高トラフィックとコンテンツサイズの効果的なサポートのために、パフォーマンスが高く拡張性のあるストレージソリューションを選択します
- **コストと統合:** ストレージと帯域幅のコストをNext.jsフレームワークや広範な技術エコシステムへの容易な統合の必要性とバランスをとります

### Vercel Blobを使用した動画ホスティング {#using-vercel-blob-for-video-hosting}

[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)は、Next.jsで効果的に動作するスケーラブルなクラウドストレージソリューションを提供する効率的な動画ホスティング方法です。以下は、Vercel Blobを使用して動画をホスティングする方法です。

**1. Vercel Blobへの動画アップロード**

Vercelのダッシュボードで「Storage」タブに移動し、[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)ストアを選択します。Blobテーブルの右上の角にある「Upload」ボタンを見つけてクリックします。その後、アップロードしたい動画ファイルを選択します。アップロードが完了すると、動画ファイルがBlobテーブルに表示されます。

また、サーバーアクションを使用して動画をアップロードすることもできます。詳細な手順については、Vercelの[サーバー側アップロード](https://vercel.com/docs/storage/vercel-blob/server-upload)に関するドキュメントを参照してください。Vercelは[クライアント側アップロード](https://vercel.com/docs/storage/vercel-blob/client-upload)もサポートしています。この方法は特定のユースケースに好まれるかもしれません。

**2. 動画をNext.jsで表示する**

動画がアップロードされ保存されたら、Next.jsアプリケーションで表示できます。以下は、`<video>`タグとReact Suspenseを使用してこれを実現する方法の例です。

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import { list } from '@vercel/blob'

export default function Page() {
  return (
    <Suspense fallback={<p>Loading video...</p>}>
      <VideoComponent fileName="my-video.mp4" />
    </Suspense>
  )
}

async function VideoComponent({ fileName }) {
  const { blobs } = await list({
    prefix: fileName,
    limit: 1,
  })
  const { url } = blobs[0]

  return (
    <video controls preload="none" aria-label="Video player">
      <source src={url} type="video/mp4" />
      Your browser does not support the video tag.
    </video>
  )
}
```

このアプローチでは、ページはビデオの`@vercel/blob` URLを使用してビデオを表示します。ReactのSuspenseを使用して、ビデオURLがフェッチされビデオの準備ができるまでフォールバックを表示します。

### 動画に字幕を追加する {#adding-subtitles-to-your-video}

ビデオに字幕がある場合は、`<video>`タグ内の`<track>`要素を使用して簡単に追加することができます。動画ファイルと同様に、[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)から字幕ファイルを取得することができます。以下は、`<VideoComponent>`に字幕を含めるように更新する方法です。

```jsx title="app/page.jsx"
async function VideoComponent({ fileName }) {
  const { blobs } = await list({
    prefix: fileName,
    limit: 2,
  })
  const { url } = blobs[0]
  const { url: captionsUrl } = blobs[1]

  return (
    <video controls preload="none" aria-label="Video player">
      <source src={url} type="video/mp4" />
      <track src={captionsUrl} kind="subtitles" srcLang="en" label="English" />
      Your browser does not support the video tag.
    </video>
  )
}
```

このアプローチに従うことで、あなたのNext.jsアプリケーションに効果的に自己ホストし、動画を統合することができます。

## リソース {#resources}

動画の最適化とベストプラクティスについてさらに学ぶために、次のリソースを参照してください。

- **動画フォーマットとコーデックの理解:** 動画のニーズに合わせて、MP4のような互換性のあるフォーマットまたはWebMのようなウェブ最適化フォーマットを選択します。詳細は[Mozillaの動画コーデックに関するガイド](https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Video_codecs)をご覧ください
- **動画圧縮:** FFmpegのようなツールを使用して、品質とファイルサイズのバランスをとるように動画を効果的に圧縮します。圧縮技術については[FFmpegの公式ウェブサイト](https://www.ffmpeg.org/)をご覧ください
- **解像度とビットレートの調整:** 視聴プラットフォームに基づいて[解像度とビットレート](https://www.dacast.com/blog/bitrate-vs-resolution/#:~:text=The%20two%20measure%20different%20aspects,yield%20different%20qualities%20of%20video)を調整し、モバイルデバイスには低い設定にします
- **コンテンツデリバリーネットワーク (CDN):** 動画の配信速度を向上させ、高トラフィックを管理するためにCDNを活用します。いくつかのストレージソリューションを使用する場合、Vercel BlobのようなCDN機能は自動的に処理されます。[CDNとその利点について詳しく学ぶ](https://vercel.com/docs/edge-network/overview?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)

Next.jsプロジェクトに動画を統合するためのこれらの動画ストリーミングプラットフォームを探求してください。

### オープンソースの`next-video`コンポーネント {#open-source-next-video-component}

- [Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)、S3、Backblaze、Muxなどのホスティングサービスと互換性のあるNext.js用`<Video>`コンポーネントを提供します。
- 詳細なドキュメントは、`next-video.dev`を使用してさまざまなホスティングサービスに対応しています。[詳細なドキュメント](https://next-video.dev/docs)をご覧ください

### Cloudinaryの統合 {#cloudinary-integration}

- Next.jsとCloudinaryを統合するための公式文書とガイドがあります。[詳細なドキュメントと統合ガイド](https://next.cloudinary.dev/)をご覧ください
- `<CldVideoPlayer>` コンポーネントは[ドロップイン動画サポート](https://next.cloudinary.dev/cldvideoplayer/basic-usage)を提供します。
- Adaptive Bitrate Streamingを含む、Next.jsとCloudinaryを統合する[例](https://github.com/cloudinary-community/cloudinary-examples/?tab=readme-ov-file#nextjs)を探します
- Node.js SDKを含むその他の[Cloudinaryライブラリ](https://cloudinary.com/documentation)も利用可能です

### Mux Video API {#mux-video-api}

- Muxは、MuxとNext.jsを使ってビデオコースを作成するための[スターターテンプレート](https://github.com/muxinc/video-course-starter-kit)を提供しています。
- MuxのNext.jsアプリケーション向けの[高性能ビデオ埋め込みの推奨事項](https://www.mux.com/for/nextjs)について学びましょう
- MuxとNext.jsを手がけた[注目すべきプロジェクト](https://with-mux-video.vercel.app/)を探求

### Fastly {#fastly}

- Video on DemandやストリーミングメディアをNext.jsに統合するFastlyのソリューションについて詳しく知る。[詳細はこちら](https://www.fastly.com/products/streaming-media/video-on-demand)

### ImageKit.ioの統合 {#imagekit-io-integration}

- Next.jsとのImageKit統合のための[公式クイックスタートガイド](https://imagekit.io/docs/integration/nextjs)を確認
- 統合には[シームレスな動画サポート](https://imagekit.io/docs/integration/nextjs#rendering-videos)を提供する`<IKVideo>`コンポーネントが含まれています
- 他のImageKitライブラリ、Node.js SDKなども探索できます。他の[ImageKitライブラリ](https://imagekit.io/docs)も利用可能です

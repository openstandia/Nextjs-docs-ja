---
title: 'Video Optimization'
nav_title: 'Videos'
description: 'Next.jsアプリケーションでの動画の最適化に関するおすすめの方法とベストプラクティス。'
---

このページでは、Next.jsアプリケーションで動画を使用する方法を解説し、パフォーマンスに影響を与えずに動画ファイルを保存し表示する方法を示します。

## `<video>`と`<iframe>`の使用 {#using-video-and-iframe}

動画は、直接動画ファイル用のHTMLタグ**`<video>`**や、外部プラットフォームにホストされている動画用の**`<iframe>`**を使用してページに埋め込むことができます。

### `<video>` の使用 {#video}

HTMLの[`<video>`](https://developer.mozilla.org/ja/docs/Web/HTML/Element/video)タグは、自己ホストまたは直接配信される動画コンテンツを埋め込み、再生や外観に対する完全な制御を可能にします。

```jsx title="app/ui/video.jsx"
export function Video() {
  return (
    <video width="320" height="240" controls preload="none">
      <source src="/path/to/video.mp4" type="video/mp4" />
      <track
        src="/path/to/captions.vtt"
        kind="subtitles"
        srcLang="en"
        label="English"
      />
      お使いのブラウザはvideoタグをサポートしていません。
    </video>
  )
}
```

### 一般的な`<video>`タグの属性 {#common-video-tag-attributes}

| 属性          | 説明                                                                                                         | 例                                   |
| ------------- | ------------------------------------------------------------------------------------------------------------ | ------------------------------------ |
| `src`         | 動画ファイルのソースを指定します。                                                                           | `<video src="/path/to/video.mp4" />` |
| `width`       | ビデオプレーヤーの幅を設定します。                                                                           | `<video width="320" />`              |
| `height`      | ビデオプレーヤーの高さを設定します。                                                                         | `<video height="240" />`             |
| `controls`    | 設定されている場合、デフォルトの再生コントロールが表示されます。                                             | `<video controls />`                 |
| `autoPlay`    | ページが読み込まれると自動的にビデオの再生を開始します。注意：自動再生ポリシーはブラウザによって異なります。 | `<video autoPlay />`                 |
| `loop`        | ビデオの再生をループします。                                                                                 | `<video loop />`                     |
| `muted`       | デフォルトでオーディオをミュートにします。よく`autoPlay`と一緒に使われます。                                 | `<video muted />`                    |
| `preload`     | ビデオのプリロード方法を指定します。値：`none`, `metadata`, `auto`。                                         | `<video preload="none" />`           |
| `playsInline` | iOSデバイスでのインライン再生を可能にし、多くの場合、iOS Safariでの自動再生を動作させるために必要です。      | `<video playsInline />`              |

> **Good to know**: `autoPlay`属性を使用するとき、ほとんどのブラウザでビデオが自動で再生されることを保証するために`muted`属性およびiOSデバイスとの互換性のために`playsInline`属性も含めることが重要です。

ビデオ属性の詳しい情報は、[MDNドキュメント](https://developer.mozilla.org/ja/docs/Web/HTML/Element/video#attributes)を参照してください。

### ビデオに関するベストプラクティス {#video-best-practices}

- **フォールバックコンテンツ:** `<video>`タグを使用するときは、ビデオ再生をサポートしていないブラウザ用にタグ内にフォールバックコンテンツを含めてください
- **字幕またはキャプション:** 聴覚障害のあるユーザーのために字幕やキャプションを含めてください`<video>`要素と共に[`<track>`](https://developer.mozilla.org/ja/docs/Web/HTML/Element/track)タグを使用してキャプションファイルのソースを指定します
- **アクセス可能なコントロール:** 標準のHTML5ビデオコントロールはキーボードナビゲーションとスクリーンリーダー対応が推奨されます。高度なニーズのために、[react-player](https://github.com/cookpete/react-player) や [video.js](https://videojs.com/)のようなサードパーティープレーヤーを検討してください。これらのプレーヤーは、アクセス可能なコントロールと一貫したブラウザ体験を提供します

### `<iframe>` の使用 {#iframe}

HTMLの`<iframe>`タグを使用すると、YouTubeやVimeoのような外部プラットフォームから動画を埋め込むことができます。

```jsx title="app/page.jsx"
export default function Page() {
  return (
    <iframe src="https://www.youtube.com/embed/19g66ezsKAg" allowFullScreen />
  )
}
```

### 一般的な`<iframe>`タグの属性 {#common-iframe-tag-attributes}

| 属性              | 説明                                                               | 例                                     |
| ----------------- | ------------------------------------------------------------------ | -------------------------------------- |
| `src`             | 埋め込むページのURL。                                              | `<iframe src="https://example.com" />` |
| `width`           | iframeの幅を設定します。                                           | `<iframe width="500" />`               |
| `height`          | iframeの高さを設定します。                                         | `<iframe height="300" />`              |
| `allowFullScreen` | iframeのコンテンツを全画面表示できるようにします。                 | `<iframe allowFullScreen />`           |
| `sandbox`         | iframe内のコンテンツに追加の制限をかけます。                       | `<iframe sandbox />`                   |
| `loading`         | 読み込み動作を最適化します（例：遅延読み込み）。                   | `<iframe loading="lazy" />`            |
| `title`           | アクセシビリティをサポートするためにiframeのタイトルを提供します。 | `<iframe title="Description" />`       |

iframeの属性情報の詳細は、[MDNドキュメント](https://developer.mozilla.org/ja/docs/Web/HTML/Element/iframe#attributes)を参照してください。

### 動画埋め込み方法を選ぶ {#choosing-a-video-embedding-method}

Next.jsアプリケーションに動画を埋め込むには、次の2つの方法があります：

- **自己ホストまたは直接動画ファイル:** プレーヤーの機能や外観に対する詳細な制御が必要なシナリオにおいて`<video>`タグを使用して自己ホスト動画を埋め込みます。この統合方法では、動画コンテンツをカスタマイズして制御することができます
- **動画ホスティングサービスの使用（YouTube, Vimeo など）:** YouTubeやVimeoのような動画ホスティングサービスでは`<iframe>`タグを使用してプレーヤーを埋め込みます。この方法ではプレーヤーに対する制御が制限されますが、これらのプラットフォームが提供する使いやすさと機能が利用できます

アプリケーションの要件と提供したいユーザー体験に合った埋め込み方法を選んでください。

### 外部ホストされた動画の埋め込み {#embedding-externally-hosted-videos}

外部プラットフォームから動画を埋め込むために、Next.jsを使用して動画情報を取得し、React Suspenseでロード中のフォールバック状態を管理できます。

**1. 動画埋め込み用のServer Componentの作成**

最初のステップとして、動画埋め込み用の適切なiframeを生成する[Server Component](https://nextjs.org/docs/app/building-your-application/rendering/server-components)を作成します。このコンポーネントは動画のソースURLを取得し、iframeをレンダリングします。

```jsx title="app/ui/video-component.jsx"
export default async function VideoComponent() {
  const src = await getVideoSrc()

  return <iframe src={src} allowFullScreen />
}
```

**2. React Suspenseを使って動画コンポーネントをストリームする**

動画を埋め込むためのServer Componentを作成した後、次にこのコンポーネントを[React Suspense](https://react.dev/reference/react/Suspense)を使用して[ストリーミング](https://nextjs.org/docs/app/building-your-application/routing/loading-ui-and-streaming)します。

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import VideoComponent from '../ui/VideoComponent.jsx'

export default function Page() {
  return (
    <section>
      <Suspense fallback={<p>Loading video...</p>}>
        <VideoComponent />
      </Suspense>
      {/* ページの他のコンテンツ */}
    </section>
  )
}
```

> **Good to know**: 外部プラットフォームから動画を埋め込む際は、以下のベストプラクティスを考慮してください：
>
> - 動画埋め込みをレスポンシブにしましょう。CSSを使ってiframeやビデオプレーヤーを異なる画面サイズに適応させます
> - 特にデータプランが限られているユーザーに対しては、ネットワーク条件に基づいて[動画ロード戦略](https://yoast.com/site-speed-tips-for-faster-video/)を実装しましょう

このアプローチにより、ページがブロックされることを防ぐ、より良いユーザー体験が実現され、動画コンポーネントがストリーミングされる間、ユーザーはページと相互作用できるようになります。

ロード中の体験をより魅力的かつ情報豊かにするために、フォールバックUIとしてローディングスケルトンを使用することを検討してください。単純な読み込みメッセージを表示する代わりに、このようにビデオプレーヤーに似たスケルトンを表示できます：

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import VideoComponent from '../ui/VideoComponent.jsx'
import VideoSkeleton from '../ui/VideoSkeleton.jsx'

export default function Page() {
  return (
    <section>
      <Suspense fallback={<VideoSkeleton />}>
        <VideoComponent />
      </Suspense>
      {/* ページの他のコンテンツ */}
    </section>
  )
}
```

## 自己ホスト動画 {#self-hosted-videos}

自己ホストによる動画の利点がいくつかあります：

- **完全な制御と独立性**: 自己ホストはビデオコンテンツの再生から外観まで直接管理を可能にし、外部プラットフォームの制約を受けずに完全な所有権と制御を保証します
- **特定ニーズに合わせたカスタマイズ**: ダイナミックな背景動画など特定の要件に理想的で、デザインや機能ニーズに合ったカスタマイズが可能です
- **パフォーマンスとスケーラビリティの考慮**: 増加するトラフィックやコンテンツに効果的に対応するため、パフォーマンスが高くスケーラブルなストレージソリューションを選びましょう
- **コストと統合**: ストレージと帯域幅のコストを、Next.jsフレームワークへの簡単な統合や技術エコシステム全体との統合の必要性とバランスにかけてください

### 動画ホスティングにVercel Blobを使用する {#using-vercel-blob-for-video-hosting}

[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)は、Next.jsに適したスケーラブルなクラウドストレージソリューションを提供し、効率的にビデオをホストする方法を提供します。以下は、Vercel Blobを使用して動画をホストする手順です：

**1. Vercel Blobに動画をアップロードする**

Vercelのダッシュボードで「Storage」タブに移動し、[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)ストアを選択します。Blobテーブルの右上にある「Upload」ボタンをクリックし、アップロードしたい動画ファイルを選択します。アップロードが完了すると、動画ファイルがBlobテーブルに表示されます。

また、サーバーアクションを使用して動画をアップロードすることも可能です。詳細な手順については、[サーバーサイドアップロード](https://vercel.com/docs/storage/vercel-blob/server-upload)に関するVercelのドキュメントを参照してください。Vercelはまた、[クライアントサイドでのアップロード](https://vercel.com/docs/storage/vercel-blob/client-upload)もサポートしており、特定のユースケースに対してはこの方法が好まれることもあります。

**2. Next.jsで動画を表示する**

動画がアップロードされ保存されたら、Next.jsアプリケーションで表示することができます。以下は、`<video>`タグとReact Suspenseを使用した例です：

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import { list } from '@vercel/blob'

export default function Page() {
  return (
    <Suspense fallback={<p>Loading video...</p>}>
      <VideoComponent fileName="my-video.mp4" />
    </Suspense>
  )
}

async function VideoComponent({ fileName }) {
  const { blobs } = await list({
    prefix: fileName,
    limit: 1,
  })
  const { url } = blobs[0]

  return (
    <video controls preload="none" aria-label="Video player">
      <source src={url} type="video/mp4" />
      お使いのブラウザはvideoタグをサポートしていません。
    </video>
  )
}
```

この方法では、ページは`@vercel/blob` URLを使用して動画を表示します。React Suspenseを使用して、動画のURLが取得され準備が整うまでフォールバックを表示します。

### 動画に字幕を追加する {#adding-subtitles-to-your-video}

動画に字幕がある場合は、`<video>`タグ内の`<track>`要素を使って簡単に追加できます。Vercel Blobから字幕ファイルも動画と同様に取得できます。以下の方法で`<VideoComponent>`を更新して、字幕を含めることができます。

```jsx title="app/page.jsx"
async function VideoComponent({ fileName }) {
  const { blobs } = await list({
    prefix: fileName,
    limit: 2,
  })
  const { url } = blobs[0]
  const { url: captionsUrl } = blobs[1]

  return (
    <video controls preload="none" aria-label="Video player">
      <source src={url} type="video/mp4" />
      <track src={captionsUrl} kind="subtitles" srcLang="en" label="English" />
      お使いのブラウザはvideoタグをサポートしていません。
    </video>
  )
}
```

このアプローチを使用することで、効果的に自己ホストおよびNext.jsアプリケーションに動画を統合することができます。

## リソース {#resources}

動画の最適化とベストプラクティスを引き続き学ぶために、以下のリソースを参照してください：

- **ビデオフォーマットとコーデックの理解**: 利用目的に応じて、互換性のためのMP4やウェブ最適化のためのWebMなど、適切なフォーマットとコーデックを選びましょう。詳細については[Mozillaのビデオコーデックガイド](https://developer.mozilla.org/ja/docs/Web/Media/Formats/Video_codecs)を参照してください。
- **動画圧縮**: FFmpegのようなツールを使用して、品質とファイルサイズのバランスをとりつつ効果的に動画を圧縮します。圧縮方法については[FFmpegの公式サイト](https://www.ffmpeg.org/)を参照してください。
- **解像度とビットレートの調整**: 視聴するプラットフォームに基づいて[解像度とビットレート](https://www.dacast.com/blog/bitrate-vs-resolution/#:~:text=The%20two%20measure%20different%20aspects,yield%20different%20qualities%20of%20video)を調整し、モバイルデバイスには低い設定を適用します。
- **コンテンツ配信ネットワーク(CDN)**: 動画配信速度を向上させ、高トラフィックを管理するためにCDNを活用します。特定のストレージソリューションを使用する場合、例えばVercel Blobのように、CDN機能が自動的に処理されます。[CDNとその利点について](https://vercel.com/docs/edge-network/overview?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)の詳細を学びましょう。

Next.jsプロジェクトへの動画統合に役立つ以下のビデオストリーミングプラットフォームを探索してください：

### オープンソースの `next-video` コンポーネント {#open-source-next-video-component}

- [Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)、S3、Backblaze、Muxを含む様々なホスティングサービスと互換性のあるNext.js用の`<Video>`コンポーネントを提供します
- [異なるホスティングサービスでの使用方法に関する詳細なドキュメント](https://next-video.dev/docs)を提供しています

### Cloudinaryとの統合 {#cloudinary-integration}

- Next.jsとCloudinaryを使用するための公式の[ドキュメントと統合ガイド](https://next.cloudinary.dev/)。
- [即時動画サポートのため](https://next.cloudinary.dev/cldvideoplayer/basic-usage)の`<CldVideoPlayer>`コンポーネントを含みます。
- [Adaptive Bitrate Streaming](https://github.com/cloudinary-community/cloudinary-examples/tree/main/examples/nextjs-cldvideoplayer-abr)を含むNext.jsとのCloudinary統合の[例](https://github.com/cloudinary-community/cloudinary-examples/?tab=readme-ov-file#nextjs)を見つけることができます。
- Node.js SDKを含むその他の[Cloudinaryライブラリ](https://cloudinary.com/documentation)も利用可能です。

### Mux Video API {#mux-video-api}

- Muxは、MuxとNext.jsを用いたビデオコース作成のための[スタートテンプレート](https://github.com/muxinc/video-course-starter-kit)を提供します。
- Next.jsアプリケーションに[高パフォーマンスな動画を埋め込む](https://www.mux.com/for/nextjs)ためのMuxの推奨設定を学びます。
- Next.jsとMuxの例を示す[例のプロジェクト](https://with-mux-video.vercel.app/)を探索してください。

### Fastly {#fastly}

- Next.jsへのビデオオンデマンドやストリーミングメディアソリューションの統合についてFastlyの[詳細情報](https://www.fastly.com/products/streaming-media/video-on-demand)をご覧ください。

### ImageKit.ioとの統合 {#imagekit-io-integration}

- Next.jsとImageKitの統合に関する[公式のクイックスタートガイド](https://imagekit.io/docs/integration/nextjs)を確認してください。
- 統合は`<IKVideo>`コンポーネントを提供し、[シームレスな動画サポート](https://imagekit.io/docs/integration/nextjs#rendering-videos)を実現します。
- Node.js SDKなど、他の[ImageKitライブラリ](https://imagekit.io/docs)も探索できます。

---
title: 'Video Optimization'
nav_title: 'Videos'
description: 'Next.jsアプリケーションにおけるビデオ最適化のための推奨事項とベストプラクティス。'
---

このページは、Next.jsアプリケーションでどのように動画を使用するか、パフォーマンスに影響を与えることなくビデオファイルを保存および表示する方法について説明します。

## `<video>` および `<iframe>` の使用方法 {#using-video-and-iframe}

動画は、直接のビデオファイルにはHTMLの**`<video>`**タグを、外部プラットフォームにホスティングされたビデオには**`<iframe>`**を使用してページに埋め込むことができます。

### `<video>` {#video}

HTMLの[`<video>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video)タグを使用して、自己ホスト型または直接提供されるビデオコンテンツを埋め込むことができ、再生と外見を完全に制御できます。

```jsx title="app/ui/video.jsx"
export function Video() {
  return (
    <video width="320" height="240" controls preload="none">
      <source src="/path/to/video.mp4" type="video/mp4" />
      <track
        src="/path/to/captions.vtt"
        kind="subtitles"
        srcLang="en"
        label="English"
      />
      Your browser does not support the video tag.
    </video>
  )
}
```

### 一般的な `<video>` タグの属性 {#common-video-tag-attributes}

| 属性          | 説明                                                                                                      | 例                                   |
| ------------- | --------------------------------------------------------------------------------------------------------- | ------------------------------------ |
| `src`         | ビデオファイルのソースを指定します                                                                        | `<video src="/path/to/video.mp4" />` |
| `width`       | ビデオプレーヤーの幅を設定します                                                                          | `<video width="320" />`              |
| `height`      | ビデオプレーヤーの高さを設定します                                                                        | `<video height="240" />`             |
| `controls`    | 存在すると、デフォルトの再生コントロールセットを表示します                                                | `<video controls />`                 |
| `autoPlay`    | ページが読み込まれたときにビデオの自動再生を開始します 注：自動再生ポリシーはブラウザによって異なります。 | `<video autoPlay />`                 |
| `loop`        | ビデオ再生をループします                                                                                  | `<video loop />`                     |
| `muted`       | デフォルトでオーディオをミュートします 一般に`autoPlay`と一緒に使用されます。                             | `<video muted />`                    |
| `preload`     | ビデオのプリロード方法を指定します 値：`none`、`metadata`、`auto`。                                       | `<video preload="none" />`           |
| `playsInline` | iOSデバイスでのインライン再生を有効にします iOS Safariでの自動再生が機能するためによく必要です。          | `<video playsInline />`              |

> **Good to know**: `autoPlay`属性を使用するとき、`muted`属性を含めることが重要であり、ほとんどのブラウザでビデオが自動的に再生されることを保証します。また、iOSデバイスとの互換性のために`playsInline`属性を含めるべきです。

ビデオの属性の包括的なリストについては、[MDNドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video#attributes)を参照してください。

### ビデオのベストプラクティス {#video-best-practices}

- **フォールバックコンテンツ：** `<video>`タグを使用する場合、ビデオ再生をサポートしないブラウザのためにタグ内にフォールバックコンテンツを含めるべきです
- **字幕またはキャプション：** 聴覚障害者のために字幕やキャプションを含めるべきです。`<track>`タグを使用して、`<video>`要素にキャプションファイルソースを指定します
- **アクセシブルコントロール：** 標準のHTML5ビデオコントロールは、キーボードナビゲーションやスクリーンリーダとの互換性のために推奨されます。高度な要件には、[react-player](https://github.com/cookpete/react-player)や[video.js](https://videojs.com/)のようなサードパーティのプレーヤーを検討し、アクセシブルなコントロールと一貫したブラウザ体験を提供できます

### `<iframe>` {#iframe}

HTMLの`<iframe>`タグは、YouTubeやVimeoなどの外部プラットフォームから動画を埋め込むことができるようにします。

```jsx title="app/page.jsx"
export default function Page() {
  return (
    <iframe src="https://www.youtube.com/embed/19g66ezsKAg" allowFullScreen />
  )
}
```

### 一般的な `<iframe>` タグの属性 {#common-iframe-tag-attributes}

| 属性              | 説明                                                           | 例                                     |
| ----------------- | -------------------------------------------------------------- | -------------------------------------- |
| `src`             | 埋め込むページのURLを指定します                                | `<iframe src="https://example.com" />` |
| `width`           | iframeの幅を設定します                                         | `<iframe width="500" />`               |
| `height`          | iframeの高さを設定します                                       | `<iframe height="300" />`              |
| `allowFullScreen` | iframeコンテンツをフルスクリーンモードで表示できるようにします | `<iframe allowFullScreen />`           |
| `sandbox`         | iframe内のコンテンツに対する追加の制約を有効にします           | `<iframe sandbox />`                   |
| `loading`         | 読み込み動作を最適化します（例：遅延読み込み）                 | `<iframe loading="lazy" />`            |
| `title`           | アクセシビリティサポートのためにiframeにタイトルを提供します   | `<iframe title="Description" />`       |

iframeの属性の包括的なリストについては、[MDNドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attributes)を参照してください。

### ビデオ埋め込み方法の選択 {#choosing-a-video-embedding-method}

Next.jsアプリケーションに動画を埋め込むには、2つの方法があります：

- **自己ホスティングまたは直接ビデオファイル：** `video`タグを使用して自己ホスティングビデオを埋め込むことができます。これは、プレーヤーの機能や外見を詳細に制御するシナリオに適しています。この統合方法により、Next.js内でビデオコンテンツをカスタマイズし、制御することができます
- **ビデオホスティングサービスを使用する（YouTube、Vimeoなど）：** YouTubeやVimeoのようなビデオホスティングサービスには、`iframe`タグを使用して、彼らのiframeベースのプレーヤーを埋め込みます。この方法ではプレーヤーに対する制御が限定されますが、これらのプラットフォームが提供する便利さと機能を享受できます

アプリケーションの要件と、提供したいユーザ体験に基づいて、適切な埋め込み方法を選択してください。

### 外部ホスティングされたビデオの埋め込み {#embedding-externally-hosted-videos}

外部プラットフォームからビデオを埋め込むには、Next.jsを使用してビデオ情報を取得し、React Suspenseを使用して読み込み中のフォールバック状態を処理できます。

**1. ビデオを埋め込むためのサーバーコンポーネントを作成する**

最初のステップは、ビデオを埋め込むための適切なiframeを生成する[サーバーコンポーネント](https://nextjs.org/docs/app/building-your-application/rendering/server-components)を作成することです。このコンポーネントはビデオのソースURLを取得し、iframeを表示します。

```jsx title="app/ui/video-component.jsx"
export default async function VideoComponent() {
  const src = await getVideoSrc()

  return <iframe src={src} allowFullScreen />
}
```

**2. React Suspenseを使用してビデオコンポーネントをストリームする**

ビデオを埋め込むためのサーバーコンポーネントを作成した後の次のステップは、[React Suspense](https://react.dev/reference/react/Suspense)を使用してコンポーネントを[ストリーム](https://nextjs.org/docs/app/building-your-application/routing/loading-ui-and-streaming)することです。

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import VideoComponent from '../ui/VideoComponent.jsx'

export default function Page() {
  return (
    <section>
      <Suspense fallback={<p>Loading video...</p>}>
        <VideoComponent />
      </Suspense>
      {/* 他のページ内容 */}
    </section>
  )
}
```

> **Good to know**: 外部プラットフォームからビデオを埋め込む際には、以下のベストプラクティスに注意してください:
>
> - ビデオの埋め込み時にレスポンシブ対応を確保し、CSSを使用してiframeやビデオプレーヤーが異なる画面サイズに適応するようにします
> - 特にデータプランが限られているユーザのために、[ネットワーク条件に基づいたビデオのロード戦略](https://yoast.com/site-speed-tips-for-faster-video/)を実装します

このアプローチは、ページのブロッキングを防ぎ、ユーザーがビデオコンポーネントがストリームされる間にページと対話できるようにするため、より良いユーザー体験を提供します。

より魅力的で情報豊富なローディングエクスペリエンスを考慮し、フォールバックUIとしてローディングスケルトンを使用しましょう。単純なローディングメッセージの代わりに、次のようにビデオプレーヤーに似たスケルトンを表示できます：

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import VideoComponent from '../ui/VideoComponent.jsx'
import VideoSkeleton from '../ui/VideoSkeleton.jsx'

export default function Page() {
  return (
    <section>
      <Suspense fallback={<VideoSkeleton />}>
        <VideoComponent />
      </Suspense>
      {/* 他のページ内容 */}
    </section>
  )
}
```

## 自己ホスト型ビデオ {#self-hosted-videos}

自己ホスティングは、次の理由で好まれる場合があります：

- **完全な管理と独立性：** 自己ホスティングにより、再生から外見まで、ビデオコンテンツを直接管理し、管理権と制約がない状態で完全に所有し、制御できます
- **特定のニーズに合わせたカスタマイズ：** 動的な背景ビデオのような特定の要件に理想的で、デザインと機能のニーズに合わせたカスタマイズが可能です
- **性能とスケーラビリティの考慮：** 次第に増加するトラフィックとコンテンツサイズを効率的にサポートするために、性能が高く、スケーラビリティのあるストレージソリューションを選択しましょう
- **コストと統合：** ストレージと帯域幅のコストをNext.jsフレームワークや幅広い技術エコシステムへの簡単な統合の必要性とバランスを取るべきです

### Vercel Blobを使用したビデオホスティング {#using-vercel-blob-for-video-hosting}

[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)は、Next.jsと連携して動作するスケーラブルなクラウドストレージソリューションを提供し、ビデオを効率的にホスティングする方法を提供します。Vercel Blobを使用してビデオをホストする方法は次のとおりです：

**1. Vercel Blob にビデオをアップロードする**

Vercelのダッシュボードで、「ストレージ」タブに移動し、[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)ストアを選択します。Blobテーブルの右上コーナーにある「アップロード」ボタンを見つけてクリックします。その後、アップロードしたいビデオファイルを選択します。アップロードが完了すると、ビデオファイルがBlobテーブルに表示されます。

代替として、サーバーアクションを使用してビデオをアップロードすることもできます。詳細な手順については、[サーバーサイドアップロードに関するVercelドキュメント](https://vercel.com/docs/storage/vercel-blob/server-upload)を参照してください。Vercelは[クライアントサイドのアップロード](https://vercel.com/docs/storage/vercel-blob/client-upload)もサポートしています。この方法は、一部のユースケースに対して好ましい場合があります。

**2. Next.jsでビデオを表示する**

ビデオがアップロードされ保存された後、Next.jsアプリケーションでビデオを表示することができます。以下は、<video>タグとReact Suspenseを使用してこれを行う例です：

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import { list } from '@vercel/blob'

export default function Page() {
  return (
    <Suspense fallback={<p>Loading video...</p>}>
      <VideoComponent fileName="my-video.mp4" />
    </Suspense>
  )
}

async function VideoComponent({ fileName }) {
  const { blobs } = await list({
    prefix: fileName,
    limit: 1,
  })
  const { url } = blobs[0]

  return (
    <video controls preload="none" aria-label="Video player">
      <source src={url} type="video/mp4" />
      Your browser does not support the video tag.
    </video>
  )
}
```

このアプローチでは、ページは`@vercel/blob`のURLを使用してビデオを表示し、`VideoComponent`を利用しています。React SuspenseはビデオのURLがフェッチされ、ビデオが表示する準備ができるまでフォールバックを表示するために使用されます。

### ビデオに字幕を追加する {#adding-subtitles-to-your-video}

ビデオ用の字幕がある場合、`<video>`タグ内に`<track>`要素を使用して簡単に追加できます。ビデオファイルと同様に、[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)から字幕ファイルをフェッチできます。`<VideoComponent>`を字幕を含むように更新する方法は次のとおりです。

```jsx title="app/page.jsx"
async function VideoComponent({ fileName }) {
  const { blobs } = await list({
    prefix: fileName,
    limit: 2,
  })
  const { url } = blobs[0]
  const { url: captionsUrl } = blobs[1]

  return (
    <video controls preload="none" aria-label="Video player">
      <source src={url} type="video/mp4" />
      <track src={captionsUrl} kind="subtitles" srcLang="en" label="English" />
      Your browser does not support the video tag.
    </video>
  )
}
```

このアプローチにより、Next.jsアプリケーションに動画を効果的に自己ホストし、統合できます。

## リソース {#resources}

ビデオの最適化とベストプラクティスについてさらに学ぶには、次のリソースを参照してください：

- **ビデオフォーマットとコーデックの理解：** MP4などの互換性のあるフォーマットとコーデックもしくはWebMのようにWeb最適化のフォーマットを選択してください。詳細は[Mozillaのビデオコーデックに関するガイド](https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Video_codecs)を参照してください
- **ビデオ圧縮：** FFmpeg などのツールを使用して、品質とファイルサイズのバランスをとりながら効果的に動画を圧縮してください。圧縮技術については、[FFmpegの公式ウェブサイト](https://www.ffmpeg.org/)をご覧ください
- **解像度とビットレートの調整：** モバイルデバイスのためにより低い設定で、視聴プラットフォームに基づいて[解像度とビットレート](https://www.dacast.com/blog/bitrate-vs-resolution/#:~:text=The%20two%20measure%20different%20aspects,yield%20different%20qualities%20of%20video)を調整します
- **コンテンツデリバリネットワーク（CDN）：** ビデオ配信の速度を向上させ、高いトラフィックを管理するためにCDNを利用します。一部のストレージソリューション、例えばVercel Blobのようなものを使用する場合、CDN機能は自動的に処理されます。CDNについての詳細およびその利点については[こちら](https://vercel.com/docs/edge-network/overview?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)を参照してください

次のビデオストリーミングプラットフォームを探索して、Next.jsプロジェクトにビデオを統合してください：

### オープンソース`next-video`コンポーネント {#open-source-next-video-component}

- [Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)、S3、Backblaze、およびMuxなど、さまざまなホスティングサービスと互換性のあるNext.js用の`<Video>`コンポーネントを提供します
- 異なるホスティングサービスとともに`next-video.dev`を使用するための[詳細なドキュメント](https://next-video.dev/docs)

### Cloudinaryの統合 {#cloudinary-integration}

- Cloudinaryを使用したNext.jsのための公式[ドキュメントと統合ガイド](https://next.cloudinary.dev/)
- [ドロップインビデオサポート](https://next.cloudinary.dev/cldvideoplayer/basic-usage)用の`<CldVideoPlayer>`コンポーネントを含む
- CloudinaryとNext.jsを統合する[例](https://github.com/cloudinary-community/cloudinary-examples/?tab=readme-ov-file#nextjs)には、[適応型ビットレートストリーミング](https://github.com/cloudinary-community/cloudinary-examples/tree/main/examples/nextjs-cldvideoplayer-abr)が含まれます
- Node.js SDKを含む、Cloudinaryのその他[ライブラリ](https://cloudinary.com/documentation)も利用可能です

### Mux Video API {#mux-video-api}

- MuxはMuxとNext.jsを使用したビデオコースの作成のための[スターターテンプレート](https://github.com/muxinc/video-course-starter-kit)を提供します
- Next.jsアプリケーションのための[高性能ビデオを埋め込むためのMuxの推奨事項](https://www.mux.com/for/nextjs)について学ぶ
- Next.jsでMuxを使用した[例のプロジェクト](https://with-mux-video.vercel.app/)を探索する

### Fastly {#fastly}

- Next.jsにオンデマンド動画やストリーミングメディアを統合するためのFastlyのソリューションについて[詳細](https://www.fastly.com/products/streaming-media/video-on-demand)を学ぶ

### ImageKit.ioの統合 {#imagekit-io-integration}

- Next.jsを使ったImageKitの統合のための[公式のクイックスタートガイド](https://imagekit.io/docs/integration/nextjs)を参照する
- 統合はシームレスなビデオサポートを提供する`<IKVideo>`コンポーネントを提供し、[ビデオの描画](https://imagekit.io/docs/integration/nextjs#rendering-videos)を可能にします
- Node.js SDKなどのその他の[ImageKitライブラリ](https://imagekit.io/docs)も探索してください

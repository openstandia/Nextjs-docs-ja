---
title: 'Video Optimization'
nav_title: 'Videos'
description: 'Next.js アプリケーションでのビデオ最適化の推奨事項とベストプラクティス。'
---

このページでは、Next.js アプリケーションでビデオを使用する方法を説明し、パフォーマンスに影響を与えることなくビデオファイルを保存および表示する方法を示します。

## `<video>` および `<iframe>` を使用する {#using-video-and-iframe}

ビデオは、HTML **`<video>`** タグを使用して直接ビデオファイルをページに埋め込むことができ、外部プラットフォームにホストされているビデオについては **`<iframe>`** を使用します。

### `<video>` {#video}

HTML [`<video>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video) タグは、自己ホストまたは直接提供されたビデオコンテンツを埋め込むことができ、再生と外観を完全に制御できます。

```jsx title="app/ui/video.jsx"
export function Video() {
  return (
    <video width="320" height="240" controls preload="none">
      <source src="/path/to/video.mp4" type="video/mp4" />
      <track
        src="/path/to/captions.vtt"
        kind="subtitles"
        srcLang="en"
        label="English"
      />
      Your browser does not support the video tag.
    </video>
  )
}
```

### 一般的な `<video>` タグ属性 {#common-video-tag-attributes}

| 属性          | 説明                                                                                                            | 例                                   |
| ------------- | --------------------------------------------------------------------------------------------------------------- | ------------------------------------ |
| `src`         | ビデオファイルのソースを指定します。                                                                            | `<video src="/path/to/video.mp4" />` |
| `width`       | ビデオプレーヤーの幅を設定します。                                                                              | `<video width="320" />`              |
| `height`      | ビデオプレーヤーの高さを設定します。                                                                            | `<video height="240" />`             |
| `controls`    | 存在する場合、デフォルトの再生コントロールセットを表示します。                                                  | `<video controls />`                 |
| `autoPlay`    | ページが読み込まれるとビデオが自動的に再生を開始します。 注意：ブラウザによって自動再生のポリシーが異なります。 | `<video autoPlay />`                 |
| `loop`        | ビデオ再生をループします。                                                                                      | `<video loop />`                     |
| `muted`       | デフォルトで音声をミュートします。 `autoPlay` とよく一緒に使用されます。                                        | `<video muted />`                    |
| `preload`     | ビデオがどのようにプリロードされるかを指定します。値は `none`、`metadata`、`auto` です。                        | `<video preload="none" />`           |
| `playsInline` | iOSデバイスでインライン再生を可能にします。特にiOS Safariで自動再生を機能させるために必要になることがあります。 | `<video playsInline />`              |

> **Good to know**: `autoPlay` 属性を使用する際は、ほとんどのブラウザでビデオが自動的に再生されるよう、`muted` 属性も含めることが重要です; iOS デバイスとの互換性のために `playsInline` 属性も含めてください。

ビデオ属性の詳細なリストについては、[MDN ドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video#attributes)を参照してください。

### ビデオのベストプラクティス {#video-best-practices}

- **フォールバック コンテンツ:** `<video>` タグを使用する場合、ビデオ再生をサポートしないブラウザのためにタグ内にフォールバックコンテンツを含めてください
- **字幕またはキャプション:** 耳が不自由または難聴のユーザーのために字幕やキャプションを含めてください `<video>` 要素に [`<track>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/track) タグを使用してキャプションファイルのソースを指定します
- **アクセシブルコントロール:** キーボードナビゲーションとスクリーンリーダー互換性のために標準のHTML5 ビデオコントロールを推奨します 高度なニーズには、[react-player](https://github.com/cookpete/react-player) や [video.js](https://videojs.com/) などのサードパーティプレーヤーを検討してください これらはアクセシブルなコントロールと一貫したブラウザ体験を提供します

### `<iframe>` {#iframe}

HTML `<iframe>` タグは、YouTube や Vimeo などの外部プラットフォームのビデオを埋め込むことを可能にします。

```jsx title="app/page.jsx"
export default function Page() {
  return (
    <iframe src="https://www.youtube.com/embed/19g66ezsKAg" allowFullScreen />
  )
}
```

### 一般的な `<iframe>` タグ属性 {#common-iframe-tag-attributes}

| 属性              | 説明                                                                     | 例                                     |
| ----------------- | ------------------------------------------------------------------------ | -------------------------------------- |
| `src`             | 埋め込むページのURLを指定します。                                        | `<iframe src="https://example.com" />` |
| `width`           | iframeの幅を設定します。                                                 | `<iframe width="500" />`               |
| `height`          | iframeの高さを設定します。                                               | `<iframe height="300" />`              |
| `allowFullScreen` | iframeのコンテンツをフルスクリーンモードで表示できるようにします。       | `<iframe allowFullScreen />`           |
| `sandbox`         | iframe内のコンテンツに対して追加の制限を設定します。                     | `<iframe sandbox />`                   |
| `loading`         | ロード動作を最適化します（例えば、遅延読み込み）。                       | `<iframe loading="lazy" />`            |
| `title`           | iframeのためにアクセシビリティをサポートするためのタイトルを提供します。 | `<iframe title="Description" />`       |

iframe 属性の詳細なリストについては、[MDN ドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attributes)を参照してください。

### ビデオ埋め込み方法の選択 {#choosing-a-video-embedding-method}

Next.js アプリケーションにビデオを埋め込む方法は2つあります：

- **自己ホストまたは直接ビデオファイル：** `<video>` タグを使用して自己ホストのビデオを埋め込み、プレーヤーの機能と外観に対する詳細な制御を必要とするシナリオに対応します。Next.js 内でのこの統合方法により、ビデオコンテンツのカスタマイズと制御が可能になります
- **ビデオホスティングサービスを使用（YouTube、Vimeoなど）：** YouTube や Vimeo などのビデオホスティングサービス向けに、`<iframe>` タグを使用してそれらの iframe ベースのプレーヤーを埋め込みます。この方法ではプレーヤーの一部制御が制限されますが、これらのプラットフォームが提供する使いやすさと機能が提供されます

アプリケーションの要件とユーザー体験に応じて、適切な埋め込み方法を選択してください。

### 外部ホストのビデオを埋め込む {#embedding-externally-hosted-videos}

外部プラットフォームからビデオを埋め込むには、Next.js を使用してビデオ情報を取得し、React のSuspenseで読み込み中のフォールバック状態を処理できます。

**1. ビデオ埋め込み用の Server Component を作成**

最初のステップは、[Server Component](https://nextjs.org/docs/app/building-your-application/rendering/server-components) を作成して、ビデオ埋め込み用の適切な iframe を生成することです。このコンポーネントは、ビデオのソースURLを取得し、iframe をレンダリングします。

```jsx title="app/ui/video-component.jsx"
export default async function VideoComponent() {
  const src = await getVideoSrc()

  return <iframe src={src} allowFullScreen />
}
```

**2. React Suspense を使用してビデオコンポーネントをストリームする**

ビデオを埋め込むためにServer Component を作成した後の次のステップは、[React Suspense](https://react.dev/reference/react/Suspense) を使用して[ストリーム](https://nextjs.org/docs/app/building-your-application/routing/loading-ui-and-streaming)することです。

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import VideoComponent from '../ui/VideoComponent.jsx'

export default function Page() {
  return (
    <section>
      <Suspense fallback={<p>Loading video...</p>}>
        <VideoComponent />
      </Suspense>
      {/* Other content of the page */}
    </section>
  )
}
```

> **Good to know**: 外部プラットフォームからビデオを埋め込む場合、次のベストプラクティスを考慮してください；
>
> - ビデオ埋め込みがレスポンシブであることを確認してください CSS を使用して、iframe またはビデオプレーヤーがさまざまな画面サイズに適応するようにします
> - 特にデータプランが限られているユーザーのために、ネットワーク条件に基づいて[ビデオの読み込み戦略を実装](https://yoast.com/site-speed-tips-for-faster-video/) します

このアプローチは、ページのブロックを防ぎ、ユーザーがビデオコンポーネントがストリーミングされる間にページと対話できるようにするため、より良いユーザー体験を提供します。

より魅力的で情報豊かなロード体験のために、フォールバックUIとしてロードスケルトンを使用することを検討してください。単純なロードメッセージを表示する代わりに、ビデオプレーヤーを模したスケルトンを表示することができます：

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import VideoComponent from '../ui/VideoComponent.jsx'
import VideoSkeleton from '../ui/VideoSkeleton.jsx'

export default function Page() {
  return (
    <section>
      <Suspense fallback={<VideoSkeleton />}>
        <VideoComponent />
      </Suspense>
      {/* Other content of the page */}
    </section>
  )
}
```

## Self-hosted ビデオ {#self-hosted-videos}

自己ホストビデオを選択する理由はいくつかあります：

- **完全な制御と独立性**: 自己ホストはビデオコンテンツの再生から外観までの直接的な管理を提供し、外部プラットフォームの制約がなく、完全な所有権と制御を保証します
- **特定のニーズに合わせたカスタマイズ**: 動的な背景ビデオなど、特定の要件に最適であり、設計と機能のニーズに合わせたカスタマイズが可能です
- **パフォーマンスとスケーラビリティの考慮事項**: 高パフォーマンスでスケーラブルなストレージソリューションを選択し、増加するトラフィックとコンテンツサイズに効果的に対応します
- **コストと統合**: ストレージと帯域幅のコストを、Next.js フレームワークと幅広い技術エコシステムへの簡単な統合の必要性とバランスさせます

### Vercel Blob を使用したビデオホスティング {#using-vercel-blob-for-video-hosting}

[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website) は効率的なビデオホスティングを提供し、Next.js とよく機能するスケーラブルなクラウドストレージソリューションを提供します。Vercel Blob を使用してビデオをホストする方法は次のとおりです：

**1. Vercel Blob にビデオをアップロード**

Vercel ダッシュボードで、「Storage」タブに移動し、[Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website) ストアを選択します。Blob テーブルの右上隅にある「アップロード」ボタンを見つけてクリックします。その後、アップロードしたいビデオファイルを選択します。アップロードが完了すると、ビデオファイルが Blob テーブルに表示されます。

サーバーアクションを使用してビデオをアップロードすることもできます。詳細な手順については、Vercel の[サーバーサイドアップロード](https://vercel.com/docs/storage/vercel-blob/server-upload)に関するドキュメントを参照してください。Vercel は[クライアントサイドアップロード](https://vercel.com/docs/storage/vercel-blob/client-upload)もサポートしており、これは特定のユースケースに対して好ましい方法かもしれません。

**2. Next.js にビデオを表示する**

ビデオがアップロードされ保存された後、Next.js アプリケーションに表示することができます。以下は `<video>` タグと React Suspense を使用してこれを行う例です：

```jsx title="app/page.jsx"
import { Suspense } from 'react'
import { list } from '@vercel/blob'

export default function Page() {
  return (
    <Suspense fallback={<p>Loading video...</p>}>
      <VideoComponent fileName="my-video.mp4" />
    </Suspense>
  )
}

async function VideoComponent({ fileName }) {
  const { blobs } = await list({
    prefix: fileName,
    limit: 1,
  })
  const { url } = blobs[0]

  return (
    <video controls preload="none" aria-label="Video player">
      <source src={url} type="video/mp4" />
      Your browser does not support the video tag.
    </video>
  )
}
```

このアプローチでは、ページは `@vercel/blob` のビデオ URL を使用してビデオを表示し、React Suspense を使用してビデオ URL がフェッチされビデオが表示可能になるまでフォールバックを示します。

### ビデオに字幕を追加する {#adding-subtitles-to-your-video}

ビデオに字幕がある場合、`<video>` タグ内の `<track>` 要素を使用して簡単に追加することができます。ビデオファイルと同様に [Vercel Blob](https://vercel.com/docs/storage/vercel-blob?utm_source=next-site&utm_medium=docs&utm_campaign=next-website) から字幕ファイルを取得することができます。次のように `<VideoComponent>` を更新して字幕を含める方法を示します。

```jsx title="app/page.jsx"
async function VideoComponent({ fileName }) {
  const { blobs } = await list({
    prefix: fileName,
    limit: 2,
  })
  const { url } = blobs[0]
  const { url: captionsUrl } = blobs[1]

  return (
    <video controls preload="none" aria-label="Video player">
      <source src={url} type="video/mp4" />
      <track src={captionsUrl} kind="subtitles" srcLang="en" label="English" />
      Your browser does not support the video tag.
    </video>
  )
}
```

このアプローチに従うことで、Next.js アプリケーションにビデオを効果的に自己ホストし統合することができます。

## リソース {#resources}

ビデオ最適化とそのベストプラクティスについて学び続けるために、次のリソースを参照してください：

- **ビデオ形式とコーデックの理解：** MP4 を互換性のために、または WebM を Web 最適化のためにビデオニーズに応じて正しい形式とコーデックを選択してください 詳細は [Mozilla のビデオコーデックガイド](https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Video_codecs) を参照してください
- **ビデオ圧縮：** FFmpeg などのツールを使用してビデオを効果的に圧縮し、品質とファイルサイズをバランス。圧縮技術については [FFmpeg の公式ウェブサイト](https://www.ffmpeg.org/) で学びます
- **解像度とビットレートの調整：** モバイルデバイス向けに低い設定で、視聴プラットフォームに基づいて[解像度およびビットレート](https://www.dacast.com/blog/bitrate-vs-resolution/#:~:text=The%20two%20measure%20different%20aspects,yield%20different%20qualities%20of%20video) を調整します
- **コンテンツデリバリーネットワーク（CDN）：** CDN を活用してビデオ配信速度を向上させ、高トラフィックを管理 一部のストレージソリューションを使用する場合、例えば Vercel Blob、CDN機能が自動的に処理されます CDN についての詳細は[こちら](https://vercel.com/docs/edge-network/overview?utm_source=next-site&utm_medium=docs&utm_campaign=next-website)で学びましょう

次のビデオストリーミングプラットフォームを探索して、Next.js プロジェクトにビデオを統合します：

### オープン ソース `next-video` コンポーネント {#open-source-next-video-component}

- Vercel Blob、S3、Backblaze、および Mux を含むさまざまなホスティングサービスと互換性のある Next.js 用の `<Video>` コンポーネントを提供します
- さまざまなホスティングサービスでの `next-video.dev` の使用に関する[詳細なドキュメント](https://next-video.dev/docs)

### Cloudinary との統合 {#cloudinary-integration}

- Next.js と Cloudinary を使用するための[公式ドキュメントと統合ガイド](https://next.cloudinary.dev/)
- [ビデオサポートをすぐに利用可能](https://next.cloudinary.dev/cldvideoplayer/basic-usage)にする `<CldVideoPlayer>` コンポーネントを含む
- 次の JS とCloudinary を統合する[例](https://github.com/cloudinary-community/cloudinary-examples/?tab=readme-ov-file#nextjs)、および[Adaptive Bitrate Streaming](https://github.com/cloudinary-community/cloudinary-examples/tree/main/examples/nextjs-cldvideoplayer-abr) を含む
- その他の[Cloudinary ライブラリ](https://cloudinary.com/documentation)もあり、Node.js SDK も利用可能

### Mux Video API {#mux-video-api}

- Mux と Next.js でビデオコースを作成するための[スターターテンプレート](https://github.com/muxinc/video-course-starter-kit)を提供
- [高性能ビデオを Next.js アプリケーションに埋め込む](https://www.mux.com/for/nextjs)ための Mux の推奨事項について学びましょう
- Next.js と Mux の連携を示す[サンプルプロジェクト](https://with-mux-video.vercel.app/)を探索します

### Fastly {#fastly}

- Fastly のソリューションを Next.js に統合し、[ビデオオンデマンド](https://www.fastly.com/products/streaming-media/video-on-demand)およびストリーミングメディアの詳細を学びます

### ImageKit.io との統合 {#imagekit-io-integration}

- Next.js と ImageKit を統合するための[公式クイック スタート ガイド](https://imagekit.io/docs/integration/nextjs)をご覧ください
- 統合により、[シームレスなビデオサポート](https://imagekit.io/docs/integration/nextjs#rendering-videos)を提供する `<IKVideo>` コンポーネントが提供されます
- Node.js SDK など他の[ImageKit ライブラリ](https://imagekit.io/docs) も探索可能です

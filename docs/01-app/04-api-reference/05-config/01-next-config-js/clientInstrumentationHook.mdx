---
title: 'clientInstrumentationHook'
description: 'クライアントサイドのインストゥルメンテーションを有効にします。'
version: 'experimental'
---

## 使用法 {#usage}

有効にすると、Next.js はプロジェクトのルートにある `instrumentation-client.ts` ファイルを検索し、ハイドレーションの前に同期的に実行します。このファイルは初期のJavaScriptチャンクにバンドルされ、他のコードが実行される前に分析やモニタリングを実行することができます。このファイル内のコードはクライアントサイドでのみ実行され、サーバーサイドレンダリング（SSR）中には実行されません。

> **Good to know:**
>
> - クライアントインストゥルメンテーションはバンドルサイズと実行時間を増加させるため、インタラクティビティを遅らせないように最小限に抑えてください。

<Tabs>
<TabItem value="ts" label="TypeScript">

```ts title="next.config.ts" switcher
import type { NextConfig } from 'next'

const nextConfig: NextConfig = {
  experimental: {
    clientInstrumentationHook: true,
  },
}

export default nextConfig
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="next.config.js" switcher
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    clientInstrumentationHook: true,
  },
}

module.exports = nextConfig
```

</TabItem>
</Tabs>

## 例 {#example}

サーバーサイドの[インストゥルメンテーション](/docs/app/building-your-application/optimizing/instrumentation)とは異なり、`instrumentation-client.ts` は `register` 関数をエクスポートする必要はありません。同期コードを直接ファイルに記述できます：

<Tabs>
<TabItem value="ts" label="TypeScript">

```ts title="instrumentation-client.ts" switcher
// register 関数をエクスポートする必要はありません
// このコードはハイドレーションの前に同期的に実行されます
console.log('Client instrumentation initialized')
// パフォーマンスモニタリングを設定
performance.mark('app-init')
// エラートラッキングを設定
window.addEventListener('error', (event) => {
  console.error('Captured in instrumentation:', event.error)
  // エラートラッキングサービスに送信
})
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="instrumentation-client.js" switcher
// register 関数をエクスポートする必要はありません
// このコードはハイドレーションの前に同期的に実行されます
console.log('Client instrumentation initialized')
// パフォーマンスモニタリングを設定
performance.mark('app-init')
// エラートラッキングを設定
window.addEventListener('error', (event) => {
  console.error('Captured in instrumentation:', event.error)
  // エラートラッキングサービスに送信
})
```

</TabItem>
</Tabs>

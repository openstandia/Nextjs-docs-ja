---
title: 'inlineCss'
description: 'インラインCSSサポートを有効にします。'
version: 'experimental'
---

## 使用方法 {#usage}

`<head>` 内にCSSをインライン化する実験的なサポートです。このフラグが有効にされると、通常は `<link>` タグを生成する場所に生成された `<style>` タグが配置されます。

<Tabs>
<TabItem value="ts" label="TypeScript">

```ts title="next.config.ts" switcher
import type { NextConfig } from 'next'

// NextConfigの型定義をインポート

const nextConfig: NextConfig = {
  experimental: {
    inlineCss: true, // インラインCSSを有効にする
  },
}

export default nextConfig
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="next.config.js" switcher
/** @type {import('next').NextConfig} */
// NextConfigの型定義

const nextConfig = {
  experimental: {
    inlineCss: true, // インラインCSSを有効にする
  },
}

module.exports = nextConfig
```

</TabItem>
</Tabs>

## トレードオフ {#trade-offs}

### インラインCSSを使用する場合 {#when-to-use-inline-css}

インラインCSSは、いくつかのシナリオで有益です：

- **初めての訪問者**: CSSファイルはレンダリングをブロックするリソースであるため、インライン化により初回訪問者が経験する初期のダウンロード遅延を解消し、ページ読み込みのパフォーマンスを向上させます

- **パフォーマンス指標**: CSSファイルの追加のネットワークリクエストを削除することで、インライン化はFirst Contentful Paint（FCP）やLargest Contentful Paint（LCP）などの主要な指標を大幅に改善できます

- **遅い接続**: 要求ごとに遅延がかなり増す遅いネットワークのユーザーに対して、ネットワークリクエストの往復回数を減らすことにより、インライン化は顕著なパフォーマンス向上を提供します

- **アトミックCSSバンドル（例：Tailwind）**: Tailwind CSSのようなユーティリティ優先のフレームワークでは、ページに必要なスタイルのサイズは、設計の複雑さに対してO（1）となることが多いです。これにより、現在のページのスタイル全体が軽量であり、ページサイズが増加しても成長しないため、インライン化が魅力的な選択肢となります。Tailwindスタイルをインライン化すると、最小限のペイロードを確保でき、追加のネットワークリクエストが不要になり、さらなるパフォーマンス向上を実現します

### インラインCSSを使用しない場合 {#when-not-to-use-inline-css}

インラインCSSはパフォーマンスに大きな利点をもたらしますが、最適でない場合もあります：

- **巨大なCSSバンドル**: CSSバンドルが大きすぎる場合、インライン化によってHTMLのサイズがかなり増加し、Time to First Byte（TTFB）が遅くなり、遅い接続のユーザーにとってパフォーマンスが低下する可能性があります

- **動的またはページ固有のCSS**: 非常に動的なスタイルや異なるCSSセットを使用するページを持つアプリケーションでは、インライン化により冗長性と膨張が生じる可能性があります。すべてのページの完全なCSSを繰り返しインライン化する必要があるためです

- **ブラウザキャッシュ**: 訪問者が頻繁にサイトに戻る場合、外部CSSファイルによりブラウザはスタイルを効率的にキャッシュし、再訪時のデータ転送を減少します。インライン化CSSにより、この利点がなくなります

これらのトレードオフを慎重に評価し、critical CSS 抽出やハイブリッドアプローチなど、サイトのニーズに合わせた最適な結果のために他の戦略とインライン化を組み合わせることを検討してください。

> **Good to know**:
>
> この機能は現在実験的であり、いくつかの既知の制限があります：
>
> - CSSのインライン化はグローバルに適用され、ページごとに設定することはできません
> - 初回のページロード時にスタイルが重複します―SSRでは `<style>` タグ内で、RSCペイロードでも
> - 静的にレンダリングされたページにナビゲートする際に、重複を避けるためにスタイルはインラインCSSではなく `<link>` タグを使用します
> - この機能は開発モードでは利用できず、本番ビルドのみで動作します

---
title: 'inlineCss'
description: 'インラインCSSサポートを有効にします'
version: 'experimental'
---

## 使用法 {#usage}

`<head>`内でCSSをインライン化するための実験的なサポートです。このフラグを有効にすると、通常`<link>`タグが生成される場所に`<style>`タグが生成されます。

<Tabs>
<TabItem value="ts" label="TypeScript">

```ts title="next.config.ts" switcher
import type { NextConfig } from 'next'

// nextConfigの型はNextConfigです
const nextConfig: NextConfig = {
  experimental: {
    inlineCss: true,
  },
}

export default nextConfig
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="next.config.js" switcher
/** @type {import('next').NextConfig} */
// nextConfigの型は次のようにします
const nextConfig = {
  experimental: {
    inlineCss: true,
  },
}

module.exports = nextConfig
```

</TabItem>
</Tabs>

## トレードオフ {#trade-offs}

### インラインCSSを使用する場合 {#when-to-use-inline-css}

インライン化CSSは、いくつかのシナリオで有益です：

- **初来訪者**：CSSファイルはレンダリングブロックリソースであるため、インライン化により初回訪問者が経験する最初のダウンロード遅延がなくなり、ページロードパフォーマンスが向上します

- **パフォーマンス指標**：CSSファイルの追加のネットワークリクエストを削除することで、インライン化はFirst Contentful Paint（FCP）やLargest Contentful Paint（LCP）などの主要な指標を大幅に改善できます

- **遅い接続**：ネットワークが遅いユーザーにとっては、各リクエストがかなりの遅延を加えるため、インライン化CSSはネットワーク往復を減少させ、目に見えるパフォーマンス向上を提供します

- **Atomic CSSバンドル（例：Tailwind）**：Tailwind CSSのようなユーティリティーファーストのフレームワークでは、ページに必要なスタイルのサイズはデザインの複雑さに対してO(1)であることが多いです。これにより、インライン化が魅力的な選択となります。なぜなら、現在のページのスタイルセット全体が軽量で、ページサイズと共に成長しないからです。Tailwindスタイルをインライン化することで、最小限のペイロードを保証し、追加のネットワークリクエストの必要性を排除します。これにより、さらにパフォーマンスが向上します

### インラインCSSを使用しない場合 {#when-not-to-use-inline-css}

インライン化CSSはパフォーマンスにとって大きなメリットがある一方で、必ずしも最適でないシナリオがあります：

- **大きなCSSバンドル**：CSSバンドルが大きすぎる場合、インライン化はHTMLのサイズを大幅に増加させ、第1バイトまでの時間（TTFB）が遅くなる可能性があり、遅い接続のユーザーにとってパフォーマンスが悪化する恐れがあります
- **動的またはページ固有のCSS**：高度に動的なスタイルを持つアプリケーションや異なるCSSセットを使用するページでは、インライン化は冗長性と膨張を引き起こす可能性があります。すべてのページの完全なCSSが繰り返しインライン化される必要があるかもしれないからです

- **ブラウザキャッシング**：訪問者が頻繁にあなたのサイトに戻る場合、外部CSSファイルはブラウザがスタイルを効率的にキャッシュし、以後の訪問のデータ転送を削減します。インライン化CSSでは、この利点がなくなります

これらのトレードオフを慎重に評価し、クリティカルCSS抽出やハイブリッドアプローチなどの他の戦略と組み合わせることを検討して、サイトのニーズに合わせた最適な結果を得ることをお勧めします。

> **Good to know**:
>
> この機能は現在実験的であり、いくつかの既知の制限があります：
>
> - CSSのインライン化はグローバルに適用され、ページごとに設定できません
> - 初回ページロード時にはスタイルが重複します - SSR用に `<style>` タグ内にあり、RSCペイロードにも存在します
> - 静的にレンダリングされたページに移動する際、重複を避けるためにスタイルはインラインCSSの代わりに `<link>` タグを使用します
> - この機能は開発モードでは利用できず、プロダクションビルドでのみ動作します

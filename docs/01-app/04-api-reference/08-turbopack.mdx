---
title: 'Turbopack'
description: 'Turbopackは、JavaScriptおよびTypeScriptに最適化されたインクリメンタルバンドラーで、Rustで書かれ、Next.jsに組み込まれています。'
---

{/* このドキュメントの内容は、app routerとpages routerの間で共有されています。Pages Routerに特有のコンテンツを追加するには、`<PagesOnly>Content</PagesOnly>`コンポーネントを使用できます。共有されているコンテンツは、コンポーネントでラップされてはいけません。 */}

[Turbopack](https://turbo.build/pack)は、JavaScriptおよびTypeScriptに最適化されたインクリメンタルバンドラーで、Rustで書かれ、Next.jsに組み込まれています。Turbopackは、Next.jsで`pages`ディレクトリーと`app`ディレクトリーの両方で使用でき、ローカル開発を高速化します。

Turbopackを有効にするには、Next.js開発サーバーを実行する際に`--turbopack`フラグを使用してください。

```json title="package.json" highlight={3}
{
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  }
}
```

## 参照 {#reference}

### サポートされている機能 {#supported-features}

Next.jsのTurbopackは、ほとんどのユーザーのためにゼロ構成が必要であり、より高度なユースケースに拡張することができます。Turbopackの現在サポートされている機能について詳しく知りたい方は、[APIリファレンス](/docs/app/api-reference/config/next-config-js/turbo)をご覧ください。

### サポートされていない機能 {#unsupported-features}

現在、Turbopackは`next dev`のみをサポートし、`next build`はサポートしていません。私たちは現在、安定性を目指して、ビルドのサポートに取り組んでいます。

現在サポートされていない機能は次のとおりです：

- Turbopackは、[Lightning CSS](https://lightningcss.dev/)を活用しており、いくつかの使用頻度が低いCSSモジュールの機能をサポートしていません
  - `:local`および`:global`はスタンドアロンの疑似クラスとしてはサポートされておらず。関数バリアントのみがサポートされています。例えば、`:global(a)`のように使用します
  - CSS変数によって置き換えられた`@value`規則
  - `:import`および`:export`のICSS規則
- [無効なCSSコメント構文](https://stackoverflow.com/questions/51843506/are-double-slash-comments-valid-in-css)である`//`など
  - CSSのコメントは、仕様として`/* comment */`のように書かれるべきです
  - Sassなどのプリプロセッサは、この代替コメント構文をサポートしています
- `next.config.js`における[`webpack()`](/docs/app/api-reference/config/next-config-js/webpack)構成
  - TurbopackはWebpackを置き換えるため、webpack構成はサポートされません
  - Turbopackを設定する方法については、[ドキュメンテーション](/docs/app/api-reference/config/next-config-js/turbo)をご覧ください
  - Turbopackでは、[一部のWebpackローダー](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders)がサポートされています
- Babel (`.babelrc`)
  - Turbopackはすべてのトランスパイルおよび最適化のために[SWC](/docs/architecture/nextjs-compiler#why-swc)コンパイラを活用しています。これは、Babelがデフォルトでは含まれないことを意味します
  - `.babelrc`ファイルがある場合、Next.jsには共通のBabelプラグインがSWC変換として含まれており、それを有効にすることができます。詳細については[コンパイラドキュメンテーション](/docs/architecture/nextjs-compiler#supported-features)をご覧いただけます
  - 特定のユースケースがカバーされていないことを確認し、それでもBabelを使用する必要がある場合は、`babel-loader`を含めるためにTurbopackの[カスタムwebpackローダーサポート](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders)を利用できます
- App Routerでのroot レイアウトの自動作成
  - この動作は、入力ファイルを変更するため現在サポートされておらず、代わりに、手動で任意の場所にroot レイアウトを追加するエラーが表示されます
- `@next/font`（旧フォントサポート）
  - `@next/font`は`next/font`に置き換えられるため、非推奨です。[`next/font`](/docs/app/building-your-application/optimizing/fonts)はTurbopackで完全にサポートされています
- [Relay transforms](/docs/architecture/nextjs-compiler#relay)
  - 将来的に実装する予定です
- `pages/_document.tsx`での`.css`インポートのブロック
  - 現在、webpackでは、Next.jsは`pages/_document.tsx`での`.css`ファイルのインポートをブロックしています
  - この警告を将来的に実装する予定です
- [`experimental.typedRoutes`](/docs/app/api-reference/config/next-config-js/typedRoutes)
  - 将来的に実装する予定です
- `experimental.nextScriptWorkers`
  - 将来的に実装する予定です
- `experimental.sri.algorithm`
  - 将来的に実装する予定です
- `experimental.fallbackNodePolyfills`
  - 将来的に実装する予定です
- `experimental.esmExternals`
  - Turbopackを用いたNext.jsで、レガシーなesmExternals構成をサポートする計画は現時点ではありません
- [AMP](https://nextjs.org/docs/canary/pages/building-your-application/configuring/amp)
  - Turbopackを用いたNext.jsでAMPをサポートする計画は現時点ではありません
- Yarn PnP
  - Turbopackを用いたNext.jsでYarn PnPをサポートする計画は現時点ではありません
- [`experimental.urlImports`](/docs/app/api-reference/config/next-config-js/urlImports)
  - Turbopackを用いたNext.jsで`experimental.urlImports`をサポートする計画は現時点ではありません
- [`:import`および`:export`のICSS規則](https://github.com/css-modules/icss)
  - Turbopackが使用するCSSパーサーである[Lightning CSS](https://lightningcss.dev/css-modules.html)ではこれらの規則をサポートしていないため、Turbopackを用いたNext.jsでの`:import`および`:export`のICSS規則をサポートする計画は現時点ではありません
- edge runtimeでの`unstable_allowDynamic`構成

## 例 {#examples}

### トレースファイルの生成 {#generating-trace-files}

トレースファイルは、Next.jsチームがパフォーマンスメトリクスとメモリ使用量の調査と改善を行うために役立ちます。トレースファイルを生成するには、`next dev --turbopack`コマンドに`NEXT_TURBOPACK_TRACING=1`を付け加えます。これにより、`.next/trace.log`ファイルが生成されます。

Turbopackのパフォーマンスとメモリ使用量に関連する問題を報告するときは、GitHubの[問題ページ](https://github.com/vercel/next.js)にトレースファイルを含めてください。

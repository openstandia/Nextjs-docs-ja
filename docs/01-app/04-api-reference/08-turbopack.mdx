---
title: 'Turbopack'
description: 'TurbopackはRustで書かれたJavaScriptとTypeScriptに最適化されたインクリメンタルバンドラで、Next.jsに組み込まれています。'
---

{/* このドキュメントの内容はapp routerとpages routerの間で共有されています。Pages Routerに特有のコンテンツを追加するには、`<PagesOnly>Content</PagesOnly>`コンポーネントを使用してください。共有されるコンテンツはコンポーネントでラップしないでください。 */}

[Turbopack](https://turbo.build/pack)はRustで書かれたJavaScriptとTypeScriptに最適化されたインクリメンタルバンドラであり、Next.jsに組み込まれています。Turbopackは、Next.jsの`pages`ディレクトリと`app`ディレクトリの両方で使用でき、ローカルでの開発をより迅速に行えます。

Turbopackを有効にするには、Next.jsの開発サーバーを実行する際に`--turbopack`フラグを使用します。

```json title="package.json" highlight={3}
{
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  }
}
```

## リファレンス {#reference}

### 対応している機能 {#supported-features}

Next.jsのTurbopackは、ほとんどのユーザーに対してゼロコンフィグレーションで使用可能であり、より高度なユースケースのために拡張できます。Turbopackが現在サポートしている機能について詳しく知りたい方は、[APIリファレンス](/docs/app/api-reference/config/next-config-js/turbo)をご覧ください。

### 対応していない機能 {#unsupported-features}

Turbopackは現在`next dev`のみをサポートしており、`next build`をサポートしていません。安定性に向けて移行する中で、ビルドのサポートに取り組んでいます。

現在サポートされていない機能は以下のとおりです：

- Turbopackは[Lightning CSS](https://lightningcss.dev/)を活用しており、一部の使用頻度の低いCSS Modulesの機能はサポートされていません
  - 独立した疑似クラスとしての`:local`と`:global`。ファンクションバリアントのみがサポートされています。例：`:global(a)`。
  - CSS変数に置き換えられた@valueルール。
  - `:import`と`:export`のICSSルール。
- [不正なCSSコメント構文](https://stackoverflow.com/questions/51843506/are-double-slash-comments-valid-in-css) 例：`//`
  - CSSコメントは、仕様に従って`/* comment */`として書かれるべきです。
  - Sassなどのプリプロセッサは、この代替構文をサポートしています。
- `next.config.js`での[`webpack()`](/docs/app/api-reference/config/next-config-js/webpack)設定
  - TurbopackはWebpackを置き換えるため、webpackの設定はサポートされていません。
  - Turbopackの設定については、[ドキュメントをご覧ください](/docs/app/api-reference/config/next-config-js/turbo)。
  - Turbopackサポートの一部の[Webpackローダー](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders)。
- Babel (`.babelrc`)
  - Turbopackはすべてのトランスパイルと最適化のために[SWC](/docs/architecture/nextjs-compiler#why-swc)コンパイラを活用しています。これにより、Babelはデフォルトでは含まれていません。
  - `.babelrc`ファイルがある場合、特定のユースケースがカバーされていないことを確認したうえで、Babelを使用する必要がある場合は、Turbopackの[カスタムwebpackローダーのサポート](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders)を利用して`babel-loader`を含めることができます。
- App Routerでroot レイアウトを自動的に作成
  - この動作は現在サポートされていません。入力ファイルを変更するため、代わりに希望する場所に手動でroot レイアウトを追加するためのエラーメッセージが表示されます。
- `@next/font`（レガシーフォントサポート）
  - `@next/font`は`next/font`に置き換えられるため廃止されました。[`next/font`](/docs/app/building-your-application/optimizing/fonts)はTurbopackで完全にサポートされています。
- [Relayトランスフォーム](/docs/architecture/nextjs-compiler#relay)
  - これについては将来的に実装予定です。
- `pages/_document.tsx`における`.css`インポートのブロック
  - 現在Webpackを使用しているNext.jsでは`pages/_document.tsx`における`.css`ファイルのインポートをブロックしています。
  - この警告の実装を将来的に予定しています。
- [`experimental.typedRoutes`](/docs/app/api-reference/config/next-config-js/typedRoutes)
  - これについては将来的に実装予定です。
- `experimental.nextScriptWorkers`
  - これについては将来的に実装予定です。
- `experimental.sri.algorithm`
  - これについては将来的に実装予定です。
- `experimental.fallbackNodePolyfills`
  - これについては将来的に実装予定です。
- `experimental.esmExternals`
  - Turbopackを使用したNext.jsではレガシーesmExternals設定をサポートする計画は現在ありません。
- [AMP](https://nextjs.org/docs/canary/pages/building-your-application/configuring/amp)。
  - Turbopackを使用したNext.jsでAMPをサポートする計画はありません。
- Yarn PnP
  - Turbopackを使用したNext.jsでYarn PnPをサポートする計画はありません。
- [`experimental.urlImports`](/docs/app/api-reference/config/next-config-js/urlImports)
  - Turbopackを使用したNext.jsで`experimental.urlImports`をサポートする計画はありません。
- [`:import`と`:export`のICSSルール](https://github.com/css-modules/icss)
  - Turbopackが使用するCSSパーサである[Lightning CSS](https://lightningcss.dev/css-modules.html)がこれらのルールをサポートしていないため、Turbopackを使用したNext.jsで`:import`と`:export`のICSSルールをサポートする計画はありません。
- edge runtimeでの`unstable_allowDynamic`設定

## 例 {#examples}

### トレースファイルの生成 {#generating-trace-files}

トレースファイルは、Next.jsチームがパフォーマンスメトリクスとメモリ使用量を調査し改善するのに役立ちます。トレースファイルを生成するには、`NEXT_TURBOPACK_TRACING=1`を`next dev --turbopack`コマンドに追加します。これにより、`.next/trace.log`ファイルが生成されます。

Turbopackのパフォーマンスとメモリ使用量に関連する問題を報告する際は、トレースファイルを[GitHub](https://github.com/vercel/next.js)のイシューに含めてください。

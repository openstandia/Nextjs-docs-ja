---
title: 'Edge Runtime'
description: 'Edge Runtime の API 参照。'
---

{/* このドキュメントの内容は app router と pages router の間で共有されています。Pages Router に特有の内容を追加するには `<PagesOnly>Content</PagesOnly>` コンポーネントをご利用ください。共有するコンテンツはコンポーネントでラップしないでください。 */}

Next.js Edge Runtime はミドルウェアで使用され、以下のAPIをサポートします。

## ネットワークAPI {#network-apis}

| API                                                                             | 説明                           |
| ------------------------------------------------------------------------------- | ------------------------------ |
| [`Blob`](https://developer.mozilla.org/docs/Web/API/Blob)                       | Blob を表します                |
| [`fetch`](https://developer.mozilla.org/docs/Web/API/Fetch_API)                 | リソースを取得します           |
| [`FetchEvent`](https://developer.mozilla.org/docs/Web/API/FetchEvent)           | fetch イベントを表します       |
| [`File`](https://developer.mozilla.org/docs/Web/API/File)                       | ファイルを表します             |
| [`FormData`](https://developer.mozilla.org/docs/Web/API/FormData)               | フォームデータを表します       |
| [`Headers`](https://developer.mozilla.org/docs/Web/API/Headers)                 | HTTP ヘッダーを表します        |
| [`Request`](https://developer.mozilla.org/docs/Web/API/Request)                 | HTTP リクエストを表します      |
| [`Response`](https://developer.mozilla.org/docs/Web/API/Response)               | HTTP レスポンスを表します      |
| [`URLSearchParams`](https://developer.mozilla.org/docs/Web/API/URLSearchParams) | URL 検索パラメーターを表します |
| [`WebSocket`](https://developer.mozilla.org/docs/Web/API/WebSocket)             | websocket 接続を表します       |

## エンコーディングAPI {#encoding-apis}

| API                                                                                 | 説明                                           |
| ----------------------------------------------------------------------------------- | ---------------------------------------------- |
| [`atob`](https://developer.mozilla.org/en-US/docs/Web/API/atob)                     | base-64 エンコードされた文字列をデコードします |
| [`btoa`](https://developer.mozilla.org/en-US/docs/Web/API/btoa)                     | 文字列を base-64 にエンコードします            |
| [`TextDecoder`](https://developer.mozilla.org/docs/Web/API/TextDecoder)             | Uint8Array を文字列にデコードします            |
| [`TextDecoderStream`](https://developer.mozilla.org/docs/Web/API/TextDecoderStream) | ストリーム用の連結可能なデコーダー             |
| [`TextEncoder`](https://developer.mozilla.org/docs/Web/API/TextEncoder)             | 文字列を Uint8Array にエンコードします         |
| [`TextEncoderStream`](https://developer.mozilla.org/docs/Web/API/TextEncoderStream) | ストリーム用の連結可能なエンコーダー           |

## ストリームAPI {#stream-apis}

| API                                                                                                     | 説明                                 |
| ------------------------------------------------------------------------------------------------------- | ------------------------------------ |
| [`ReadableStream`](https://developer.mozilla.org/docs/Web/API/ReadableStream)                           | 読み取り可能なストリームを表します   |
| [`ReadableStreamBYOBReader`](https://developer.mozilla.org/docs/Web/API/ReadableStreamBYOBReader)       | ReadableStream のリーダーを表します  |
| [`ReadableStreamDefaultReader`](https://developer.mozilla.org/docs/Web/API/ReadableStreamDefaultReader) | ReadableStream のリーダーを表します  |
| [`TransformStream`](https://developer.mozilla.org/docs/Web/API/TransformStream)                         | トランスフォームストリームを表します |
| [`WritableStream`](https://developer.mozilla.org/docs/Web/API/WritableStream)                           | 書き込み可能なストリームを表します   |
| [`WritableStreamDefaultWriter`](https://developer.mozilla.org/docs/Web/API/WritableStreamDefaultWriter) | WritableStream のライターを表します  |

## 暗号化API {#crypto-apis}

| API                                                                       | 説明                                                                                 |
| ------------------------------------------------------------------------- | ------------------------------------------------------------------------------------ |
| [`crypto`](https://developer.mozilla.org/docs/Web/API/Window/crypto)      | プラットフォームの暗号機能にアクセスします                                           |
| [`CryptoKey`](https://developer.mozilla.org/docs/Web/API/CryptoKey)       | 暗号鍵を表します                                                                     |
| [`SubtleCrypto`](https://developer.mozilla.org/docs/Web/API/SubtleCrypto) | ハッシュ化、署名、暗号化または復号化のような一般的な暗号プリミティブにアクセスします |

## Web 標準API {#web-standard-apis}

| API                                                                                                                   | 説明                                                                                                                                                      |
| --------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [`AbortController`](https://developer.mozilla.org/docs/Web/API/AbortController)                                       | 必要に応じて1つ以上の DOM リクエストを中止できます                                                                                                        |
| [`Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)                           | 値の配列を表します                                                                                                                                        |
| [`ArrayBuffer`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer)               | 汎用の固定長の生バイナリデータバッファを表します                                                                                                          |
| [`Atomics`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Atomics)                       | 静的メソッドとしてのアトミック操作を提供します                                                                                                            |
| [`BigInt`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/BigInt)                         | 任意の精度を持つ整数を表します                                                                                                                            |
| [`BigInt64Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/BigInt64Array)           | 64 ビットの符号付き整数の型付けされた配列を表します                                                                                                       |
| [`BigUint64Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/BigUint64Array)         | 64 ビットの符号なし整数の型付けされた配列を表します                                                                                                       |
| [`Boolean`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)                       | 論理エンティティを表し、`true` または `false` の 2 つの値を持つことができます                                                                             |
| [`clearInterval`](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/clearInterval)                 | 以前に `setInterval()` を呼び出すことによって確立されたタイミングで繰り返されるアクションをキャンセルします                                               |
| [`clearTimeout`](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/clearTimeout)                   | 以前に `setTimeout()` を呼び出すことによって確立されたタイミングで繰り返されるアクションをキャンセルします                                                |
| [`console`](https://developer.mozilla.org/docs/Web/API/Console)                                                       | ブラウザのデバッグコンソールにアクセスします                                                                                                              |
| [`DataView`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/DataView)                     | `ArrayBuffer` の汎用ビューを表します                                                                                                                      |
| [`Date`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Date)                             | プラットフォームに依存しない形式で時間の単一の瞬間を表します                                                                                              |
| [`decodeURI`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/decodeURI)                   | `encodeURI` または類似のルーチンによって以前に作成された URI (Uniform Resource Identifier) をデコードします                                               |
| [`decodeURIComponent`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/decodeURIComponent) | `decodeURIComponent` によって作成された URI (Uniform Resource Identifier) のコンポーネントをデコードします                                                |
| [`DOMException`](https://developer.mozilla.org/docs/Web/API/DOMException)                                             | DOM で発生するエラーを表します                                                                                                                            |
| [`encodeURI`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeURI)                   | 文字の UTF-8 エンコーディングを表す 1、2、3、または 4 個のエスケープシーケンスによって URI (Uniform Resource Identifier) のインスタンスをエンコードします |
| [`encodeURIComponent`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent) | URI コンポーネントのインスタンスをエンコードし、文字の UTF-8 エンコーディングを表す 1、2、3、または 4 個のエスケープシーケンスによってエンコードします    |
| [`Error`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error)                           | 文を実行したり、プロパティにアクセスしようとしたときのエラーを表します                                                                                    |
| [`EvalError`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/EvalError)                   | グローバル関数 `eval()` に関するエラーを表します                                                                                                          |
| [`Float32Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Float32Array)             | 32 ビットの浮動小数点数の型付けされた配列を表します                                                                                                       |
| [`Float64Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Float64Array)             | 64 ビットの浮動小数点数の型付けされた配列を表します                                                                                                       |
| [`Function`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function)                     | 関数を表します                                                                                                                                            |
| [`Infinity`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Infinity)                     | 数学的な無限大の値を表します                                                                                                                              |
| [`Int8Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Int8Array)                   | 8 ビットの符号付き整数の型付けされた配列を表します                                                                                                        |
| [`Int16Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Int16Array)                 | 16 ビットの符号付き整数の型付けされた配列を表します                                                                                                       |
| [`Int32Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Int32Array)                 | 32 ビットの符号付き整数の型付けされた配列を表します                                                                                                       |
| [`Intl`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Intl)                             | 国際化および地域化機能へのアクセスを提供します                                                                                                            |
| [`isFinite`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/isFinite)                     | 値が有限数かどうかを判定します                                                                                                                            |
| [`isNaN`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/isNaN)                           | 値が `NaN` かどうかを判定します                                                                                                                           |
| [`JSON`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/JSON)                             | JavaScript の値を JSON フォーマットに変換したり、逆に JSON 形式の値を JavaScript の値に変換するための機能を提供します                                     |
| [`Map`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Map)                               | 値のコレクションを表し、各値は一度だけ出現することができます                                                                                              |
| [`Math`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Math)                             | 数学的関数および定数にアクセスできます                                                                                                                    |
| [`Number`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)                         | 数値を表します                                                                                                                                            |
| [`Object`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)                         | すべての JavaScript オブジェクトの基盤となるオブジェクトを表します                                                                                        |
| [`parseFloat`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/parseFloat)                 | 文字列引数を解析し、浮動小数点数を返します                                                                                                                |
| [`parseInt`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/parseInt)                     | 文字列引数を解析し、指定した基数の整数を返します                                                                                                          |
| [`Promise`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)                       | 非同期操作の最終的な完了（または失敗）とその結果の値を表します                                                                                            |
| [`Proxy`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Proxy)                           | 基本操作（例：プロパティの検索、代入、列挙、関数の呼び出しなど）に対するカスタム動作を定義するために使用されるオブジェクトを表します                      |
| [`queueMicrotask`](https://developer.mozilla.org/docs/Web/API/queueMicrotask)                                         | 実行されるマイクロタスクをキューに入れます                                                                                                                |
| [`RangeError`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/RangeError)                 | 値が許可されている値の集合または範囲に含まれないときに発生するエラーを表します                                                                            |
| [`ReferenceError`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError)         | 存在しない変数が参照されたときに発生するエラーを表します                                                                                                  |
| [`Reflect`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Reflect)                       | インターセプト可能な JavaScript 操作に対するメソッドを提供します                                                                                          |
| [`RegExp`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/RegExp)                         | 正規表現を表し、文字の組み合わせをマッチさせることができます                                                                                              |
| [`Set`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Set)                               | 値のコレクションを表し、各値は一度だけ出現することができます                                                                                              |
| [`setInterval`](https://developer.mozilla.org/docs/Web/API/setInterval)                                               | 一定時間の遅延を設けた繰り返しの処理を行うための関数を呼び出します                                                                                        |
| [`setTimeout`](https://developer.mozilla.org/docs/Web/API/setTimeout)                                                 | 指定したミリ秒数後に関数を呼び出すか、式を評価します                                                                                                      |
| [`SharedArrayBuffer`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer)   | 汎用の固定長の生バイナリデータバッファを表します                                                                                                          |
| [`String`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)                         | 文字列のシーケンスを表します                                                                                                                              |
| [`structuredClone`](https://developer.mozilla.org/docs/Web/API/Web_Workers_API/Structured_clone_algorithm)            | 値のディープコピーを生成します                                                                                                                            |
| [`Symbol`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Symbol)                         | オブジェクトプロパティのキーとして使用されるユニークで不変のデータ型を表します                                                                            |
| [`SyntaxError`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError)               | 文法的に無効なコードを解釈しようとしたときに発生するエラーを表します                                                                                      |
| [`TypeError`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/TypeError)                   | 値が予想された型ではない場合に発生するエラーを表します                                                                                                    |
| [`Uint8Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)                 | 8 ビットの符号なし整数の型付けされた配列を表します                                                                                                        |
| [`Uint8ClampedArray`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray)   | 0-255 に制限された8ビット符号なし整数の型付けされた配列を表します                                                                                         |
| [`Uint32Array`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint32Array)               | 32 ビットの符号なし整数の型付けされた配列を表します                                                                                                       |
| [`URIError`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/URIError)                     | グローバルな URI 処理関数が誤って使用されたときに発生するエラーを表します                                                                                 |
| [`URL`](https://developer.mozilla.org/docs/Web/API/URL)                                                               | オブジェクト URL を作成するために使用される静的メソッドを提供するオブジェクトを表します                                                                   |
| [`URLPattern`](https://developer.mozilla.org/docs/Web/API/URLPattern)                                                 | URL パターンを表します                                                                                                                                    |
| [`URLSearchParams`](https://developer.mozilla.org/docs/Web/API/URLSearchParams)                                       | キー/バリューペアのコレクションを表します                                                                                                                 |
| [`WeakMap`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WeakMap)                       | キーが弱く参照されるキー/バリューペアのコレクションを表します                                                                                             |
| [`WeakSet`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WeakSet)                       | コレクション内の各オブジェクトが一度だけ出現するオブジェクトのコレクションを表します                                                                      |
| [`WebAssembly`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly)               | WebAssembly にアクセスを提供します                                                                                                                        |

## Next.js 特有のポリフィル {#next-js-specific-polyfills}

- [`AsyncLocalStorage`](https://nodejs.org/api/async_context.html#class-asynclocalstorage)

## 環境変数 {#environment-variables}

`process.env` を使用して、 `next dev` と `next build` の両方で [環境変数](/docs/app/building-your-application/configuring/environment-variables) にアクセスできます。

## 非対応のAPI {#unsupported-apis}

Edge Runtime には以下のような制限があります：

- ネイティブの Node.js API は**サポートされていません**。たとえば、ファイルシステムへの読み書きができません。
- `node_modules` は、ES Modules を実装し、ネイティブの Node.js API を使用しない限り使用可能です。
- `require` を直接呼び出すことは**できません**。代わりに、ES Modules を使用してください。

次の JavaScript 言語機能は無効にされており、**動作しません：**

| API                                                                                                                             | 説明                                                                        |
| ------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------- |
| [`eval`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/eval)                                       | 文字列で表された JavaScript コードを評価します                              |
| [`new Function(evalString)`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function)               | 引数として提供されたコードで新しい関数を作成します                          |
| [`WebAssembly.compile`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/compile)         | バッファソースから WebAssembly モジュールをコンパイルします                 |
| [`WebAssembly.instantiate`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/WebAssembly/instantiate) | バッファソースから WebAssembly モジュールをコンパイルしインスタンス化します |

稀なケースですが、コードに（またはインポートされたコードに） 実行時に到達できない動的なコード評価ステートメントが含まれていて、それがツリーシェイキングによって削除されないケースがあります。
ミドルウェアの設定で特定のファイルを許可することで、チェックを緩和することができます：

```javascript title="middleware.ts"
export const config = {
  unstable_allowDynamic: [
    // 単一のファイルを許可します
    '/lib/utilities.js',
    // グロブを使って function-bind サードパーティモジュール内のものをすべて許可します
    '**/node_modules/function-bind/**',
  ],
}
```

`unstable_allowDynamic` は [glob](https://github.com/micromatch/micromatch#matching-features) もしくは glob の配列で、特定のファイルに対して動的コード評価を無視します。グロブはアプリケーションのrootフォルダからの相対パスです。

もしこれらのステートメントが Edge 上で実行されると、_エラーを投げ、ランタイムエラーを引き起こします_。

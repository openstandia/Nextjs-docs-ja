---
title: 'fetch'
description: '拡張されたfetch関数のAPIリファレンス。'
---

Next.jsは、サーバ側の各リクエストが独自の永続的キャッシュと再検証のセマンティクスを設定できるようにするために、[Web `fetch()` API](https://developer.mozilla.org/docs/Web/API/Fetch_API)を拡張します。

ブラウザでは、`cache` オプションはfetchリクエストが*ブラウザの\_HTTPキャッシュとどのようにやりとりするかを示します。この拡張により、`cache` は*サーバー側\_fetchリクエストがフレームワークの永続的な[データキャッシュ](/docs/app/building-your-application/caching#data-cache)とどのようにやりとりするかを示します。

`fetch`をServer Components内で`async`と`await`を使って直接呼び出せます。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
export default async function Page() {
  let data = await fetch('https://api.vercel.app/blog')
  let posts = await data.json()
  return (
    <ul>
      {posts.map((post) => (
        <li key={post.id}>{post.title}</li>
      ))}
    </ul>
  )
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
export default async function Page() {
  let data = await fetch('https://api.vercel.app/blog')
  let posts = await data.json()
  return (
    <ul>
      {posts.map((post) => (
        <li key={post.id}>{post.title}</li>
      ))}
    </ul>
  )
}
```

</TabItem>
</Tabs>

## `fetch(url, options)` {#fetch-url-options}

Next.jsは[Web `fetch()` API](https://developer.mozilla.org/docs/Web/API/Fetch_API)を拡張しているため、[ネイティブのオプション](https://developer.mozilla.org/docs/Web/API/fetch#parameters)はすべて使用可能です。

### `options.cache` {#options-cache}

Next.jsの[データキャッシュ](/docs/app/building-your-application/caching#data-cache)とのやりとりをどのように行うかを設定します。

```ts
fetch(`https://…`, { cache: 'force-cache' | 'no-store' })
```

- **`auto no cache`**（デフォルト）：Next.jsは、開発段階では各リクエストに対してリモートサーバからリソースを取得しますが、`next build`時に静的にプリレンダリングされるため、1度だけフェッチを実行します。ルートで[Dynamic APIs](/docs/app/building-your-application/rendering/server-components#dynamic-rendering)が検出された場合、Next.jsは各リクエストごとにリソースを取得します
- **`no-store`**：ルートでDynamic APIsが検出されない場合でも、Next.jsは各リクエストでリモートサーバからリソースを取得します
- **`force-cache`**：Next.jsはデータキャッシュ内で一致するリクエストを探します
  - 一致があり新鮮ならば、キャッシュから返されます
  - 一致がない場合や古い一致の場合、Next.jsはリモートサーバからリソースを取得し、キャッシュをダウンロードしたリソースで更新します

### `options.next.revalidate` {#options-next-revalidate}

```ts
fetch(`https://…`, { next: { revalidate: false | 0 | number } })
```

リソースのキャッシュ有効期間を秒単位で設定します。

- **`false`** - リソースを無期限にキャッシュします。セマンティクス的には`revalidate: Infinity`と同等です。HTTPキャッシュは時間の経過とともに古いリソースを削除する可能性があります
- **`0`** - リソースがキャッシュされないようにします
- **`number`** - （秒単位で）リソースのキャッシュ寿命を最大`n`秒に設定します

> **Good to know**:
>
> - 個々の`fetch()`リクエストがルートの[デフォルトの`再検証`](/docs/app/api-reference/file-conventions/route-segment-config#revalidate)よりも低い`revalidate`番号を設定すると、ルート全体の再検証間隔が短くなります
> - 同じルートで異なる`revalidate`値をもつ同じURLのfetchリクエストが2つある場合、より低い値が使用されます
> - 便宜上、`revalidate`が数値に設定されている場合に`cache`オプションを設定する必要はありません
> - `{ revalidate: 3600, cache: 'no-store' }` のような矛盾したオプションはエラーを引き起こします

### `options.next.tags` {#options-next-tags}

```ts
fetch(`https://…`, { next: { tags: ['collection'] } })
```

リソースのキャッシュタグを設定します。データは[`revalidateTag`](https://nextjs.org/docs/app/api-reference/functions/revalidateTag)を使用してオンデマンドで再検証できます。カスタムタグの最大長は256文字で、最大タグ項目は64です。

## トラブルシューティング {#troubleshooting}

### Fetchのデフォルトである`auto no store`と`cache: 'no-store'`が開発段階で新しいデータを表示しない {#fetch-default-auto-no-store-and-cache-no-store-not-showing-fresh-data-in-development}

Next.jsは、ローカル開発での高速なレスポンスを提供し、課金されるAPIコールのコストを削減するために、Server Componentsにおける`fetch`レスポンスをホットモジュールリプレースメント（HMR）間でキャッシュしています。

デフォルトでは、[HMRキャッシュ](/docs/app/api-reference/config/next-config-js/serverComponentsHmrCache)はすべてのfetchリクエストに適用され、デフォルトの`auto no cache`と`cache: 'no-store'`オプションを含みます。これにより、キャッシュされていないリクエストはHMRの更新間で新鮮なデータを表示しませんが、ナビゲーションや全ページリロード時にはキャッシュがクリアされます。

さらなる情報については、[`serverComponentsHmrCache`](/docs/app/api-reference/config/next-config-js/serverComponentsHmrCache)ドキュメントを参照してください。

## バージョン履歴 {#version-history}

| Version   | Changes               |
| --------- | --------------------- |
| `v13.0.0` | `fetch`を導入しました |

---
title: 'fetch'
description: '拡張された fetch 関数のAPIリファレンスです。'
---

Next.jsは、[Web `fetch()` API](https://developer.mozilla.org/docs/Web/API/Fetch_API)を拡張して、サーバー上の各リクエストがそれ自身の永続的なキャッシングおよび再検証のセマンティクスを設定できるようにしています。

ブラウザでは、`cache`オプションはfetchリクエストが*ブラウザの\_HTTPキャッシュとどのように対話するかを示します。この拡張により、`cache`は*サーバーサイド\_でのfetchリクエストがフレームワークの永続的な[データキャッシュ](/docs/app/building-your-application/caching#data-cache)とどのように対話するかを示します。

`fetch`をServer Components内で直接`async`と`await`を使って呼び出すことができます。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
export default async function Page() {
  let data = await fetch('https://api.vercel.app/blog')
  let posts = await data.json()
  return (
    <ul>
      {posts.map((post) => (
        <li key={post.id}>{post.title}</li>
      ))}
    </ul>
  )
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
export default async function Page() {
  let data = await fetch('https://api.vercel.app/blog')
  let posts = await data.json()
  return (
    <ul>
      {posts.map((post) => (
        <li key={post.id}>{post.title}</li>
      ))}
    </ul>
  )
}
```

</TabItem>
</Tabs>

## `fetch(url, options)` {#fetch-url-options}

Next.jsは、[Web `fetch()` API](https://developer.mozilla.org/docs/Web/API/Fetch_API)を拡張しているため、[ネイティブオプション](https://developer.mozilla.org/docs/Web/API/fetch#parameters)のうちどれでも使用できます。

### `options.cache` {#options-cache}

Next.jsの[データキャッシュ](/docs/app/building-your-application/caching#data-cache)とリクエストがどのように対話するかを設定します。

```ts
fetch(`https://...`, { cache: 'force-cache' | 'no-store' })
```

- **`auto no cache`** (デフォルト): Next.jsは開発時にリモートサーバーから毎リクエスト資源を取得しますが、ルートが静的にプリレンダリングされるため、`next build`の際には一度だけ取得します。ルート上で[動的API](/docs/app/building-your-application/rendering/server-components#dynamic-rendering)が検出される場合、Next.jsは毎リクエストで資源を取得します。
- **`no-store`**: 動的APIがルートで検出されなくても、Next.jsは毎リクエストでリモートサーバーから資源を取得します。
- **`force-cache`**: Next.jsはデータキャッシュ内で一致するリクエストを探します。
  - 一致するものがあり、それが新鮮であれば、キャッシュから返されます。
  - 一致しない場合や古い一致がある場合、Next.jsはリモートサーバーから資源を取得し、ダウンロードした資源でキャッシュを更新します。

### `options.next.revalidate` {#options-next-revalidate}

```ts
fetch(`https://...`, { next: { revalidate: false | 0 | number } })
```

資源のキャッシュ寿命を設定します（秒単位）。

- **`false`** - 資源を無期限にキャッシュします。セマンティクス的には`revalidate: Infinity`と同等です。HTTPキャッシュは時間とともに古い資源を削除することがあります。
- **`0`** - 資源がキャッシュされないようにします。
- **`number`** - （秒単位）資源が最大`n`秒間のキャッシュ寿命を持つべきことを指定します。

> **知っておくとよいこと**:
>
> - 個々の`fetch()`リクエストがルートの[デフォルトの`revalidate`](/docs/app/api-reference/file-conventions/route-segment-config#revalidate)よりも低い`revalidate`値を設定する場合、ルート全体の再検証間隔は短くなります。
> - 同じルート内で同じURLの2つのfetchリクエストが異なる`revalidate`値を持っている場合、より低い値が使用されます。
> - 便宜上、`revalidate`を数値に設定する場合は`cache`オプションを設定する必要はありません。
> - `{ revalidate: 3600, cache: 'no-store' }`のような矛盾したオプションはエラーを引き起こします。

### `options.next.tags` {#options-next-tags}

```ts
fetch(`https://...`, { next: { tags: ['collection'] } })
```

資源のキャッシュタグを設定します。データは[`revalidateTag`](https://nextjs.org/docs/app/api-reference/functions/revalidateTag)を使用してオンデマンドで再検証できます。カスタムタグの最大長は256文字、最大タグアイテムは64です。

## トラブルシューティング {#troubleshooting}

### Fetchのデフォルト`auto no store`と`cache: 'no-store'`が開発環境で新鮮なデータを表示しない {#fetch-default-auto-no-store-and-cache-no-store-not-showing-fresh-data-in-development}

Next.jsは、ローカル開発時にHot Module Replacement（HMR）を経たServer Componentsでの`fetch`レスポンスをキャッシュし、より高速なレスポンスを提供し、有料APIコールのコストを削減します。

デフォルトで、[HMRキャッシュ](/docs/app/api-reference/config/next-config-js/serverComponentsHmrCache)はデフォルトの`auto no cache`や`cache: 'no-store'`オプションを含むすべてのfetchリクエストに適用されます。これは、キャッシュされていないリクエストがHMRのリフレッシュ間で新鮮なデータを表示しないことを意味します。しかし、ナビゲーションや全ページリロードでキャッシュはクリアされます。

詳細は、[`serverComponentsHmrCache`](/docs/app/api-reference/config/next-config-js/serverComponentsHmrCache)ドキュメントを参照してください。

## バージョン履歴 {#version-history}

| バージョン | 変更                    |
| ---------- | ----------------------- |
| `v13.0.0`  | `fetch`が導入されました |

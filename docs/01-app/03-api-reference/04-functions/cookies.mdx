---
title: 'cookies'
description: 'cookies 関数の API リファレンス。'
---

`cookies` は **非同期** 関数で、[Server Component](/docs/app/building-your-application/rendering/server-components)で HTTP の受信リクエストcookieを読み取り、[Server Actions](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[Route Handlers](/docs/app/building-your-application/routing/route-handlers)での送信リクエストcookieの読み取り/書き込みを行います。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme') // cookieの「theme」を取得
  return '...'
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme') // cookieの「theme」を取得
  return '...'
}
```

</TabItem>
</Tabs>

## リファレンス {#reference}

### メソッド {#methods}

以下のメソッドが利用可能です

| メソッド                    | 戻り値の型       | 説明                                                                         |
| --------------------------- | ---------------- | ---------------------------------------------------------------------------- |
| `get('name')`               | Object           | cookie名を受け取り、その名前と値を持つオブジェクトを返します                 |
| `getAll()`                  | Array of objects | 一致する名前を持つすべてのcookieのリストを返します                           |
| `has('name')`               | Boolean          | cookie名を受け取り、cookieが存在するかどうかに基づいて真偽値を返します       |
| `set(name, value, options)` | -                | cookie名、値、およびオプションを受け取り、送信リクエストのcookieを設定します |
| `delete(name)`              | -                | cookie名を受け取り、cookieを削除します                                       |
| `clear()`                   | -                | すべてのcookieを削除します                                                   |
| `toString()`                | String           | cookieの文字列表現を返します                                                 |

### オプション {#options}

cookieを設定するとき、`options`オブジェクトには以下のプロパティがサポートされています

| オプション        | 型                                     | 説明                                                                      |
| ----------------- | -------------------------------------- | ------------------------------------------------------------------------- |
| `name`            | String                                 | cookieの名前を指定します                                                  |
| `value`           | String                                 | cookieに格納される値を指定します                                          |
| `expires`         | Date                                   | cookieが失効する正確な日付を定義します                                    |
| `maxAge`          | Number                                 | cookieの存続期間を秒単位で設定します                                      |
| `domain`          | String                                 | cookieが利用可能なドメインを指定します                                    |
| `path`            | String, default: `'/'`                 | cookieの範囲をドメイン内の特定のパスに制限します                          |
| `secure`          | Boolean                                | cookieがHTTPS接続でのみ送信されることを保証して、セキュリティを強化します |
| `httpOnly`        | Boolean                                | cookieをHTTPリクエストに限定し、クライアント側のアクセスを防ぎます        |
| `sameSite`        | Boolean, `'lax'`, `'strict'`, `'none'` | cookieのクロスサイトリクエストの動作を制御します                          |
| `priority`        | String (`"low"`, `"medium"`, `"high"`) | cookieの優先度を指定します                                                |
| `encode('value')` | Function                               | cookieの値をエンコードするために使用する関数を指定します                  |
| `partitioned`     | Boolean                                | cookieが[分割された](/privacycg/CHIPS)かどうかを示します                  |

デフォルト値が設定されている唯一のオプションは`path`です。

これらのオプションについて詳しくは、[MDNのドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)をご覧ください。

## Good to know {#good-to-know}

- `cookies` は **非同期** 関数であり、promiseを返します。cookieにアクセスするためには`async/await`またはReactの[`use`](https://react.dev/reference/react/use)関数を使用する必要があります。
  - バージョン14以前では、`cookies`は同期関数でした。後方互換性を助けるために、Next.js 15ではまだ同期的にアクセスすることができますが、この動作は将来非推奨となります。
- `cookies` は[Dynamic API](/docs/app/building-your-application/rendering/server-components#dynamic-apis)であり、返される値は事前に知ることができません。これをレイアウトやページで使用すると、ルートを[動的レンダリング](/docs/app/building-your-application/rendering/server-components#dynamic-rendering)に最適化します。
- `.delete` メソッドは次の場合にのみ呼び出すことができます：
  - [Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[Route Handler](/docs/app/building-your-application/routing/route-handlers)内にある場合。
  - `.set`が呼ばれるのと同じドメインに所属している場合。また、コードはcookieを削除したいプロトコル（HTTPまたはHTTPS）と同じプロトコルで実行されなければなりません。
- HTTPはストリーミングが始まった後でcookieを設定することを許可していないので、`[Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)` か `[Route Handler](/docs/app/building-your-application/routing/route-handlers)` で `.set` を使う必要があります。

## Server Components での Cookie の動作を理解する {#understanding-cookie-behavior-in-server-components}

Server Componentsでcookieを扱う際、cookieは基本的にクライアント側のストレージメカニズムであることを理解することが重要です：

- **cookieの読み込み**は、クライアントのブラウザがHTTPリクエストヘッダーでサーバーに送信するcookieデータにアクセスするため、Server Componentsで動作します。
- **cookieの設定**は、Route HandlerやServer Actionを使用しても、Server Component内では直接行うことはできません。これはcookieが実際にはブラウザに格納されるためであり、サーバーには格納されません。

サーバーは`Set-Cookie`ヘッダーを介してブラウザにcookieを保存するよう指示を送信することしかできません - 実際の保存はクライアント側で行われます。これは状態を変更する操作（`.set`、`.delete`、`.clear`）がRoute HandlerやServer Actionで実行される必要がある理由です。ここではレスポンスヘッダーを正しく設定することができます。

## 例 {#examples}

### cookieを取得する {#getting-a-cookie}

単一のcookieを取得するには、`(await cookies()).get('name')` メソッドを使用します：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme') // cookieの「theme」を取得
  return '...'
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme') // cookieの「theme」を取得
  return '...'
}
```

</TabItem>
</Tabs>

### すべてのcookieを取得する {#getting-all-cookies}

すべての一致する名前のcookieを取得するには、`(await cookies()).getAll()`メソッドを使用します。`name`を指定しない場合、利用可能なすべてのcookieを返します。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  return cookieStore.getAll().map((cookie) => (
    <div key={cookie.name}>
      <p>Name: {cookie.name}</p> {/* cookie名 */}
      <p>Value: {cookie.value}</p> {/* cookie値 */}
    </div>
  ))
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  return cookieStore.getAll().map((cookie) => (
    <div key={cookie.name}>
      <p>Name: {cookie.name}</p> {/* cookie名 */}
      <p>Value: {cookie.value}</p> {/* cookie値 */}
    </div>
  ))
}
```

</TabItem>
</Tabs>

### cookieを設定する {#setting-a-cookie}

cookieを設定するには、[Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[Route Handler](/docs/app/building-your-application/routing/route-handlers)で`(await cookies()).set(name, value, options)`メソッドを使用します。[`options`オブジェクト](#options)はオプションです。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function create(data) {
  const cookieStore = await cookies()

  cookieStore.set('name', 'lee') // cookieの「name」に「lee」を設定
  // もしくは
  cookieStore.set('name', 'lee', { secure: true }) // セキュアオプション付きの設定
  // もしくは
  cookieStore.set({
    name: 'name',
    value: 'lee',
    httpOnly: true,
    path: '/',
  }) // オプション付きのオブジェクトでの設定
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function create(data) {
  const cookieStore = await cookies()

  cookieStore.set('name', 'lee') // cookieの「name」に「lee」を設定
  // もしくは
  cookieStore.set('name', 'lee', { secure: true }) // セキュアオプション付きの設定
  // もしくは
  cookieStore.set({
    name: 'name',
    value: 'lee',
    httpOnly: true,
    path: '/',
  }) // オプション付きのオブジェクトでの設定
}
```

</TabItem>
</Tabs>

### cookieが存在するかの確認 {#checking-if-a-cookie-exists}

cookieが存在するか確認するには、`(await cookies()).has(name)` メソッドを使用します：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.ts" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const hasCookie = cookieStore.has('theme') // cookie「theme」の存在確認
  return '...'
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const hasCookie = cookieStore.has('theme') // cookie「theme」の存在確認
  return '...'
}
```

</TabItem>
</Tabs>

### cookieを削除する {#deleting-cookies}

cookieを削除する方法は3つあります。

`delete()`メソッドを使用する：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).delete('name') // cookie「name」を削除
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).delete('name') // cookie「name」を削除
}
```

</TabItem>
</Tabs>

同じ名前と空の値で新しいcookieを設定する：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', '') // cookie「name」を空の値で設定
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', '') // cookie「name」を空の値で設定
}
```

</TabItem>
</Tabs>

`maxAge` を0に設定すると、cookieは直ちに失効します。`maxAge`は秒単位で値を受け取ります。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', 'value', { maxAge: 0 }) //cookie「name」を0秒で失効させる
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', 'value', { maxAge: 0 }) //cookie「name」を0秒で失効させる
}
```

</TabItem>
</Tabs>

## バージョン履歴 {#version-history}

| バージョン   | 変更点                                                                                                                    |
| ------------ | ------------------------------------------------------------------------------------------------------------------------- |
| `v15.0.0-RC` | `cookies`は非同期関数になりました。[codemod](/docs/app/building-your-application/upgrading/codemods#150) が利用可能です。 |
| `v13.0.0`    | `cookies`が導入されました。                                                                                               |

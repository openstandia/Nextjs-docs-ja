---
title: 'cookies'
description: 'cookies 関数の API リファレンス。'
---

`cookies` は**非同期**関数で、[Server Component](/docs/app/building-your-application/rendering/server-components)内で HTTP 受信リクエストのクッキーを読み取ったり、[Server Actions](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)や[Route Handlers](/docs/app/building-your-application/routing/route-handlers)内で送信リクエストのクッキーを読み書きするために使用されます。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
</Tabs>

## リファレンス {#reference}

### メソッド {#methods}

以下のメソッドが利用可能です

| メソッド                    | 戻り値の型         | 説明                                                                             |
| --------------------------- | ------------------ | -------------------------------------------------------------------------------- |
| `get('name')`               | オブジェクト       | クッキー名を受け取り、その名前と値を持つオブジェクトを返します                   |
| `getAll()`                  | オブジェクトの配列 | 一致する名前を持つすべてのクッキーのリストを返します                             |
| `has('name')`               | 真偽値             | クッキー名を受け取り、そのクッキーが存在するかどうかに基づいてブール値を返します |
| `set(name, value, options)` | -                  | クッキー名、値、およびオプションを受け取り、送信リクエストのクッキーを設定します |
| `delete(name)`              | -                  | クッキー名を受け取り、そのクッキーを削除します                                   |
| `clear()`                   | -                  | すべてのクッキーを削除します                                                     |
| `toString()`                | 文字列             | クッキーの文字列表現を返します                                                   |

### オプション {#options}

クッキーを設定する際には、`options` オブジェクトから以下のプロパティをサポートしています

| オプション        | 型                                     | 説明                                                                             |
| ----------------- | -------------------------------------- | -------------------------------------------------------------------------------- |
| `name`            | 文字列                                 | クッキーの名前を指定します                                                       |
| `value`           | 文字列                                 | クッキーに格納する値を指定します                                                 |
| `expires`         | 日付                                   | クッキーが失効する正確な日時を定義します                                         |
| `maxAge`          | 数値                                   | クッキーの寿命を秒で設定します                                                   |
| `domain`          | 文字列                                 | クッキーが利用可能なドメインを指定します                                         |
| `path`            | 文字列、デフォルト: `'/'`              | クッキーの作用範囲をドメイン内の特定のパスに制限します                           |
| `secure`          | 真偽値                                 | クッキーをHTTPS接続でのみ送信するようにして、セキュリティを強化します            |
| `httpOnly`        | 真偽値                                 | クッキーをHTTPリクエストに限定し、クライアント側からのアクセスを防ぎます         |
| `sameSite`        | 真偽値, `'lax'`, `'strict'`, `'none'`  | クッキーのクロスサイトリクエスト動作を制御します                                 |
| `priority`        | 文字列 (`"low"`, `"medium"`, `"high"`) | クッキーの優先度を指定します                                                     |
| `encode('value')` | 関数                                   | クッキーの値をエンコードするために使用される関数を指定します                     |
| `partitioned`     | 真偽値                                 | クッキーが[分割されているかどうか](https://github.com/privacycg/CHIPS)を示します |

唯一のデフォルト値を持つオプションは `path` です。

これらのオプションについてさらに詳しく知りたい方は、[MDN ドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)をご覧ください。

## Good to know {#good-to-know}

- `cookies` は**非同期**関数であり、Promise を返します。`async/await` または React の [`use`](https://react.dev/reference/react/use) 関数を使用してクッキーにアクセスする必要があります。
  - バージョン 14 以前では、`cookies` は同期関数でした。互換性を維持するため、Next.js 15 では同期的にアクセスすることが可能ですが、この機能は将来的に廃止されます。
- `cookies` は、予め返される値が分からない、[Dynamic API](/docs/app/building-your-application/rendering/server-components#dynamic-apis) です。これをレイアウトまたはページで使用すると、そのルートは[動的レンダリング](/docs/app/building-your-application/rendering/server-components#dynamic-rendering)に切り替わります。
- `.delete` メソッドは以下の場合のみ呼び出せます:
  - [Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations) または [Route Handler](/docs/app/building-your-application/routing/route-handlers) 内にいる場合。
  - 呼び出し元のドメインが `.set` が呼び出されるドメインと同じ場合。また、削除したいクッキーと同じプロトコル (HTTP または HTTPS) でコードが実行される必要があります。
- HTTP はストリーミングの開始後にクッキーの設定を許可しないため、[Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations) や [Route Handler](/docs/app/building-your-application/routing/route-handlers) で `.set` を使用する必要があります。

## Server Component におけるクッキーの動作を理解する {#understanding-cookie-behavior-in-server-components}

Server Component でクッキーを扱う際には、クッキーが基本的にクライアント側のストレージメカニズムであることを理解することが重要です：

- **クッキーの読み取り** は、クライアントのブラウザーが HTTP リクエストヘッダーでサーバーに送信するクッキーデータにアクセスするため、Server Component で動作します。
- **クッキーの設定** は、Server Component では Route Handler または Server Action を介した場合であっても、直接行うことはできません。これは、クッキーが実際にはサーバーではなく、ブラウザによって格納されるためです。

サーバーはブラウザにクッキーを保存するよう指示を送ること（`Set-Cookie` ヘッダー経由）しかできず、実際の保存はクライアント側で行われます。このため、状態を変更するクッキー操作（`.set`, `.delete`, `.clear`）は、レスポンスヘッダーを適切に設定できる Route Handler または Server Action 内で実行する必要があります。

## 例 {#examples}

### クッキーを取得する {#getting-a-cookie}

単一のクッキーを取得するために `(await cookies()).get('name')` メソッドを使用できます。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
</Tabs>

### すべてのクッキーを取得する {#getting-all-cookies}

`(await cookies()).getAll()` メソッドを使用して、特定の名前に一致するすべてのクッキーを取得できます。`name` が指定されていない場合、利用可能なすべてのクッキーを返します。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  return cookieStore.getAll().map((cookie) => (
    <div key={cookie.name}>
      <p>Name: {cookie.name}</p>
      <p>Value: {cookie.value}</p>
    </div>
  ))
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  return cookieStore.getAll().map((cookie) => (
    <div key={cookie.name}>
      <p>Name: {cookie.name}</p>
      <p>Value: {cookie.value}</p>
    </div>
  ))
}
```

</TabItem>
</Tabs>

### クッキーを設定する {#setting-a-cookie}

[Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations) または[Route Handler](/docs/app/building-your-application/routing/route-handlers) 内で、`(await cookies()).set(name, value, options)` メソッドを使用してクッキーを設定できます。[`options` オブジェクト](#options) はオプションです。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function create(data) {
  const cookieStore = await cookies()

  cookieStore.set('name', 'lee')
  // または
  cookieStore.set('name', 'lee', { secure: true })
  // または
  cookieStore.set({
    name: 'name',
    value: 'lee',
    httpOnly: true,
    path: '/',
  })
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function create(data) {
  const cookieStore = await cookies()

  cookieStore.set('name', 'lee')
  // または
  cookieStore.set('name', 'lee', { secure: true })
  // または
  cookieStore.set({
    name: 'name',
    value: 'lee',
    httpOnly: true,
    path: '/',
  })
}
```

</TabItem>
</Tabs>

### クッキーの存在確認 {#checking-if-a-cookie-exists}

`(await cookies()).has(name)` メソッドを使用して、クッキーが存在するかどうかを確認できます：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.ts" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const hasCookie = cookieStore.has('theme')
  return '...'
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const hasCookie = cookieStore.has('theme')
  return '...'
}
```

</TabItem>
</Tabs>

### クッキーを削除する {#deleting-cookies}

クッキーを削除する方法は3つあります。

`delete()` メソッドを使用する：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).delete('name')
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).delete('name')
}
```

</TabItem>
</Tabs>

同じ名前で空の値を持つ新しいクッキーを設定する：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', '')
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', '')
}
```

</TabItem>
</Tabs>

`maxAge` を 0 に設定してクッキーを即座に無効にする。`maxAge` は秒単位で値を受け取ります。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', 'value', { maxAge: 0 })
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', 'value', { maxAge: 0 })
``
}
```

</TabItem>
</Tabs>

## バージョン履歴 {#version-history}

| バージョン   | 変更点                                                                                                                      |
| ------------ | --------------------------------------------------------------------------------------------------------------------------- |
| `v15.0.0-RC` | `cookies` は非同期関数になりました。 [codemod](/docs/app/building-your-application/upgrading/codemods#150) が利用可能です。 |
| `v13.0.0`    | `cookies` が導入されました。                                                                                                |

---
title: 'cookies'
description: 'cookies 関数の API リファレンス。'
---

`cookies` は**非同期**関数であり、[Server Component](/docs/app/building-your-application/rendering/server-components)で HTTP の受信リクエストのcookieを読み取り、[Server Actions](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[Route Handlers](/docs/app/building-your-application/routing/route-handlers)で発信リクエストのcookieを読み書きすることを可能にします。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
</Tabs>

## リファレンス {#reference}

### メソッド {#methods}

次のメソッドが利用可能です

| メソッド                    | 戻り値の型         | 説明                                                                                |
| --------------------------- | ------------------ | ----------------------------------------------------------------------------------- |
| `get('name')`               | オブジェクト       | Cookie の名前を受け取り、その名前と値を含むオブジェクトを返します                   |
| `getAll()`                  | オブジェクトの配列 | 名前が一致するすべてのCookieのリストを返します                                      |
| `has('name')`               | ブール値           | Cookie の名前を受け取り、その Cookie が存在するかどうかを基にブール値を返します     |
| `set(name, value, options)` | -                  | Cookie の名前、値、およびオプションを受け取り、発信リクエストの Cookie を設定します |
| `delete(name)`              | -                  | Cookie の名前を受け取り、その Cookie を削除します                                   |
| `clear()`                   | -                  | すべてのCookieを削除します                                                          |
| `toString()`                | 文字列             | Cookie の文字列表現を返します                                                       |

### オプション {#options}

Cookie を設定する際、`options` オブジェクトから次のプロパティがサポートされています

| オプション        | 型                                      | 説明                                                                                          |
| ----------------- | --------------------------------------- | --------------------------------------------------------------------------------------------- |
| `name`            | 文字列                                  | Cookie の名前を指定します                                                                     |
| `value`           | 文字列                                  | Cookie に保存する値を指定します                                                               |
| `expires`         | 日付                                    | Cookie の有効期限を正確に指定します                                                           |
| `maxAge`          | 数値                                    | Cookie の寿命を秒単位で設定します                                                             |
| `domain`          | 文字列                                  | Cookie が存在するドメインを指定します                                                         |
| `path`            | 文字列、デフォルト: `'/'`               | Cookie の範囲をドメイン内の特定のパスに限定します                                             |
| `secure`          | ブール値                                | Cookie が HTTPS 接続でのみ送信されることを保証し、セキュリティを強化します                    |
| `httpOnly`        | ブール値                                | Cookie を HTTP リクエストに限定し、クライアント側からのアクセスを防ぎます                     |
| `sameSite`        | ブール値、`'lax'`、`'strict'`、`'none'` | Cookie のクロスサイトリクエストの動作を制御します                                             |
| `priority`        | 文字列（`"low"`、`"medium"`、`"high"`） | Cookie の優先順位を指定します                                                                 |
| `encode('value')` | 関数                                    | Cookie の値をエンコードするために使用される関数を指定します                                   |
| `partitioned`     | ブール値                                | Cookie が[パーティショニングされているかどうか](https://github.com/privacycg/CHIPS)を示します |

デフォルト値が設定されている唯一のオプションは `path` です。

これらのオプションについて詳しくは、[MDN ドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)を参照してください。

## 知っておくと良いこと {#good-to-know}

- `cookies` は、非同期関数であり、Promise を返します。cookie にアクセスするには `async/await` または React の [`use`](https://react.dev/reference/react/use) 関数を使用する必要があります。
  - バージョン14以前では、`cookies` は同期関数でした。後方互換性を助けるために、Next.js 15 でも同期的にアクセスできますが、この動作は将来的に廃止予定です。
- `cookies` は、事前に返される値を予測できない[Dynamic API](/docs/app/building-your-application/rendering/server-components#dynamic-apis)です。レイアウトやページで使用する場合、ルートは[動的レンダリング](/docs/app/building-your-application/rendering/server-components#dynamic-rendering)にオプトインします。
- `.delete` メソッドは次の条件でのみ呼び出すことができます：
  - [Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[Route Handler](/docs/app/building-your-application/routing/route-handlers)内で実行すること
  - `.set`が呼び出されたのと同じドメインに属している場合です。さらに、コードは削除したいCookieと同じプロトコル（HTTPまたはHTTPS）で実行される必要があります。
- HTTPはストリーミングが開始された後にCookieを設定することを許可しませんので、[Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[Route Handler](/docs/app/building-your-application/routing/route-handlers)で`.set`を使用する必要があります。

## Server Componentにおけるクッキーの挙動の理解 {#understanding-cookie-behavior-in-server-components}

Server ComponentでCookieを扱う場合、Cookieは本質的にクライアント側のストレージメカニズムであることを理解することが重要です：

- **Cookie の読み取り**は、クライアントのブラウザがサーバーに送信する HTTP リクエストヘッダー内のクッキーデータにアクセスしているため、Server Componentで動作します。
- **Cookie の設定**は、Route HandlerまたはServer Actionを使用しても、Server Component内では直接行うことができません。これは、Cookieがサーバーではなくブラウザに保存されるためです。

サーバーはブラウザにクッキーを保存させる指示（`Set-Cookie` ヘッダー経由）を送信することしかできません。実際のストレージはクライアント側で行われます。そのため、状態を変更するCookie操作（`.set`、`.delete`、`.clear`）は、レスポンスヘッダーを適切に設定できるRoute HandlerまたはServer Actionで実行する必要があります。

## 例 {#examples}

### Cookie の取得 {#getting-a-cookie}

単一のCookieを取得するには、`(await cookies()).get('name')` メソッドを使用できます：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
</Tabs>

### すべてのCookieの取得 {#getting-all-cookies}

`(await cookies()).getAll()` メソッドを使用して、名前が一致するすべてのCookieを取得できます。`name`が指定されていない場合、利用可能なすべてのCookieを返します。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  return cookieStore.getAll().map((cookie) => (
    <div key={cookie.name}>
      <p>Name: {cookie.name}</p>
      <p>Value: {cookie.value}</p>
    </div>
  ))
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  return cookieStore.getAll().map((cookie) => (
    <div key={cookie.name}>
      <p>Name: {cookie.name}</p>
      <p>Value: {cookie.value}</p>
    </div>
  ))
}
```

</TabItem>
</Tabs>

### Cookie の設定 {#setting-a-cookie}

Cookieの設定には、[Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[Route Handler](/docs/app/building-your-application/routing/route-handlers)内で`(await cookies()).set(name, value, options)` メソッドを使用できます。[`options` オブジェクト](#options)は任意です。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function create(data) {
  const cookieStore = await cookies()

  cookieStore.set('name', 'lee')
  // または
  cookieStore.set('name', 'lee', { secure: true })
  // または
  cookieStore.set({
    name: 'name',
    value: 'lee',
    httpOnly: true,
    path: '/',
  })
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function create(data) {
  const cookieStore = await cookies()

  cookieStore.set('name', 'lee')
  // または
  cookieStore.set('name', 'lee', { secure: true })
  // または
  cookieStore.set({
    name: 'name',
    value: 'lee',
    httpOnly: true,
    path: '/',
  })
}
```

</TabItem>
</Tabs>

### Cookie が存在するかの確認 {#checking-if-a-cookie-exists}

Cookieが存在するかどうかを確認するには、`(await cookies()).has(name)` メソッドを使用できます：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.ts" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const hasCookie = cookieStore.has('theme')
  return '...'
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const hasCookie = cookieStore.has('theme')
  return '...'
}
```

</TabItem>
</Tabs>

### Cookie の削除 {#deleting-cookies}

Cookieを削除する方法は3つあります。

`delete()` メソッドを使用する：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).delete('name')
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).delete('name')
}
```

</TabItem>
</Tabs>

同じ名前で空の値を持つ新しいCookieを設定する：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', '')
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', '')
}
```

</TabItem>
</Tabs>

`maxAge` を 0 に設定すると、Cookie は即時に期限切れになります。`maxAge` は秒単位の値を受け付けます。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', 'value', { maxAge: 0 })
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', 'value', { maxAge: 0 })
```

}

```
</TabItem>
</Tabs>

## バージョン履歴 {#version-history}

| バージョン       | 変更内容                                                                                                                   |
| ----------- | ------------------------------------------------------------------------------------------------------------------------- |
| `v15.0.0-RC` | `cookies` は今や非同期関数です。[codemod](/docs/app/building-your-application/upgrading/codemods#150)が利用できます。    |
| `v13.0.0`   | `cookies` が導入されました。                                                                                                     |
```

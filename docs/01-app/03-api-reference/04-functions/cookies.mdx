---
title: 'cookies'
description: 'cookies 関数の API リファレンス。'
---

`cookies` は **async** 関数であり、[Server Component](/docs/app/building-your-application/rendering/server-components)内で HTTP 入力リクエストの cookie を読み取り、[Server Actions](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)や[Route Handlers](/docs/app/building-your-application/routing/route-handlers)内で出力リクエスト cookie を読み書きすることができます。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
</Tabs>

## リファレンス {#reference}

### メソッド {#methods}

以下のメソッドが使用可能です：

| メソッド                    | 戻り値の型         | 説明                                                                          |
| --------------------------- | ------------------ | ----------------------------------------------------------------------------- |
| `get('name')`               | オブジェクト       | cookie 名を受け取り、その名前と値を持つオブジェクトを返します                 |
| `getAll()`                  | オブジェクトの配列 | 一致する名前を持つすべての cookies のリストを返します                         |
| `has('name')`               | ブール値           | cookie 名を受け取り、cookie が存在するかどうかを示すブール値を返します        |
| `set(name, value, options)` | -                  | cookie 名、値、およびオプションを受け取り、出力リクエスト cookie を設定します |
| `delete(name)`              | -                  | cookie 名を受け取り、cookie を削除します                                      |
| `clear()`                   | -                  | すべての cookies を削除します                                                 |
| `toString()`                | 文字列             | cookies の文字列表現を返します.                                               |

### オプション {#options}

cookie を設定する際に、`options` オブジェクトから次のプロパティをサポートしています：

| オプション        | 型                                      | 説明                                                                            |
| ----------------- | --------------------------------------- | ------------------------------------------------------------------------------- |
| `name`            | 文字列                                  | cookie の名前を指定します                                                       |
| `value`           | 文字列                                  | cookie に格納される値を指定します                                               |
| `expires`         | 日付                                    | cookie が有効期限を持つ正確な日時を定義します                                   |
| `maxAge`          | 数値                                    | cookie の存続期間を秒単位で設定します                                           |
| `domain`          | 文字列                                  | cookie が利用可能なドメインを指定します                                         |
| `path`            | 文字列、デフォルト: `'/'`               | ドメイン内の特定のパスに cookie の範囲を制限します                              |
| `secure`          | ブール値                                | 追加のセキュリティのために、cookie を HTTPS 接続でのみ送信するように保証します  |
| `httpOnly`        | ブール値                                | cookie を HTTP リクエストに限定し、クライアントからのアクセスを防ぎます         |
| `sameSite`        | ブール値、`'lax'`、`'strict'`、`'none'` | cookie のクロスサイトリクエストの挙動を制御します                               |
| `priority`        | 文字列 (`"low"`, `"medium"`, `"high"`)  | cookie の優先度を指定します                                                     |
| `encode('value')` | 関数                                    | cookie の値をエンコードするために使用される関数を指定します                     |
| `partitioned`     | ブール値                                | cookie が[分割されているかどうか](https://github.com/privacycg/CHIPS)を示します |

デフォルト値を持つ唯一のオプションは `path` です。

これらのオプションの詳細については、[MDN ドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)を参照してください。

## 知っておくと良い情報 {#good-to-know}

- `cookies` は **非同期** 関数であり、promise を返します。`async/await` または React の[`use`](https://react.dev/reference/react/use)関数を使用して cookie にアクセスする必要があります。
  - バージョン 14 以前では、`cookies` は同期関数でした。後方互換性を維持するため、Next.js 15 でも同期的にアクセスできますが、この動作は将来的に廃止される予定です。
- `cookies` は [Dynamic API](/docs/app/building-your-application/rendering/server-components#dynamic-apis) であり、その返される値が事前にわかりません。レイアウトやページで使用すると、そのルートは[動的レンダリング](/docs/app/building-your-application/rendering/server-components#dynamic-rendering)にオプトインします。
- `.delete` メソッドは以下のようにのみ呼び出すことができます：
  - [Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[Route Handler](/docs/app/building-your-application/routing/route-handlers)内で。
  - `.set`が呼び出されたのと同じドメインから発信されている場合に限ります。さらに、このコードは削除したい cookie と同じプロトコル（HTTP または HTTPS）で実行される必要があります。
- ストリーミングが開始された後に cookies を設定することは HTTP では許可されていないため、`.set` を使用する必要があります。

## Server Component における Cookie の動作を理解する {#understanding-cookie-behavior-in-server-components}

Server Component において cookies を扱う際は、cookies が基本的にクライアントサイドのストレージメカニズムであることを理解することが重要です：

- **cookies を読むことは**、クライアントのブラウザが HTTP リクエストヘッダーでサーバーに送信する cookie データにアクセスするため、Server Component で機能します。
- **cookies を設定することは**、Route Handler や Server Action を使っても、Server Component 内で直接行うことはできません。なぜなら cookies は実際にはサーバーではなくブラウザによって格納されるためです。

サーバーは（`Set-Cookie` ヘッダーを介して）cookie を保存するようにブラウザに指示を送信するだけです。実際の保存はクライアント側で行われます。このため、状態を変更する cookie 操作（`.set`、`.delete`、`.clear`）を実行するには、レスポンスヘッダーを適切に設定できる Route Handler や Server Action で行う必要があります。

## 例 {#examples}

### Cookie の取得 {#getting-a-cookie}

`(await cookies()).get('name')`メソッドを使用して単一の cookie を取得できます：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
</Tabs>

### すべての Cookie を取得する {#getting-all-cookies}

`(await cookies()).getAll()` メソッドを使用して、指定された名前に一致するすべての cookies を取得できます。`name` が指定されていない場合は、利用可能なすべての cookies を返します。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  return cookieStore.getAll().map((cookie) => (
    <div key={cookie.name}>
      <p>Name: {cookie.name}</p>
      <p>Value: {cookie.value}</p>
    </div>
  ))
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  return cookieStore.getAll().map((cookie) => (
    <div key={cookie.name}>
      <p>Name: {cookie.name}</p>
      <p>Value: {cookie.value}</p>
    </div>
  ))
}
```

</TabItem>
</Tabs>

### Cookie を設定する {#setting-a-cookie}

(cookie の `options` オブジェクトはオプションです) `(await cookies()).set(name, value, options)` メソッドを使用して、[Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[Route Handler](/docs/app/building-your-application/routing/route-handlers)内で cookie を設定できます。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function create(data) {
  const cookieStore = await cookies()

  cookieStore.set('name', 'lee')
  // または
  cookieStore.set('name', 'lee', { secure: true })
  // または
  cookieStore.set({
    name: 'name',
    value: 'lee',
    httpOnly: true,
    path: '/',
  })
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function create(data) {
  const cookieStore = await cookies()

  cookieStore.set('name', 'lee')
  // または
  cookieStore.set('name', 'lee', { secure: true })
  // または
  cookieStore.set({
    name: 'name',
    value: 'lee',
    httpOnly: true,
    path: '/',
  })
}
```

</TabItem>
</Tabs>

### Cookie が存在するか確認する {#checking-if-a-cookie-exists}

`(await cookies()).has(name)`メソッドを使用して、cookie が存在するかどうかを確認できます：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.ts" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const hasCookie = cookieStore.has('theme')
  return '...'
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const hasCookie = cookieStore.has('theme')
  return '...'
}
```

</TabItem>
</Tabs>

### クッキーを削除する {#deleting-cookies}

cookie を削除する方法は 3 つあります。

`delete()` メソッドを使用する場合：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).delete('name')
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).delete('name')
}
```

</TabItem>
</Tabs>

同じ名前と空の値を持つ新しい cookie を設定する場合：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', '')
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', '')
}
```

</TabItem>
</Tabs>

`maxAge` を 0 に設定すると cookie は即座に有効期限が切れます。`maxAge` は秒単位の値を受け取ります。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', 'value', { maxAge: 0 })
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', 'value', { maxAge: 0 })
}
```

</TabItem>
</Tabs>

## バージョン履歴 {#version-history}

| バージョン   | 変更内容                                                                                                                   |
| ------------ | -------------------------------------------------------------------------------------------------------------------------- |
| `v15.0.0-RC` | `cookies` は非同期関数になりました。 [codemod](/docs/app/building-your-application/upgrading/codemods#150)が利用可能です。 |
| `v13.0.0`    | `cookies` が導入されました。                                                                                               |

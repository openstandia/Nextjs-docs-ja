---
title: 'cookies'
description: 'cookies 関数の API リファレンス。'
---

`cookies` は **非同期** 関数で、[Server Component](/docs/app/building-your-application/rendering/server-components)で HTTP の受信リクエストの cookie を読み取ることができ、[Server Actions](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[Route Handlers](/docs/app/building-your-application/routing/route-handlers)で送信リクエストの cookie を読み書きすることができます。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
</Tabs>

## リファレンス {#reference}

### メソッド {#methods}

以下のメソッドが利用可能です：

| メソッド                    | 戻り値の型       | 説明                                                                              |
| --------------------------- | ---------------- | --------------------------------------------------------------------------------- |
| `get('name')`               | Object           | cookie 名を受け取り、その名前と値を持つオブジェクトを返します。                   |
| `getAll()`                  | Array of objects | 名前の一致するすべての cookie のリストを返します。                                |
| `has('name')`               | Boolean          | cookie 名を受け取り、その cookie が存在するかどうかに基づいて真偽値を返します。   |
| `set(name, value, options)` | -                | cookie 名、値、およびオプションを受け取り、送信リクエストの cookie を設定します。 |
| `delete(name)`              | -                | cookie 名を受け取り、その cookie を削除します。                                   |
| `clear()`                   | -                | すべての cookie を削除します。                                                    |
| `toString()`                | String           | cookie の文字列表現を返します。                                                   |

### オプション {#options}

cookie を設定する際、`options` オブジェクトから以下のプロパティがサポートされています：

| オプション        | 型                                     | 説明                                                                              |
| ----------------- | -------------------------------------- | --------------------------------------------------------------------------------- |
| `name`            | String                                 | cookie の名前を指定します。                                                       |
| `value`           | String                                 | cookie に保存される値を指定します。                                               |
| `expires`         | Date                                   | cookie が期限切れになる正確な日時を定義します。                                   |
| `maxAge`          | Number                                 | cookie の寿命を秒単位で設定します。                                               |
| `domain`          | String                                 | cookie が利用可能なドメインを指定します。                                         |
| `path`            | String, default: `'/'`                 | ドメイン内の特定のパスに対して cookie のスコープを制限します。                    |
| `secure`          | Boolean                                | cookie が HTTPS 接続を介してのみ送信されるようにし、セキュリティを強化します。    |
| `httpOnly`        | Boolean                                | cookie を HTTP リクエストのみに制限し、クライアントサイドでのアクセスを防ぎます。 |
| `sameSite`        | Boolean, `'lax'`, `'strict'`, `'none'` | cookie のクロスサイトリクエストの振る舞いを制御します。                           |
| `priority`        | String (`"low"`, `"medium"`, `"high"`) | cookie の優先度を指定します                                                       |
| `encode('value')` | Function                               | cookie の値をエンコードするために使用される関数を指定します。                     |
| `partitioned`     | Boolean                                | cookie が[分割](https://github.com/privacycg/CHIPS)されているかを示します。       |

デフォルト値を持つ唯一のオプションは `path` です。

これらのオプションに関する詳細については、[MDN ドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)をご覧ください。

## 知っておくと良いこと {#good-to-know}

- `cookies` は **非同期** 関数であり、promise を返します。`async/await` または React の [`use`](https://react.dev/reference/react/use) 関数を使用して cookie にアクセスする必要があります。
  - バージョン 14 およびそれ以前では、`cookies` は同期関数でした。後方互換性を保つために、Next.js 15 でもまだ同期的にアクセスできますが、この動作は将来的に廃止される予定です。
- `cookies` は [Dynamic API](/docs/app/building-your-application/rendering/server-components#dynamic-apis) の一部であり、その返り値は事前に知ることができません。これをレイアウトやページで使用すると、ルートが[動的レンダリング](/docs/app/building-your-application/rendering/server-components#dynamic-rendering)の対象になります。
- `.delete` メソッドは、次の場合にのみ呼び出すことができます：
  - [Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations) または [Route Handler](/docs/app/building-your-application/routing/route-handlers) において。
  - `.set` が呼び出されたのと同じドメインに属する場合。また、削除したい cookie と同じプロトコル（HTTP または HTTPS）でコードを実行する必要があります。
- HTTP はストリーミングの開始後に cookie を設定することを許可しませんので、`.set` を [Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations) または [Route Handler](/docs/app/building-your-application/routing/route-handlers) 内で使用する必要があります。

## Server Component における Cookie の動作理解 {#understanding-cookie-behavior-in-server-components}

Server Component で cookie を扱う際には、cookie が根本的にクライアントサイドのストレージメカニズムであることを理解することが重要です：

- **cookie の読み込み** は、クライアントのブラウザがサーバーに送信する HTTP リクエストヘッダーの cookie データにアクセスすることによって Server Component で機能します。
- **cookie の設定** は、ルートハンドラーやサーバーアクションを使用しても Server Component で直接行うことはできません。なぜなら、cookie はサーバーではなく、実際にはブラウザによって保存されるためです。

サーバーは `Set-Cookie` ヘッダーを介してブラウザに cookie を保存するように指示を送ることのみ可能で、実際の保存はクライアントサイドで行われます。これが、状態を変更する cookie 操作（`.set`, `.delete`, `.clear`）が、レスポンスヘッダーを適切に設定できるルートハンドラーやサーバーアクションで実行されなければならない理由です。

## 例 {#examples}

### cookie の取得 {#getting-a-cookie}

1 つの cookie を取得するために `(await cookies()).get('name')` メソッドを使用することができます：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
</Tabs>

### すべての cookie の取得 {#getting-all-cookies}

一致する名前を持つすべての cookie を取得するには、`(await cookies()).getAll()` メソッドを利用できます。`name` が指定されていない場合、利用可能なすべての cookie を返します。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  return cookieStore.getAll().map((cookie) => (
    <div key={cookie.name}>
      <p>Name: {cookie.name}</p>
      <p>Value: {cookie.value}</p>
    </div>
  ))
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  return cookieStore.getAll().map((cookie) => (
    <div key={cookie.name}>
      <p>Name: {cookie.name}</p>
      <p>Value: {cookie.value}</p>
    </div>
  ))
}
```

</TabItem>
</Tabs>

### cookie の設定 {#setting-a-cookie}

cookie を設定するためには、[Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations) または [Route Handler](/docs/app/building-your-application/routing/route-handlers)で `(await cookies()).set(name, value, options)` メソッドを使用します。[`options` オブジェクト](#options)はオプショナルです。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function create(data) {
  const cookieStore = await cookies()

  cookieStore.set('name', 'lee')
  // or
  cookieStore.set('name', 'lee', { secure: true })
  // or
  cookieStore.set({
    name: 'name',
    value: 'lee',
    httpOnly: true,
    path: '/',
  })
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function create(data) {
  const cookieStore = await cookies()

  cookieStore.set('name', 'lee')
  // or
  cookieStore.set('name', 'lee', { secure: true })
  // or
  cookieStore.set({
    name: 'name',
    value: 'lee',
    httpOnly: true,
    path: '/',
  })
}
```

</TabItem>
</Tabs>

### cookie の存在確認 {#checking-if-a-cookie-exists}

cookie が存在するか確認するためには、`(await cookies()).has(name)` メソッドを使うことができます：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.ts" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const hasCookie = cookieStore.has('theme')
  return '...'
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const hasCookie = cookieStore.has('theme')
  return '...'
}
```

</TabItem>
</Tabs>

### cookie の削除 {#deleting-cookies}

cookie を削除する方法は 3 つあります。

`delete()` メソッドを使用する：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).delete('name')
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).delete('name')
}
```

</TabItem>
</Tabs>

同じ名前で空の値を持つ新しい cookie を設定する：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', '')
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', '')
}
```

</TabItem>
</Tabs>

`maxAge` を 0 に設定すると、cookie は即座に期限切れになります。`maxAge` は秒単位の値を受け付けます。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', 'value', { maxAge: 0 })
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', 'value', { maxAge: 0 })
}
```

</TabItem>
</Tabs>

## バージョン履歴 {#version-history}

| バージョン   | 変更内容                                                                                                                   |
| ------------ | -------------------------------------------------------------------------------------------------------------------------- |
| `v15.0.0-RC` | `cookies` は非同期関数になりました。[codemod](/docs/app/building-your-application/upgrading/codemods#150) が利用可能です。 |
| `v13.0.0`    | `cookies` が導入されました。                                                                                               |

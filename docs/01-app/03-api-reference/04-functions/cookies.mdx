---
title: 'cookies'
description: 'cookies関数のAPIリファレンス。'
---

`cookies`は、[Server Component](/docs/app/building-your-application/rendering/server-components)でHTTPリクエストの受信時にcookieを読み取ったり、[Server Actions](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)や[Route Handlers](/docs/app/building-your-application/routing/route-handlers)でリクエストを送信する際にcookieを書き込んだりすることができる**非同期**関数です。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
</Tabs>

## リファレンス {#reference}

### メソッド {#methods}

以下のメソッドを使用できます：

| メソッド                    | 戻り値の型         | 説明                                                                                 |
| --------------------------- | ------------------ | ------------------------------------------------------------------------------------ |
| `get('name')`               | オブジェクト       | cookieの名前を受け取り、その名前と値を持つオブジェクトを返します。                   |
| `getAll()`                  | オブジェクトの配列 | 一致する名前のすべてのcookieのリストを返します。                                     |
| `has('name')`               | ブール値           | cookieの名前を受け取り、そのcookieが存在するかどうかのブール値を返します。           |
| `set(name, value, options)` | -                  | cookieの名前、値、およびオプションを受け取り、リクエスト送信時のcookieを設定します。 |
| `delete(name)`              | -                  | cookieの名前を受け取り、そのcookieを削除します。                                     |
| `clear()`                   | -                  | すべてのcookieを削除します。                                                         |
| `toString()`                | 文字列             | cookieの文字列表現を返します。                                                       |

### オプション {#options}

cookieを設定する際、`options`オブジェクトから以下のプロパティを使用できます：

| オプション        | 型                                      | 説明                                                                             |
| ----------------- | --------------------------------------- | -------------------------------------------------------------------------------- |
| `name`            | 文字列                                  | cookieの名前を指定します。                                                       |
| `value`           | 文字列                                  | cookieに保存する値を指定します。                                                 |
| `expires`         | 日付                                    | cookieの有効期限を指定します。                                                   |
| `maxAge`          | 数字                                    | cookieの寿命を秒単位で設定します。                                               |
| `domain`          | 文字列                                  | cookieが有効なドメインを指定します。                                             |
| `path`            | 文字列, デフォルト： `'/'`              | ドメイン内の特定のパスでcookieのスコープを制限します。                           |
| `secure`          | ブール値                                | cookieをHTTPS接続でのみ送信することでセキュリティを向上します。                  |
| `httpOnly`        | ブール値                                | cookieをHTTPリクエストに限定し、クライアント側のアクセスを防ぎます。             |
| `sameSite`        | ブール値, `'lax'`, `'strict'`, `'none'` | cookieのクロスサイトリクエストの動作を制御します。                               |
| `priority`        | 文字列（`"low"`, `"medium"`, `"high"`） | cookieの優先度を指定します                                                       |
| `encode('value')` | 関数                                    | cookieの値をエンコードするために使用される関数を指定します。                     |
| `partitioned`     | ブール値                                | cookieが[分割されている](https://github.com/privacycg/CHIPS)かどうかを示します。 |

唯一のデフォルト値を持つオプションは`path`です。

これらのオプションについて詳しくは、[MDNのドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)をご覧ください。

## 良く知っておくべきこと {#good-to-know}

- `cookies`はPromiseを返す**非同期**関数です。`async/await`またはReactの[`use`](https://react.dev/reference/react/use)関数を使ってcookieにアクセスしなければなりません。
  - バージョン14以前では、`cookies`は同期関数でした。後方互換性をサポートするため、Next.js 15でも同期的にアクセスすることができますが、この動作は将来的に廃止される予定です。
- `cookies`は、ページやレイアウトで使用すると[dynamic rendering](/docs/app/building-your-application/rendering/server-components#dynamic-rendering)に合意する[Dynamic API](/docs/app/building-your-application/rendering/server-components#dynamic-apis)です。
- `.delete`メソッドは次の場合だけ呼び出すことができます：
  - [Server Actions](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[Route Handler](/docs/app/building-your-application/routing/route-handlers)にて。
  - `.set`を呼び出すのと同じドメインに属するcookieの場合。さらに、削除したいcookieはプロトコル（HTTPまたはHTTPS）が同じでなければなりません。
- HTTPはストリーム開始後にcookieを設定することができないため、[Server Actions](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[Route Handler](/docs/app/building-your-application/routing/route-handlers)で`.set`を使用する必要があります。

## Server ComponentにおけるCookie動作の理解 {#understanding-cookie-behavior-in-server-components}

Server Componentでcookieを扱う場合、cookieは基本的にクライアントサイドのストレージメカニズムであることを理解することが重要です：

- **cookieを読み取る**のは可能です。これは、クライアントのブラウザがサーバーに送信するHTTPリクエストのヘッダーにcookieデータが含まれているからです。
- **cookieを設定する**ことは、Route HandlerやServer Actionを使用しても、Server Componentでは直接行うことができません。これは、cookieが実際にはブラウザによって保存され、サーバーではないからです。

サーバーは、`Set-Cookie`ヘッダーを介して、ブラウザにcookieを保存するよう指示を送るだけであり、実際の保存はクライアントサイドで行われます。このため、状態を変更するcookie操作（`.set`, `.delete`, `.clear`）は、レスポンスヘッダーを適切に設定できるRoute HandlerやServer Actionで実行する必要があります。

## 例 {#examples}

### cookieを取得する {#getting-a-cookie}

単一のcookieを取得するには、`(await cookies()).get('name')`メソッドを使用できます：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

</TabItem>
</Tabs>

### すべてのcookieを取得する {#getting-all-cookies}

`(await cookies()).getAll()`メソッドを使用して、一致する名前のすべてのcookieを取得できます。`name`が指定されていない場合、利用可能なすべてのcookieを返します。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  return cookieStore.getAll().map((cookie) => (
    <div key={cookie.name}>
      <p>Name: {cookie.name}</p>
      <p>Value: {cookie.value}</p>
    </div>
  ))
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  return cookieStore.getAll().map((cookie) => (
    <div key={cookie.name}>
      <p>Name: {cookie.name}</p>
      <p>Value: {cookie.value}</p>
    </div>
  ))
}
```

</TabItem>
</Tabs>

### cookieを設定する {#setting-a-cookie}

[Server Action](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[Route Handler](/docs/app/building-your-application/routing/route-handlers)で、`(await cookies()).set(name, value, options)`メソッドを使用してcookieを設定できます。[`options`オブジェクト](#options)は任意です。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function create(data) {
  const cookieStore = await cookies()

  cookieStore.set('name', 'lee')
  // あるいは
  cookieStore.set('name', 'lee', { secure: true })
  // あるいは
  cookieStore.set({
    name: 'name',
    value: 'lee',
    httpOnly: true,
    path: '/',
  })
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function create(data) {
  const cookieStore = await cookies()

  cookieStore.set('name', 'lee')
  // あるいは
  cookieStore.set('name', 'lee', { secure: true })
  // あるいは
  cookieStore.set({
    name: 'name',
    value: 'lee',
    httpOnly: true,
    path: '/',
  })
}
```

</TabItem>
</Tabs>

### cookieが存在するか確認する {#checking-if-a-cookie-exists}

特定のcookieが存在するかを確認するには、`(await cookies()).has(name)`メソッドを使用できます：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.ts" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const hasCookie = cookieStore.has('theme')
  return '...'
}
```

</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
import { cookies } from 'next/headers'

export default async function Page() {
  const cookieStore = await cookies()
  const hasCookie = cookieStore.has('theme')
  return '...'
}
```

</TabItem>
</Tabs>

### cookieを削除する {#deleting-cookies}

cookieを削除する方法は3つあります。

`delete()`メソッドを使用する：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).delete('name')
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).delete('name')
}
```

</TabItem>
</Tabs>

同じ名前で空の値を持つ新しいcookieを設定する：

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', '')
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', '')
}
```

</TabItem>
</Tabs>

`maxAge`を0に設定すると、すぐにcookieが期限切れになります。`maxAge`は秒単位の値を受け取ります。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', 'value', { maxAge: 0 })
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

export async function delete(data) {
  (await cookies()).set('name', 'value', { maxAge: 0 })
}
```

</TabItem>
</Tabs>

## バージョン履歴 {#version-history}

| バージョン   | 変更点                                                                                                                         |
| ------------ | ------------------------------------------------------------------------------------------------------------------------------ |
| `v15.0.0-RC` | `cookies`は現在非同期関数になっています。[codemod](/docs/app/building-your-application/upgrading/codemods#150)が利用可能です。 |
| `v13.0.0`    | `cookies`が導入されました。                                                                                                    |

---
title: 'Turbopack'
description: 'TurbopackはJavaScriptとTypeScript向けに最適化されたインクリメンタルバンドラーで、Rustで書かれており、Next.jsに組み込まれています。'
---

{/* このドキュメントの内容はappルーターとpagesルーターの間で共有されています。Pages Routerに特化した内容を追加するには、 `<PagesOnly>Content</PagesOnly>` コンポーネントを使用できます。共有コンテンツはコンポーネントでラップしないでください。 */}

[Turbopack](https://turbo.build/pack)はJavaScriptとTypeScript向けに最適化されたインクリメンタルバンドラーで、Rustで書かれており、Next.jsに組み込まれています。Turbopackは、より高速なローカル開発のためにNext.jsの`pages`ディレクトリと`app`ディレクトリで使用できます。

Turbopackを有効にするには、Next.js開発サーバーを実行する際に`--turbopack`フラグを使用します。

```json title="package.json" highlight={3}
{
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  }
}
```

## 参考 {#reference}

### 対応している機能 {#supported-features}

Next.js の Turbopack は、ほとんどのユーザーに対して設定なしで使用可能で、より高度なユースケースのために拡張できます。Turbopackに現在対応している機能の詳細については、[API リファレンス](/docs/app/api-reference/config/next-config-js/turbo)を参照してください。

### 非対応の機能 {#unsupported-features}

現時点では、Turbopackは`next dev`のみをサポートしており、`next build`はサポートしていません。私たちは現在、安定性に近づくためにビルドのサポートに取り組んでいます。

これらの機能は現在サポートされていません：

- Turbopackは[Lightning CSS](https://lightningcss.dev/)を活用していますが、一部の低利用のCSS Modules機能をサポートしていません
  - 独立した擬似クラスとしての`:local`と`:global`。関数バリアントのみがサポートされています。例えば`:global(a)`。
  - CSS変数に置き換えられた@value規則。
  - `:import` と `:export` のICSSルール。
- [無効なCSSコメント構文](https://stackoverflow.com/questions/51843506/are-double-slash-comments-valid-in-css) 例えば `//`
  - CSSコメントは仕様に従って `/* comment */` として記述する必要があります。
  - Sassのようなプリプロセッサはこの代替構文をサポートしています。
- `next.config.js` 内の [`webpack()`](/docs/app/api-reference/config/next-config-js/webpack) 設定
  - TurbopackはWebpackを置き換えます。これはwebpack設定がサポートされないことを意味します。
  - Turbopackを設定するには、[ドキュメントを参照してください](/docs/app/api-reference/config/next-config-js/turbo)。
  - [Webpackローダー](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders) のサブセットはTurbopackでサポートされています。
- Babel (`.babelrc`)
  - Turbopackは全トランスパイルと最適化のために[SWC](/docs/architecture/nextjs-compiler#why-swc)コンパイラを活用しています。これは、Babelがデフォルトで含まれていないことを意味します。
  - `.babelrc`ファイルを持っている場合、特定のユースケースがカバーされていないことを確認した後でまだBabelを使用する必要がある場合、`babel-loader`を含めるためにTurbopackの[カスタムwebpackローダーのサポート](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders)を活用できます。
- App Routerでのroot レイアウトの自動作成
  - この動作は現在サポートされていません。代わりに入力ファイルが変更されるため、希望する場所に手動でroot レイアウトを追加するようにエラーが表示されます。
- `@next/font` (レガシーなフォントサポート)
  - `@next/font` は `next/font` に置き換えられ非推奨となっています。 [`next/font`](/docs/app/building-your-application/optimizing/fonts) はTurbopackと完全に互換性があります。
- [Relay変換](/docs/architecture/nextjs-compiler#relay)
  - 将来、これを実装する予定です。
- `pages/_document.tsx`での `.css` インポートのブロック
  - 現在、webpackを使用して、Next.jsは `pages/_document.tsx` での `.css` ファイルのインポートをブロックしています。
  - 将来、この警告を実装する予定です。
- [`experimental.typedRoutes`](/docs/app/api-reference/config/next-config-js/typedRoutes)
  - 将来、これを実装する予定です。
- `experimental.nextScriptWorkers`
  - 将来、これを実装する予定です。
- `experimental.sri.algorithm`
  - 将来、これを実装する予定です。
- `experimental.fallbackNodePolyfills`
  - 将来、これを実装する予定です。
- `experimental.esmExternals`
  - 現時点では、Turbopackを使用したNext.jsでのレガシーなesmExternalsの設定をサポートする予定はありません。
- [AMP](https://nextjs.org/docs/canary/pages/building-your-application/configuring/amp).
  - 現時点では、Next.jsでのTurbopackを使用したAMPのサポートを計画していません。
- Yarn PnP
  - 現時点では、Next.jsでのTurbopackを使用したYarn PnPのサポートを計画していません。
- [`experimental.urlImports`](/docs/app/api-reference/config/next-config-js/urlImports)
  - 現時点では、Turbopackでの`experimental.urlImports`のサポートを計画していません。
- [`:import` と `:export` のICSSルール](https://github.com/css-modules/icss)
  - 現時点では、Next.jsでのTurbopackを使用した`:import`と`:export`のICSSルールのサポートを計画していません。Turbopackが使用しているCSSパーサーである[Lightning CSS](https://lightningcss.dev/css-modules.html)はこれらのルールをサポートしていません。
- edge runtimeでの`unstable_allowDynamic`設定

## 例 {#examples}

### トレースファイルの生成 {#generating-trace-files}

トレースファイルは、Next.jsチームがパフォーマンスのメトリクスやメモリ使用量を調査し改善するために役立ちます。トレースファイルを生成するには、`next dev --turbopack` コマンドに `NEXT_TURBOPACK_TRACING=1` を追加します。これにより `.next/trace.log` ファイルが生成されます。

Turbopackのパフォーマンスやメモリ使用量に関連する問題を報告する際は、トレースファイルをGitHubの[課題ページ](https://github.com/vercel/next.js)に添付してください。

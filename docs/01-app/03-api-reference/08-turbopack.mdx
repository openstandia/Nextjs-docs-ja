---
title: 'Turbopack'
description: 'TurbopackはJavaScriptとTypeScriptに最適化されたインクリメンタルなバンドラーで、Rustで書かれており、Next.jsに組み込まれています。'
---

{/* このドキュメントの内容はapp routerとpages routerの両方で共有されています。Pages Routerに特化した内容を追加するには`<PagesOnly>Content</PagesOnly>`コンポーネントを使用してください。共有コンテンツはコンポーネントでラップするべきではありません。 */}

[Turbopack](https://turbo.build/pack)はJavaScriptとTypeScriptに最適化されたインクリメンタルなバンドラーで、Rustで書かれており、Next.jsに組み込まれています。Turbopackは、Next.jsの`pages`ディレクトリと`app`ディレクトリの両方で使用でき、ローカル開発がより速くなります。

Turbopackを有効にするには、Next.jsの開発サーバーを実行する際に`--turbopack`フラグを使用します。

```json title="package.json" highlight={3}
{
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  }
}
```

## リファレンス {#reference}

### サポートされている機能 {#supported-features}

Next.jsにおけるTurbopackは、ほとんどのユーザーに対してゼロコンフィグレーションで動作し、より高度なユースケースに対して拡張することができます。Turbopackで現在サポートされている機能の詳細については、[APIリファレンス](/docs/app/api-reference/config/next-config-js/turbo)を参照してください。

### サポートされていない機能 {#unsupported-features}

Turbopackは現在、`next dev`のみをサポートしており、`next build`はサポートしていません。安定性に近づく中で、ビルドのサポートに取り組んでいます。

現在サポートされていない機能は次のとおりです：

- Turbopackは一部の低使用率CSSモジュール機能をサポートしない[Lightning CSS](https://lightningcss.dev/)を活用しています
  - 単独の疑似クラスとしての`:local`と`:global`。関数バリアントのみサポートされます、例：`:global(a)`。
  - CSS変数で置き換えられた@valueルール。
  - `:import`と`:export`のICSSルール。
- 無効なCSSコメント構文([Invalid CSS comment syntax](https://stackoverflow.com/questions/51843506/are-double-slash-comments-valid-in-css))例えば`//`
  - CSSコメントは仕様に従って`/* comment */`として書く必要があります。
  - Sassなどのプリプロセッサーはコメントのためのこの代替構文をサポートしています。
- `next.config.js`内の[`webpack()`](/docs/app/api-reference/config/next-config-js/webpack)設定
  - TurbopackはWebpackの代替品であるため、webpack設定はサポートされません。
  - Turbopackの設定については[ドキュメントを参照してください](/docs/app/api-reference/config/next-config-js/turbo)。
  - Turbopackでは[Webpackローダーのサブセット](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders)がサポートされています。
- Babel (`.babelrc`)
  - Turbopackはすべてのトランスパイルと最適化に[SWC](/docs/architecture/nextjs-compiler#why-swc)コンパイラーを使用します。これにより、Babelはデフォルトでは含まれていません。
  - `.babelrc`ファイルを持っている場合でも、Next.jsが一般的なBabelプラグインをSWC変換として含んでいるため、必要なくなるかもしれません。詳細は[コンパイラドキュメント](/docs/architecture/nextjs-compiler#supported-features)を参照してください。
  - 特定のユースケースがカバーされていないことを確認した後でBabelを使用する必要がある場合は、Turbopackの[カスタムwebpackローダーサポート](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders)を活用して`babel-loader`を含めることができます。
- App Routerでroot レイアウトを自動作成すること
  - この動作は、入力ファイルを変更するため現在はサポートされていません。代わりに、手動で所定の位置にroot レイアウトを追加するようエラーが表示されます。
- `@next/font`（レガシーフォントサポート）
  - `@next/font`は`next/font`に置き換えられており、[`next/font`](/docs/app/building-your-application/optimizing/fonts)はTurbopackで完全にサポートされています。
- [Relay変換](/docs/architecture/nextjs-compiler#relay)
  - 将来的にこれを実装する予定です。
- `.css`を`pages/_document.tsx`でインポートすることのブロック
  - 現在、Next.jsは`pages/_document.tsx`での`.css`ファイルのインポートをブロックしています
  - 将来的にこの警告を実装する予定です。
- [`experimental.typedRoutes`](https://nextjs.org/docs/app/api-reference/config/next-config-js/typedRoutes)
  - 将来的にこれを実装する予定です。
- `experimental.nextScriptWorkers`
  - 将来的にこれを実装する予定です。
- `experimental.sri.algorithm`
  - 将来的にこれを実装する予定です。
- `experimental.fallbackNodePolyfills`
  - 将来的にこれを実装する予定です。
- `experimental.esmExternals`
  - 現在、Next.jsでTurbopackとともにレガシーesmExternals設定をサポートする予定はありません。
- [AMP](https://nextjs.org/docs/canary/pages/building-your-application/configuring/amp)
  - 現在、Next.jsでTurbopackとともにAMPをサポートする予定はありません。
- Yarn PnP
  - 現在、Next.jsでTurbopackとともにYarn PnPをサポートする予定はありません。
- [`experimental.urlImports`](/docs/app/api-reference/config/next-config-js/urlImports)
  - 現在のところ、Next.jsでTurbopackとともに`experimental.urlImports`をサポートする予定はありません。
- [`:import`と`:export`のICSSルール](https://github.com/css-modules/icss)
  - Lightning CSS](https://lightningcss.dev/css-modules.html)がこれらのルールをサポートしていないため、Turbopackが使用するCSSパーサーである[Lightning CSS](https://lightningcss.dev/css-modules.html)がこれらのルールをサポートしていないため、Next.jsでTurbopackとともに`:import`と`:export`のICSSルールをサポートする予定はありません。
- edge runtimeにおける`unstable_allowDynamic`設定

## 例 {#examples}

### トレースファイルの生成 {#generating-trace-files}

トレースファイルは、Next.jsチームがパフォーマンスメトリクスやメモリ使用量を調査し、改善するために役立ちます。トレースファイルを生成するには、`next dev --turbopack`コマンドに`NEXT_TURBOPACK_TRACING=1`を追加します。これにより、`.next/trace.log`ファイルが生成されます。

Turbopackのパフォーマンスとメモリ使用量に関連する問題を報告する際は、[GitHub](https://github.com/vercel/next.js)のイシューにトレースファイルを含めてください。

---
title: 'Turbopack'
description: 'Turbopackは、JavaScriptとTypeScript向けに最適化されたインクリメンタルビルドツールで、Rustで記述され、Next.jsに組み込まれています。'
---

{/* このドキュメントの内容はapp routerとpages routerの間で共有されています。Pages Routerに特化したコンテンツを追加するには、`<PagesOnly>Content</PagesOnly>`コンポーネントを使用できます。共有コンテンツはコンポーネントでラップされるべきではありません。 */}

[Turbopack](https://turbo.build/pack)は、JavaScriptとTypeScript向けに最適化されたインクリメンタルバンドラで、Rustで記述され、Next.jsに組み込まれています。TurbopackはNext.jsの`pages`ディレクトリと`app`ディレクトリの両方で利用でき、ローカル開発をより迅速に行うことができます。

Turbopackを有効化するには、Next.jsの開発サーバーを実行する際に`--turbopack`フラグを使用します。

```json title="package.json" highlight={3}
{
  "scripts": {
    "dev": "next dev --turbopack", // ローカル開発サーバー用のコマンド
    "build": "next build", // プロジェクトのビルド用のコマンド
    "start": "next start", // ビルド後のプロジェクト起動用のコマンド
    "lint": "next lint" // コードのリント用のコマンド
  }
}
```

## 参考資料 {#reference}

### サポートされている機能 {#supported-features}

TurbopackはZero-Configurationでほとんどのユーザーに対応しており、より高度なユースケースに拡張可能です。現在サポートされているTurbopackの機能について詳しくは、[APIリファレンス](/docs/app/api-reference/config/next-config-js/turbo)をご覧ください。

### サポートされていない機能 {#unsupported-features}

Turbopackは現在`next dev`のみをサポートし、`next build`をサポートしていません。私たちは現在、安定性に近づくため、ビルドのサポートに取り組んでいます。

以下の機能は現在サポートされていません：

- Turbopackは[Lightning CSS](https://lightningcss.dev/)を利用しており、一部の使用頻度の低いCSSモジュール機能をサポートしていません
  - スタンドアロンの擬似クラスとしての`:local`と`:global`。関数バリアントのみがサポートされています。例：`:global(a)`
  - CSS変数で置き換えられた@valueルール
  - `:import`および`:export`のICSSルール
- [無効なCSSコメント構文](https://stackoverflow.com/questions/51843506/are-double-slash-comments-valid-in-css) `//`のようなもの
  - CSSコメントは、仕様に従って`/* comment */`のように記述する必要があります
  - Sassのようなプリプロセッサは、この代替の構文をサポートしています
- `next.config.js`内の[`webpack()`](/docs/app/api-reference/config/next-config-js/webpack)構成
  - TurbopackはWebpackを置き換えるため、webpack構成はサポートされていません
  - Turbopackを設定するには、[ドキュメント](/docs/app/api-reference/config/next-config-js/turbo)をご覧ください
  - Turbopackでは[Webpackローダー](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders)のサブセットがサポートされています
- Babel (`.babelrc`)
  - Turbopackはすべてのトランスパイルと最適化に[SWC](/docs/architecture/nextjs-compiler#why-swc)コンパイラを利用しています。これにより、Babelはデフォルトで含まれていません
  - `.babelrc`ファイルがある場合、Next.jsには一般的なBabelプラグインがSWCトランスフォームとして含まれており、有効にすることができるため、もはや必要ないかもしれません。詳細は[コンパイラのドキュメント](/docs/architecture/nextjs-compiler#supported-features)で読むことができます
  - 特定のユースケースが含まれていないことを確認した後に依然としてBabelを使用する必要がある場合、Turbopackの[カスタムwebpackローダーのサポート](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders)を利用して、`babel-loader`を含めることができます
- App Routerで自動的にroot レイアウトを作成すること
  - 入力ファイルを変更するため、この動作は現在サポートされておらず、代わりにエラーが表示されて、希望する場所に手動でroot レイアウトを追加するように指示されます
- `@next/font`（レガシーフォントサポート）
  - `@next/font`は`next/font`に置き換えられました。Turbopackで[`next/font`](/docs/app/building-your-application/optimizing/fonts)は完全にサポートされています
- [Relay 変換](/docs/architecture/nextjs-compiler#relay)
  - 将来的にこれを実装する予定です
- `pages/_document.tsx`での`.css`インポートをブロックすること
  - 現在、webpackを使用するNext.jsでは`pages/_document.tsx`での`.css`ファイルのインポートをブロックしています
  - 将来的にこの警告を実装する予定です
- [`experimental.typedRoutes`](/docs/app/api-reference/config/next-config-js/typedRoutes)
  - 将来的にこれを実装する予定です
- `experimental.nextScriptWorkers`
  - 将来的にこれを実装する予定です
- `experimental.sri.algorithm`
  - 将来的にこれを実装する予定です
- `experimental.fallbackNodePolyfills`
  - 将来的にこれを実装する予定です
- `experimental.esmExternals`
  - TurbopackでのNext.jsに古いesmExternals構成をサポートする予定は現在ありません
- [AMP](https://nextjs.org/docs/canary/pages/building-your-application/configuring/amp)
  - TurbopackでのNext.jsにAMPをサポートする予定は現在ありません
- Yarn PnP
  - TurbopackでのNext.jsにYarn PnPをサポートする予定は現在ありません
- [`experimental.urlImports`](/docs/app/api-reference/config/next-config-js/urlImports)
  - TurbopackでのNext.jsに`experimental.urlImports`をサポートする予定は現在ありません
- [`:import`および`:export`ICSSルール](https://github.com/css-modules/icss)
  - Turbopackが使用するCSSパーサーである[Lightning CSS](https://lightningcss.dev/css-modules.html)がこれらのルールをサポートしていないため、TurbopackでのNext.jsに`:import`および`:export`のICSSルールをサポートする予定は現在ありません
- edge runtimeにおける`unstable_allowDynamic`構成

## 例 {#examples}

### トレースファイルの生成 {#generating-trace-files}

トレースファイルにより、Next.jsチームはパフォーマンス指標とメモリ使用量を調査して改善することができます。トレースファイルを生成するには、`next dev --turbopack`コマンドに`NEXT_TURBOPACK_TRACING=1`を追加します。これにより、`.next/trace.log`ファイルが生成されます。

Turbopackのパフォーマンスとメモリ使用量に関連する問題を報告する際には、[GitHub](https://github.com/vercel/next.js)の問題にトレースファイルを含めてください。

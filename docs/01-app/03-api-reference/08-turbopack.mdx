---
title: 'Turbopack'
description: 'Turbopackは、JavaScriptおよびTypeScript向けに最適化されたインクリメンタルバンドラーで、Rustで記述され、Next.jsに組み込まれています。'
---

{/* このドキュメントの内容は、app router と pages router の間で共有されています。pages router に特有の内容を追加するには、`<PagesOnly>コンテンツ</PagesOnly>` コンポーネントを使用します。共有コンテンツはコンポーネントで囲まないようにしましょう。 */}

[Turbopack](https://turbo.build/pack)は、JavaScriptおよびTypeScript向けに最適化されたインクリメンタルバンドラーで、Rustで記述され、Next.jsに組み込まれています。Turbopackは、Next.jsの`pages`ディレクトリと`app`ディレクトリの両方で使用でき、ローカル開発をより速く行うことができます。

Turbopackを有効にするには、Next.js開発サーバーを実行するときに`--turbopack`フラグを使用してください。

```json title="package.json" highlight={3}
{
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  }
}
```

## 参照 {#reference}

### サポートされている機能 {#supported-features}

Next.jsでのTurbopackは、ほとんどのユーザーに対してゼロ設定を可能にし、より高度なユースケースに対応するために拡張することができます。現在サポートされているTurbopackの機能について詳しく学ぶには、[APIリファレンス](/docs/app/api-reference/config/next-config-js/turbo)をご覧ください。

### サポートされていない機能 {#unsupported-features}

Turbopackは現在、`next dev`のみをサポートしており、`next build`をサポートしていません。安定性に向けて進む中で、ビルドのサポートに取り組んでいます。

次の機能は現在サポートされていません：

- Turbopackは[Lightning CSS](https://lightningcss.dev/)を利用しています。このため、一部の低使用率のCSS Modules機能をサポートしていません
  - 独立した疑似クラスとしての`:local`と`:global`。関数バリアントのみがサポートされています。例えば、`:global(a)`。
  - CSS変数に置き換えられた@valueルール
  - `:import`と`:export`のICSSルール
- [無効なCSSコメント構文](https://stackoverflow.com/questions/51843506/are-double-slash-comments-valid-in-css) `//`
  - CSSコメントは仕様通りに`/* コメント */`と書くべきです。
  - Sassなどのプリプロセッサは、この代替構文をサポートしています。
- `next.config.js`での[`webpack()`](/docs/app/api-reference/config/next-config-js/webpack)構成
  - TurbopackはWebpackを置き換えます。したがって、webpack構成はサポートされません。
  - Turbopackを構成するには、[ドキュメントをご覧ください](/docs/app/api-reference/config/next-config-js/turbo)。
  - [Webpackローダーのサブセット](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders)はTurbopackでサポートされています。
- Babel (`.babelrc`)
  - Turbopackは、すべてのトランスパイルと最適化に[SWC](/docs/architecture/nextjs-compiler#why-swc)コンパイラーを利用します。これにより、Babelはデフォルトで含まれていません。
  - `.babelrc`ファイルをお持ちの場合、Next.jsは一般的なBabelプラグインをSWC変換として含めるため、もはや必要ないかもしれません。詳細は[コンパイラのドキュメント](/docs/architecture/nextjs-compiler#supported-features)をお読みください。
  - 特定のユースケースに対応していないことを確認のうえで、まだBabelを使用する必要がある場合は、Turbopackの[カスタムwebpackローダーのサポート](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders)を活用して`babel-loader`を含められます。
- App Routerでroot レイアウトを自動的に作成すること
  - 入力ファイルが変更されるため、現在この動作はサポートされていません。代わりにエラーが表示され、所望の場所に手動でroot レイアウトを追加する必要があります。
- `@next/font` (レガシーフォントサポート)。
  - `@next/font` は`next/font`を支持して廃止されました。[`next/font`](/docs/app/building-your-application/optimizing/fonts)はTurbopackで完全にサポートされています。
- [Relay変換](/docs/architecture/nextjs-compiler#relay)
  - 将来的にこれを実装する予定です。
- `pages/_document.tsx`での`.css`インポートのブロック
  - 現在、webpackを使用することでNext.jsは`pages/_document.tsx`で`.css`ファイルのインポートをブロックしています。
  - 将来的にこの警告を実装する予定です。
- [`experimental.typedRoutes`](/docs/app/api-reference/config/next-config-js/typedRoutes)
  - 将来的にこれを実装する予定です。
- `experimental.nextScriptWorkers`
  - 将来的にこれを実装する予定です。
- `experimental.sri.algorithm`
  - 将来的にこれを実装する予定です。
- `experimental.fallbackNodePolyfills`
  - 将来的にこれを実装する予定です。
- `experimental.esmExternals`
  - Turbopackを使用したNext.jsにおいて、レガシーのesmExternals構成をサポートする予定はありません。
- [AMP](https://nextjs.org/docs/canary/pages/building-your-application/configuring/amp)。
  - Turbopackを使用したNext.jsにおいて、AMPをサポートする予定はありません。
- Yarn PnP
  - Turbopackを使用したNext.jsにおいて、Yarn PnPをサポートする予定はありません。
- [`experimental.urlImports`](/docs/app/api-reference/config/next-config-js/urlImports)
  - Turbopackを使用したNext.jsにおいて、`experimental.urlImports`をサポートする予定はありません。
- [`:import`と`:export`のICSSルール](https://github.com/css-modules/icss)
  - Turbopackで使用されるCSSパーサーである[Lightning CSS](https://lightningcss.dev/css-modules.html)がこれらのルールをサポートしていないため、Next.jsで`:import`と`:export`のICSSルールをサポートする予定はありません。
- edge runtimeでの`unstable_allowDynamic`構成

## 例 {#examples}

### トレースファイルの生成 {#generating-trace-files}

トレースファイルは、Next.jsチームがパフォーマンスメトリックとメモリ使用量を調査し、改善するのに役立ちます。トレースファイルを生成するには、`next dev --turbopack`コマンドに`NEXT_TURBOPACK_TRACING=1`を追加してください。これにより、`.next/trace.log`ファイルが生成されます。

Turbopackのパフォーマンスとメモリ使用に関連する問題を報告する際は、[GitHub](https://github.com/vercel/next.js)のissueにトレースファイルを含めてください。

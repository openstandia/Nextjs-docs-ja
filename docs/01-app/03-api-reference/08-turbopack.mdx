---
title: 'Turbopack'
description: 'Turbopack は JavaScript と TypeScript に最適化された増分バンドラーで、Rust で書かれ、Next.js に組み込まれています。'
---

{/* このドキュメントの内容は app router と pages router で共有されています。pages router に特有のコンテンツは、`<PagesOnly>Content</PagesOnly>` コンポーネントを使用して追加できます。共有コンテンツはコンポーネントでラップしないでください。 */}

[Turbopack](https://turbo.build/pack) は JavaScript および TypeScript に最適化された増分バンドラーで、Rust で書かれ、Next.js に組み込まれています。Turbopack は、Next.js において `pages` ディレクトリおよび `app` ディレクトリの両方で使用可能で、ローカル開発を高速化できます。

Turbopack を有効にするには、Next.js 開発サーバーを実行する際に `--turbopack` フラグを利用してください。

```json title="package.json" highlight={3}
{
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  }
}
```

## 参考 {#reference}

### サポートされている機能 {#supported-features}

Next.js での Turbopack は、ほとんどのユーザーに対してゼロコンフィグレーションを必要とせず、より高度なユースケースのために拡張できます。現在サポートされている Turbopack の機能について詳しくは、[API リファレンス](/docs/app/api-reference/config/next-config-js/turbo)をご覧ください。

### サポートされていない機能 {#unsupported-features}

現在、Turbopack は `next dev` のみをサポートしており、`next build` はサポートされていません。私たちは現在、安定性に近づくためにビルドのサポートに取り組んでいます。

現在サポートされていない機能：

- Turbopack は [Lightning CSS](https://lightningcss.dev/) を利用しており、いくつかの使用頻度の低い CSS モジュール機能をサポートしていません
  - `:local` および `:global` として単体の疑似クラス。関数バリアントのみがサポートされており、例：`:global(a)`
  - CSS 変数によって置き換えられた @value ルール
  - `:import` および `:export` ICSS ルール
- [無効な CSS コメント構文](https://stackoverflow.com/questions/51843506/are-double-slash-comments-valid-in-css) たとえば `//`
  - CSS コメントは仕様に従って `/* comment */` のように書かれるべきです。
  - Sass などのプリプロセッサは、この代替構文をサポートしています。
- `next.config.js` での [webpack()](/docs/app/api-reference/config/next-config-js/webpack) 設定
  - Turbopack は Webpack を置き換えます。つまり webpack 設定はサポートされていません。
  - Turbopack を設定するには、[ドキュメントをご覧ください](/docs/app/api-reference/config/next-config-js/turbo)。
  - Turbopack では [Webpack ローダー](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders) のサブセットがサポートされています。
- Babel (`.babelrc`)
  - Turbopack はすべてのトランスパイルと最適化に [SWC](/docs/architecture/nextjs-compiler#why-swc) コンパイラを利用しています。これにより、既定では Babel は含まれていません。
  - `.babelrc` ファイルを持っている場合、Next.js が共通の Babel プラグインを SWC 変換として含めるため、不要になるかもしれません。詳細は [コンパイラのドキュメント](/docs/architecture/nextjs-compiler#supported-features)をご覧ください。
  - 特殊なユースケースがカバーされていない場合に限り、カスタム Webpack ローダーとして `babel-loader` を含めることで Turbopack のサポートを利用できます。
- App Router で root レイアウトを自動作成すること
  - この動作は現在サポートされていません。代わりに、目的の場所に手動で root レイアウトを追加するようエラーが表示されます。
- `@next/font`（レガシーフォントサポート）。
  - `@next/font` は `next/font` を推奨しており、`next/font` は Turbopack で完全にサポートされています。
- [Relay 変換](/docs/architecture/nextjs-compiler#relay)
  - 将来的にこれを実装する予定です。
- `pages/_document.tsx` での `.css` インポートのブロック
  - 現在、webpack を使用している場合、Next.js は `pages/_document.tsx` での `.css` ファイルのインポートをブロックします
  - 将来的にこの警告を実装する予定です。
- [`experimental.typedRoutes`](/docs/app/api-reference/config/next-config-js/typedRoutes)
  - 将来的にこれを実装する予定です。
- `experimental.nextScriptWorkers`
  - 将来的にこれを実装する予定です。
- `experimental.sri.algorithm`
  - 将来的にこれを実装する予定です。
- `experimental.fallbackNodePolyfills`
  - 将来的にこれを実装する予定です。
- `experimental.esmExternals`
  - 現在、Turbopack を使った Next.js でこのレガシー esmExternals 設定をサポートする予定はありません。
- [AMP](https://nextjs.org/docs/canary/pages/building-your-application/configuring/amp)
  - 現在、Turbopack を使った Next.js で AMP をサポートする予定はありません。
- Yarn PnP
  - 現在、Turbopack を使った Next.js で Yarn PnP をサポートする予定はありません。
- [`experimental.urlImports`](/docs/app/api-reference/config/next-config-js/urlImports)
  - 現在、Turbopack を使った Next.js で `experimental.urlImports` をサポートする予定はありません。
- [`:import` および `:export` ICSS ルール](https://github.com/css-modules/icss)
  - 現在、Turbopack を使った Next.js で `:import` および `:export` ICSS ルールをサポートする予定はありません。Turbopack が使用する CSS パーサーである [Lightning CSS](https://lightningcss.dev/css-modules.html) はこれらのルールをサポートしていません。
- edge runtime での `unstable_allowDynamic` 設定

## 例 {#examples}

### トレースファイルの生成 {#generating-trace-files}

トレースファイルは、Next.js チームがパフォーマンスメトリクスとメモリ使用量を調査および改善するのに役立ちます。トレースファイルを生成するには、`next dev --turbopack` コマンドに `NEXT_TURBOPACK_TRACING=1` を追加し、`.next/trace.log` ファイルを生成します。

Turbopack のパフォーマンスとメモリ使用量に関連する問題を報告する際は、[GitHub](https://github.com/vercel/next.js) イシューにトレースファイルを含めてください。

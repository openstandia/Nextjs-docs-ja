---
title: 'Turbopack'
description: 'TurbopackはRustで書かれたJavaScriptとTypeScript用に最適化された増分バンドラーで、Next.jsに組み込まれています。'
---

{/* このドキュメントの内容はapp routerとpages routerの間で共有されています。Pages Routerに特有のコンテンツを追加するには、`<PagesOnly>コンテンツ</PagesOnly>`コンポーネントを使用します。共有されているコンテンツはコンポーネントでラップしてはいけません。 */}

[Turbopack](https://turbo.build/pack) はRustで書かれたJavaScriptとTypeScript用に最適化された増分バンドラーで、Next.jsに組み込まれています。TurbopackはNext.jsにおける`pages`ディレクトリと`app`ディレクトリの両方で利用可能で、ローカル開発をより迅速に行えます。

Turbopackを有効にするには、Next.jsの開発サーバーを実行する際に`--turbopack`フラグを使用してください。

```json title="package.json" highlight={3}
{
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  }
}
```

## 参照 {#reference}

### サポートされている機能 {#supported-features}

Next.jsのTurbopackは、ほとんどのユーザーに対してはゼロ・コンフィギュレーションで利用可能で、より高度なユースケースに対応するために拡張できます。現在サポートされているTurbopackの機能について詳しく知りたい場合は、[APIリファレンス](/docs/app/api-reference/config/next-config-js/turbo)を参照してください。

### サポートされていない機能 {#unsupported-features}

Turbopackは現在`next dev`のみをサポートしており、`next build`はサポートしていません。安定性に近づくにつれて、ビルドのサポートに取り組んでいます。

これらの機能は現在サポートされていません：

- Turbopackは[Lightning CSS](https://lightningcss.dev/)を活用しており、一部の低使用率のCSSモジュール機能をサポートしていません
  - `:local` および `:global` が単独の擬似クラスとして使用されること。関数型のバリアントのみがサポートされます、例えば：`:global(a)`。
  - CSS変数に置き換えられた@valueルール
  - `:import` と `:export` ICSSルール
- [無効なCSSコメントの構文](https://stackoverflow.com/questions/51843506/are-double-slash-comments-valid-in-css)である、`//`
  - CSSコメントは仕様に基づき、`/* comment */`として記述する必要があります。
  - Sassなどのプリプロセッサーはこの代替構文でのコメントをサポートしています。
- [`webpack()`](/docs/app/api-reference/config/next-config-js/webpack) 構成`next.config.js`内での
  - TurbopackはWebpackを置き換えます、これによりWebpackの構成がサポートされません。
  - Turbopackを構成するには、[ドキュメントを参照してください](/docs/app/api-reference/config/next-config-js/turbo)。
  - 一部の[Webpackローダー](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders)はTurbopackでサポートされています。
- Babel(`.babelrc`)
  - Turbopackはすべてのトランスパイルと最適化に[SWC](/docs/architecture/nextjs-compiler#why-swc)コンパイラーを利用しています。これにより、Babelはデフォルトでは含まれていません。
  - `.babelrc`ファイルがある場合は、これを不要となるかもしれません。なぜならNext.jsは一般的なBabelプラグインを有効化可能なSWC変換として含んでいるからです。詳細は[コンパイラードキュメント](/docs/architecture/nextjs-compiler#supported-features)で確認できます。
  - ご自身の使用ケースがカバーされていないことを確認した後でBabelをまだ使用する必要がある場合は、Turbopackの[カスタムWebpackローダーのサポートを利用することができます](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders) `babel-loader`を含めるために
- App Routerで自動的にrootレイアウトを作成すること。
  - この動作は現在サポートされていません。他の場所に手動でrootレイアウトを追加するためのエラーが表示されます。
- `@next/font`（レガシーフォントサポート）。
  - `@next/font` は`next/font`を推奨し、非推奨です。[`next/font`](/docs/app/building-your-application/optimizing/fonts) がTurbopackで完全にサポートされています。
- [Relay変換](/docs/architecture/nextjs-compiler#relay)
  - 将来的にこれを実装する予定です。
- `pages/_document.tsx` における `.css` インポートのブロック
  - 現在、webpackを使用する際、Next.jsは`pages/_document.tsx`に`.css`ファイルのインポートをブロックしています
  - 将来的にこの警告を実装する予定です。
- [`experimental.typedRoutes`](/docs/app/api-reference/config/next-config-js/typedRoutes)
  - 将来的にこれを実装する予定です。
- `experimental.nextScriptWorkers`
  - 将来的にこれを実装する予定です。
- `experimental.sri.algorithm`
  - 将来的にこれを実装する予定です。
- `experimental.fallbackNodePolyfills`
  - 将来的にこれを実装する予定です。
- `experimental.esmExternals`
  - 現在、Next.jsでのesmExternalsのレガシー構成をTurbopackでサポートする予定はありません。
- [AMP](https://nextjs.org/docs/canary/pages/building-your-application/configuring/amp)
  - 現在、AMPをTurbopackでNext.jsでサポートする計画はありません。
- Yarn PnP
  - 現在、Yarn PnPをTurbopackでNext.jsでサポートする計画はありません。
- [`experimental.urlImports`](/docs/app/api-reference/config/next-config-js/urlImports)
  - 現在、`experimental.urlImports`をTurbopackでNext.jsでサポートする計画はありません。
- [`:import` および `:export` ICSSルール](https://github.com/css-modules/icss)
  - Turbopackが使用するCSSパーサーである[LightningCSS](https://lightningcss.dev/css-modules.html)がお互いにこれらのルールをサポートしていないため、Next.jsではTurbopackを使用して、:importと:export ICSSルールをサポートする予定は現在ありません。
- edge runtimeでの`unstable_allowDynamic`構成

## 例 {#examples}

### トレースファイルの生成 {#generating-trace-files}

トレースファイルは、Next.jsチームがパフォーマンスメトリックスとメモリ使用量を調査して改善するために利用されます。トレースファイルを生成するには、`next dev --turbopack` コマンドに `NEXT_TURBOPACK_TRACING=1` を追加します。これにより、`.next/trace.log` ファイルが生成されます。

Turbopackのパフォーマンスとメモリ使用量に関連する問題を報告する際には、[GitHub](https://github.com/vercel/next.js)の問題にトレースファイルを含めてください。

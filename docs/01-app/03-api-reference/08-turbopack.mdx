---
title: 'Turbopack'
description: 'TurbopackはJavaScriptとTypeScriptのために最適化されたインクリメンタルバンドラであり、Rustで書かれ、Next.jsに組み込まれています。'
---

{/* このドキュメントの内容はapp routerとpages routerに共有されています。Pages Routerに特化したコンテンツを追加するには、`<PagesOnly>Content</PagesOnly>`コンポーネントを使用できます。共有コンテンツにはコンポーネントをラップしないでください。 */}

[Turbopack](https://turbo.build/pack)はJavaScriptとTypeScriptのために最適化されたインクリメンタルバンドラであり、Rustで書かれ、Next.jsに組み込まれています。Turbopackは、Next.jsの`pages`ディレクトリと`app`ディレクトリの両方で使用でき、ローカル開発をより高速化します。

Turbopackを有効にするには、Next.jsの開発サーバーを実行する際に`--turbopack`フラグを使用してください。

```json title="package.json" highlight={3}
{
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  }
}
```

## 参考 {#reference}

### サポートされている機能 {#supported-features}

Next.jsのTurbopackは、ほとんどのユーザーに対してゼロ設定で使用でき、より高度なユースケースに対して拡張できます。現在サポートされているTurbopackの機能について詳しく知るには、[APIリファレンス](/docs/app/api-reference/config/next-config-js/turbo)をご覧ください。

### サポートされていない機能 {#unsupported-features}

Turbopackは現在、`next dev`のみをサポートしており、`next build`はサポートしていません。安定性に向けて開発が進んでいるため、ビルドのサポートに取り組んでいます。

これらの機能は現在サポートされていません：

- Turbopackは[Lightning CSS](https://lightningcss.dev/)を利用していますが、一部の低使用機能のCSS Modulesをサポートしていません
  - 独立した疑似クラスとしての`:local`と`:global`は、関数のバリエーションのみがサポートされています（例：`:global(a)`）
  - CSS変数で置き換えられた@valueルール
  - `:import`と`:export` ICSSルール。
- `//`のような[無効なCSSコメントの構文](https://stackoverflow.com/questions/51843506/are-double-slash-comments-valid-in-css)
  - CSSのコメントは仕様に従い、`/* comment */`と記述してください。
  - Sassのようなプリプロセッサは、コメントの代替構文をサポートしています。
- `next.config.js`内の[`webpack()`](/docs/app/api-reference/config/next-config-js/webpack)の設定
  - TurbopackはWebpackに置き換わり、webpack設定はサポートされていません。
  - Turbopackの設定について[ドキュメンテーション](/docs/app/api-reference/config/next-config-js/turbo)をご覧ください。
  - WebpackローダーのサブセットがTurbopackでサポートされています。
- Babel (`.babelrc`)
  - Turbopackはすべてのトランスパイルと最適化に[SWC](/docs/architecture/nextjs-compiler#why-swc)コンパイラを利用します。これにより、Babelはデフォルトで含まれていません。
  - `.babelrc`ファイルを持っている場合、Next.jsが一般的なBabelプラグインを有効化できるSWCの変換として含めているため、もはや必要ないかもしれません。これについては[コンパイラのドキュメンテーション](/docs/architecture/nextjs-compiler#supported-features)で詳しく説明しています。
  - 特定のユースケースがカバーされていないことを確認した後でもBabelを使用する必要がある場合、Turbopackの[カスタムwebpackローダーのサポート](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders)を利用して、`babel-loader`を含めることができます。
- App Routerでrootレイアウトを自動的に作成すること
  - 入力ファイルを変更するため、この動作は現在サポートされておらず、代わりに手動で希望の場所にrootレイアウトを追加するようにエラーが表示されます。
- `@next/font` (レガシーフォントサポート)
  - `@next/font`は`next/font`に置き換えられました。[`next/font`](/docs/app/building-your-application/optimizing/fonts)はTurbopackで完全にサポートされています。
- [リレー変換](/docs/architecture/nextjs-compiler#relay)
  - これは将来的に実装する予定です。
- `pages/_document.tsx`での`.css`インポートをブロックすること
  - 現在、Webpackを使用しているNext.jsでは、`pages/_document.tsx`での`.css`ファイルのインポートをブロックしています
  - 将来的にこの警告を実装する予定です。
- [`experimental.typedRoutes`](https://nextjs.org/docs/app/api-reference/config/next-config-js/typedRoutes)
  - これは将来的に実装する予定です。
- `experimental.nextScriptWorkers`
  - これは将来的に実装する予定です。
- `experimental.sri.algorithm`
  - これは将来的に実装する予定です。
- `experimental.fallbackNodePolyfills`
  - これは将来的に実装する予定です。
- `experimental.esmExternals`
  - 現在、Next.jsでのレガシーなesmExternals設定のサポートをTurbopackでは予定していません。
- [AMP](https://nextjs.org/docs/canary/pages/building-your-application/configuring/amp)
  - 現在、Next.jsでのAMPのサポートをTurbopackでは予定していません。
- Yarn PnP
  - 現在、Next.jsでのYarn PnPのサポートをTurbopackでは予定していません。
- [`experimental.urlImports`](/docs/app/api-reference/config/next-config-js/urlImports)
  - 現在、Next.jsでの`experimental.urlImports`のサポートをTurbopackでは予定していません。
- [`:import` and `:export` ICSSルール](https://github.com/css-modules/icss)
  - 現在、Next.jsでの`:import`と`:export` ICSSルールのサポートをTurbopackでは予定していません; Turbopackが使用するCSSパーサである[Lightning CSS](https://lightningcss.dev/css-modules.html)がこれらのルールをサポートしていないためです。
- edge runtimeでの`unstable_allowDynamic`設定

## 例 {#examples}

### トレースファイルの生成 {#generating-trace-files}

トレースファイルにより、Next.jsチームはパフォーマンスのメトリックとメモリ使用量を調査し、改善できます。トレースファイルを生成するには、`next dev --turbopack`コマンドに`NEXT_TURBOPACK_TRACING=1`を追加してください。これにより、`.next/trace.log`ファイルが生成されます。

Turbopackのパフォーマンスやメモリ使用量に関する問題を報告する際は、[GitHub](https://github.com/vercel/next.js)の問題にトレースファイルを含めてください。

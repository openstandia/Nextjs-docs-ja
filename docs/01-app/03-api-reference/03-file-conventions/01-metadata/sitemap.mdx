---
title: 'sitemap.xml'
description: 'sitemap.xml ファイルの API リファレンス。'
related:
  title: 'Next の手順'
  description: 'generateSitemaps 関数の使い方を学ぶ。'
  links:
    - app/api-reference/functions/generate-sitemaps
---

`sitemap.(xml|js|ts)` は特別なファイルであり、検索エンジンのクローラーがあなたのサイトをより効率的にインデックス化するのを助けるために [Sitemaps XML 形式](https://www.sitemaps.org/protocol.html) に一致します。

### Sitemap ファイル (.xml) {#sitemap-files-xml}

小規模なアプリケーションの場合、`sitemap.xml` ファイルを作成し、`app` ディレクトリのルートに配置することができます。

```xml title="app/sitemap.xml"
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
  <url>
    <loc>https://acme.com</loc>
    <lastmod>2023-04-06T15:02:24.021Z</lastmod>
    <changefreq>yearly</changefreq>
    <priority>1</priority>
  </url>
  <url>
    <loc>https://acme.com/about</loc>
    <lastmod>2023-04-06T15:02:24.021Z</lastmod>
    <changefreq>monthly</changefreq>
    <priority>0.8</priority>
  </url>
  <url>
    <loc>https://acme.com/blog</loc>
    <lastmod>2023-04-06T15:02:24.021Z</lastmod>
    <changefreq>weekly</changefreq>
    <priority>0.5</priority>
  </url>
</urlset>
```

### コードを使用して sitemap を生成する (.js, .ts) {#generating-a-sitemap-using-code-js-ts}

`(sitemap.js|ts)` ファイル規約を使用して、URL の配列を返すデフォルト関数をエクスポートすることでプログラム的に sitemap を **生成** できます。TypeScript を使用する場合、[`Sitemap`](#returns) タイプが利用可能です。

> **Good to know**: `sitemap.js` は特別な Route Handler であり、[Dynamic API](/docs/app/building-your-application/caching#dynamic-apis) オプションまたは [dynamic config](/docs/app/building-your-application/caching#segment-config-options) オプションを使用しない限り、デフォルトでキャッシュされます。

<Tabs>
<TabItem value="ts" label="TypeScript">

```ts title="app/sitemap.ts" switcher
import type { MetadataRoute } from 'next'

export default function sitemap(): MetadataRoute.Sitemap {
  return [
    {
      url: 'https://acme.com',
      lastModified: new Date(),
      changeFrequency: 'yearly',
      priority: 1,
    },
    {
      url: 'https://acme.com/about',
      lastModified: new Date(),
      changeFrequency: 'monthly',
      priority: 0.8,
    },
    {
      url: 'https://acme.com/blog',
      lastModified: new Date(),
      changeFrequency: 'weekly',
      priority: 0.5,
    },
  ]
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/sitemap.js" switcher
export default function sitemap() {
  return [
    {
      url: 'https://acme.com',
      lastModified: new Date(),
      changeFrequency: 'yearly',
      priority: 1,
    },
    {
      url: 'https://acme.com/about',
      lastModified: new Date(),
      changeFrequency: 'monthly',
      priority: 0.8,
    },
    {
      url: 'https://acme.com/blog',
      lastModified: new Date(),
      changeFrequency: 'weekly',
      priority: 0.5,
    },
  ]
}
```

</TabItem>
</Tabs>

出力：

```xml title="acme.com/sitemap.xml"
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
  <url>
    <loc>https://acme.com</loc>
    <lastmod>2023-04-06T15:02:24.021Z</lastmod>
    <changefreq>yearly</changefreq>
    <priority>1</priority>
  </url>
  <url>
    <loc>https://acme.com/about</loc>
    <lastmod>2023-04-06T15:02:24.021Z</lastmod>
    <changefreq>monthly</changefreq>
    <priority>0.8</priority>
  </url>
  <url>
    <loc>https://acme.com/blog</loc>
    <lastmod>2023-04-06T15:02:24.021Z</lastmod>
    <changefreq>weekly</changefreq>
    <priority>0.5</priority>
  </url>
</urlset>
```

### 画像 Sitemap {#image-sitemaps}

`images` プロパティを使用して画像 sitemap を作成することができます。詳細は [Google デベロッパードキュメント](https://developers.google.com/search/docs/crawling-indexing/sitemaps/image-sitemaps)をご覧ください。

<Tabs>
<TabItem value="ts" label="TypeScript">

```ts title="app/sitemap.ts" switcher
import type { MetadataRoute } from 'next'

export default function sitemap(): MetadataRoute.Sitemap {
  return [
    {
      url: 'https://example.com',
      lastModified: '2021-01-01',
      changeFrequency: 'weekly',
      priority: 0.5,
      images: ['https://example.com/image.jpg'],
    },
  ]
}
```

</TabItem>
</Tabs>

出力：

```xml title="acme.com/sitemap.xml"
<?xml version="1.0" encoding="UTF-8"?>
<urlset
  xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
  xmlns:image="http://www.google.com/schemas/sitemap-image/1.1"
>
  <url>
    <loc>https://example.com</loc>
    <image:image>
      <image:loc>https://example.com/image.jpg</image:loc>
    </image:image>
    <lastmod>2021-01-01</lastmod>
    <changefreq>weekly</changefreq>
    <priority>0.5</priority>
  </url>
</urlset>
```

### ビデオ Sitemap {#video-sitemaps}

`videos` プロパティを使用してビデオ sitemap を作成することができます。詳細は [Google デベロッパードキュメント](https://developers.google.com/search/docs/crawling-indexing/sitemaps/video-sitemaps)をご覧ください。

<Tabs>
<TabItem value="ts" label="TypeScript">

```ts title="app/sitemap.ts" switcher
import type { MetadataRoute } from 'next'

export default function sitemap(): MetadataRoute.Sitemap {
  return [
    {
      url: 'https://example.com',
      lastModified: '2021-01-01',
      changeFrequency: 'weekly',
      priority: 0.5,
      videos: [
        {
          title: 'example',
          thumbnail_loc: 'https://example.com/image.jpg',
          description: 'this is the description',
        },
      ],
    },
  ]
}
```

</TabItem>
</Tabs>

出力：

```xml title="acme.com/sitemap.xml"
<?xml version="1.0" encoding="UTF-8"?>
<urlset
  xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
  xmlns:video="http://www.google.com/schemas/sitemap-video/1.1"
>
  <url>
    <loc>https://example.com</loc>
    <video:video>
      <video:title>example</video:title>
      <video:thumbnail_loc>https://example.com/image.jpg</video:thumbnail_loc>
      <video:description>this is the description</video:description>
    </video:video>
    <lastmod>2021-01-01</lastmod>
    <changefreq>weekly</changefreq>
    <priority>0.5</priority>
  </url>
</urlset>
```

### ローカライズされた Sitemap を生成する {#generate-a-localized-sitemap}

<Tabs>
<TabItem value="ts" label="TypeScript">

```ts title="app/sitemap.ts" switcher
import type { MetadataRoute } from 'next'

export default function sitemap(): MetadataRoute.Sitemap {
  return [
    {
      url: 'https://acme.com',
      lastModified: new Date(),
      alternates: {
        languages: {
          es: 'https://acme.com/es',
          de: 'https://acme.com/de',
        },
      },
    },
    {
      url: 'https://acme.com/about',
      lastModified: new Date(),
      alternates: {
        languages: {
          es: 'https://acme.com/es/about',
          de: 'https://acme.com/de/about',
        },
      },
    },
    {
      url: 'https://acme.com/blog',
      lastModified: new Date(),
      alternates: {
        languages: {
          es: 'https://acme.com/es/blog',
          de: 'https://acme.com/de/blog',
        },
      },
    },
  ]
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/sitemap.js" switcher
export default function sitemap() {
  return [
    {
      url: 'https://acme.com',
      lastModified: new Date(),
      alternates: {
        languages: {
          es: 'https://acme.com/es',
          de: 'https://acme.com/de',
        },
      },
    },
    {
      url: 'https://acme.com/about',
      lastModified: new Date(),
      alternates: {
        languages: {
          es: 'https://acme.com/es/about',
          de: 'https://acme.com/de/about',
        },
      },
    },
    {
      url: 'https://acme.com/blog',
      lastModified: new Date(),
      alternates: {
        languages: {
          es: 'https://acme.com/es/blog',
          de: 'https://acme.com/de/blog',
        },
      },
    },
  ]
}
```

</TabItem>
</Tabs>

出力：

```xml title="acme.com/sitemap.xml"
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9" xmlns:xhtml="http://www.w3.org/1999/xhtml">
  <url>
    <loc>https://acme.com</loc>
    <xhtml:link
      rel="alternate"
      hreflang="es"
      href="https://acme.com/es"/>
    <xhtml:link
      rel="alternate"
      hreflang="de"
      href="https://acme.com/de"/>
    <lastmod>2023-04-06T15:02:24.021Z</lastmod>
  </url>
  <url>
    <loc>https://acme.com/about</loc>
    <xhtml:link
      rel="alternate"
      hreflang="es"
      href="https://acme.com/es/about"/>
    <xhtml:link
      rel="alternate"
      hreflang="de"
      href="https://acme.com/de/about"/>
    <lastmod>2023-04-06T15:02:24.021Z</lastmod>
  </url>
  <url>
    <loc>https://acme.com/blog</loc>
    <xhtml:link
      rel="alternate"
      hreflang="es"
      href="https://acme.com/es/blog"/>
    <xhtml:link
      rel="alternate"
      hreflang="de"
      href="https://acme.com/de/blog"/>
    <lastmod>2023-04-06T15:02:24.021Z</lastmod>
  </url>
</urlset>
```

### 複数の sitemap を生成する {#generating-multiple-sitemaps}

ほとんどのアプリケーションには単一の sitemap で問題ありません。ただし、大規模な Web アプリケーションの場合、sitemap を複数のファイルに分割する必要があるかもしれません。

複数の sitemap を作成する方法は2つあります：

- `sitemap.(xml|js|ts)` を複数のルートセグメント内にネストする方法、例：`app/sitemap.xml` と `app/products/sitemap.xml`
- [`generateSitemaps`](/docs/app/api-reference/functions/generate-sitemaps) 関数を使用する方法

例えば、`generateSitemaps` を使用して sitemap を分割するには、sitemap の `id` を含むオブジェクトの配列を返します。次に、`id` を使用してユニークな sitemap を生成します。

<Tabs>
<TabItem value="ts" label="TypeScript">

```ts title="app/product/sitemap.ts" switcher
import type { MetadataRoute } from 'next'
import { BASE_URL } from '@/app/lib/constants'

export async function generateSitemaps() {
  // 商品の総数を取得し、必要な sitemap の数を計算します
  return [{ id: 0 }, { id: 1 }, { id: 2 }, { id: 3 }]
}

export default async function sitemap({
  id,
}: {
  id: number
}): Promise<MetadataRoute.Sitemap> {
  // Google の制限は sitemap あたり 50,000 URLs です
  const start = id * 50000
  const end = start + 50000
  const products = await getProducts(
    `SELECT id, date FROM products WHERE id BETWEEN ${start} AND ${end}`
  )
  return products.map((product) => ({
    url: `${BASE_URL}/product/${product.id}`,
    lastModified: product.date,
  }))
}
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="app/product/sitemap.js" switcher
import { BASE_URL } from '@/app/lib/constants'

export async function generateSitemaps() {
  // 商品の総数を取得し、必要な sitemap の数を計算します
  return [{ id: 0 }, { id: 1 }, { id: 2 }, { id: 3 }]
}

export default async function sitemap({ id }) {
  // Google の制限は sitemap あたり 50,000 URLs です
  const start = id * 50000
  const end = start + 50000
  const products = await getProducts(
    `SELECT id, date FROM products WHERE id BETWEEN ${start} AND ${end}`
  )
  return products.map((product) => ({
    url: `${BASE_URL}/product/${product.id}`,
    lastModified: product.date,
  }))
}
```

</TabItem>
</Tabs>

生成された sitemap は `/.../sitemap/[id]` で利用可能になります。例えば、`/product/sitemap/1.xml` です。

詳細については、[`generateSitemaps` API リファレンス](/docs/app/api-reference/functions/generate-sitemaps)を参照してください。

## Returns {#returns}

`sitemap.(xml|ts|js)` からエクスポートされたデフォルト関数は、以下のプロパティを持つオブジェクトの配列を返す必要があります：

```tsx
type Sitemap = Array<{
  url: string
  lastModified?: string | Date
  changeFrequency?:
    | 'always'
    | 'hourly'
    | 'daily'
    | 'weekly'
    | 'monthly'
    | 'yearly'
    | 'never'
  priority?: number
  alternates?: {
    languages?: Languages<string>
  }
}>
```

## バージョン履歴 {#version-history}

| バージョン | 変更点                                                  |
| ---------- | ------------------------------------------------------- |
| `v14.2.0`  | ローカライズサポートを追加。                            |
| `v13.4.14` | `changeFrequency` と `priority` 属性を sitemap に追加。 |
| `v13.3.0`  | `sitemap` を導入。                                      |

---
title: 'inlineCss'
description: 'インラインCSSサポートを有効にする'
version: 'experimental'
---

## 使用方法 {#usage}

`<head>`内でのCSSインライン化に対する実験的サポートです。このフラグを有効にすると、通常は`<link>`タグを生成する場所で生成された`<style>`タグが使用されます。

<Tabs>
<TabItem value="ts" label="TypeScript">

```ts title="next.config.ts" switcher
import type { NextConfig } from 'next'

// 次の設定はNext.jsの設定を定義します
const nextConfig: NextConfig = {
  experimental: {
    inlineCss: true, // CSSをインライン化する実験的な設定を有効にします
  },
}

// 設定をエクスポートして、Next.jsで利用可能にします
export default nextConfig
```

</TabItem>
<TabItem value="js" label="JavaScript">

```js title="next.config.js" switcher
/** @type {import('next').NextConfig} */
// 次の設定はNext.jsの設定を定義します
const nextConfig = {
  experimental: {
    inlineCss: true, // CSSをインライン化する実験的な設定を有効にします
  },
}

// 設定をエクスポートして、Next.jsで利用可能にします
module.exports = nextConfig
```

</TabItem>
</Tabs>

## トレードオフ {#trade-offs}

### インラインCSSを使用するタイミング {#when-to-use-inline-css}

以下の状況では、CSSのインライン化が有益です：

- **初回訪問者**：CSSファイルはレンダーブロックリソースであるため、インライン化すると、初回訪問者が経験する初期ダウンロード遅延をなくし、ページの読み込みパフォーマンスを向上させます

- **パフォーマンス指標**：CSSファイルの追加のネットワークリクエストを削減することで、First Contentful Paint（FCP）やLargest Contentful Paint（LCP）といった重要な指標を大幅に改善できます

- **遅い接続**：各リクエストがかなりの遅延を引き起こす遅いネットワークを使用しているユーザーにとって、CSSのインライン化はネットワークリクエストを減らして目に見えるパフォーマンス向上を提供できます

- **アトミックCSSバンドル（例：Tailwind）**：Tailwind CSSのようなユーティリティファーストのフレームワークでは、そのページに必要なスタイルのサイズは設計の複雑さに対して一定のサイズ（O(1)）になります。これにより、現在のページのスタイル全体が軽量で、ページサイズとともに増加しないため、インライン化が魅力的な選択肢となります。Tailwindスタイルのインライン化は、最小限のペイロードを保証し、さらなるパフォーマンス向上のために追加のネットワークリクエストを排除します

### インラインCSSを使用しないタイミング {#when-not-to-use-inline-css}

インラインCSSはパフォーマンスに多大な利点を提供しますが、適さない状況もあります：

- **大規模なCSSバンドル**：CSSバンドルが大きすぎる場合、インライン化するとHTMLのサイズがかなり増加し、Time to First Byte（TTFB）が遅くなり、遅い接続のユーザーにとってパフォーマンスが悪化する可能性があります
- **動的またはページ特有のCSS**：スタイルが非常に動的なアプリケーションや異なるCSSセットを使用するページでは、すべてのページのCSSを繰り返しインライン化することで冗長化や増大に繋がる可能性があります

- **ブラウザキャッシング**：訪問者が頻繁にサイトを訪れる場合、外部CSSファイルはブラウザが効率的にスタイルをキャッシュするのを可能にし、後続の訪問でデータ転送を削減します。インラインCSSはこの利点を除去します

これらのトレードオフを慎重に評価し、クリティカルCSS抽出やハイブリッドアプローチなどの他の戦略と組み合わせて、サイトのニーズに合わせた最適な結果を目指してください。

> **Good to know**:
>
> この機能は現在実験段階であり、いくつかの既知の制約があります：
>
> - CSSのインライン化はグローバルに適用され、ページごとに設定することはできません
> - 初期ページロード時にスタイルが重複します - SSR用の`<style>`タグ内とRSCペイロード内に同時に存在します
> - 静的にレンダリングされたページへの移動時にスタイルは重複を避けるために`<link>`タグを使用します
> - 開発モードでは使用できず、本番ビルドでのみ機能します

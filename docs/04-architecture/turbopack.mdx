---
title: 'Turbopack'
description: 'TurbopackはJavaScriptとTypeScriptに最適化された増分バンドラーで、Rustで書かれており、Next.jsに組み込まれています。'
---

[Turbopack](https://turbo.build/pack)（ベータ版）は、JavaScriptとTypeScriptに最適化された増分バンドラーで、Rustで書かれており、Next.jsに組み込まれています。

## 使用方法

Turbopackは、Next.jsの`pages`ディレクトリと`app`ディレクトリの両方で使用でき、ローカル開発をより高速化します。Turbopackを有効にするには、Next.js開発サーバーを起動する際に`--turbo`フラグを使用します。

```json title="package.json" highlight={3}
{
  "scripts": {
    "dev": "next dev --turbo", // 開発サーバーの起動コマンド
    "build": "next build", // ビルドコマンド
    "start": "next start", // サーバースタートコマンド
    "lint": "next lint" // Lintの実行コマンド
  }
}
```

## サポートされている機能

Turbopackは、ほとんどのユーザーにとって設定の必要がなく、より高度なユースケースに対して拡張可能です。現在サポートされているTurbopackの機能について詳しく知るには、[APIリファレンス](/docs/app/api-reference/next-config-js/turbo)を参照してください。

## サポートされていない機能

Turbopackは現在、`next dev`のみをサポートしており、`next build`はサポートしていません。安定性に近づくにつれて、ビルドサポートにも取り組んでいます。

現在サポートされていない機能は以下の通りです：

- Turbopackは[Lightning CSS](https://lightningcss.dev/)を活用しており、使用頻度の低いCSSモジュールの一部機能をサポートしていません
  - 単一の擬似クラスとしての`:local`および`:global`。関数的なバリエーションのみがサポートされます（例：`:global(a)`）。
  - CSS変数に置き換えられた@value規則。
  - `:import`および`:export` ICSS規則。
- [不正なCSSコメント構文](https://stackoverflow.com/questions/51843506/are-double-slash-comments-valid-in-css) 例：`//`
  - CSSコメントは仕様に従って`/* comment */`と記述されるべきです。
  - Sassなどのプリプロセッサはこの代替構文をサポートしています。
- `next.config.js`内の[`webpack()`](/docs/app/api-reference/next-config-js/webpack)構成
  - TurbopackはWebpackを置き換えるため、Webpack構成はサポートされません。
  - Turbopackの構成については、[ドキュメントを参照してください](/docs/app/api-reference/next-config-js/turbo)。
  - Turbopackでは、[Webpackローダーのサブセット](/docs/app/api-reference/next-config-js/turbo#configuring-webpack-loaders)がサポートされています。
- Babel（`.babelrc`）
  - Turbopackはすべてのトランスパイルと最適化のために[SWC](/docs/architecture/nextjs-compiler#why-swc)コンパイラを使用しています。これにより、Babelはデフォルトで含まれていません。
  - `.babelrc`ファイルがある場合、Next.jsには有効にできる共通のBabelプラグインがSWC変換として含まれているため、もはや必要ないかもしれません。これについては[コンパイラのドキュメント](/docs/architecture/nextjs-compiler#supported-features)で詳しく読むことができます。
  - 特定のユースケースがカバーされていないことを確認した後でBabelを使用する必要がある場合は、Turbopackの[カスタムWebpackローダーのサポート](/docs/app/api-reference/next-config-js/turbo#configuring-webpack-loaders)を活用して`babel-loader`を含めることができます。
- App Routerでのroot レイアウトの自動作成
  - この動作は現在サポートされていません。入力ファイルを変更するため、代わりに手動で所望の場所にroot レイアウトを追加するようにエラーが表示されます。
- `@next/font`（旧フォントサポート）
  - `@next/font`は`next/font`に置き換えられました。[`next/font`](/docs/app/building-your-application/optimizing/fonts)はTurbopackで完全にサポートされています。
- [Relay transforms](/docs/architecture/nextjs-compiler#relay)
  - 将来的にはこれを実装する予定です。
- `pages/_document.tsx`での`.css`インポートのブロック
  - 現在、Next.jsはWebpackを使用して`pages/_document.tsx`での`.css`ファイルのインポートをブロックしています。
  - これに関する警告を将来的に実装する予定です。
- [`experimental.typedRoutes`](https://nextjs.org/docs/app/api-reference/next-config-js/typedRoutes)
  - 将来的にはこれを実装する予定です。
- `experimental.nextScriptWorkers`
  - 将来的にはこれを実装する予定です。
- `experimental.sri.algorithm`
  - 将来的にはこれを実装する予定です。
- `experimental.fallbackNodePolyfills`
  - 将来的にはこれを実装する予定です。
- `experimental.esmExternals`
  - Turbopackを使用したNext.jsでのレガシーesmExternals構成をサポートする予定はありません。
- [AMP](https://nextjs.org/docs/canary/pages/building-your-application/configuring/amp).
  - Turbopackを使用したNext.jsでAMPをサポートする予定はありません。
- Yarn PnP
  - Turbopackを使用したNext.jsでYarn PnPをサポートする予定はありません。
- [`experimental.urlImports`](/docs/app/api-reference/next-config-js/urlImports)
  - Turbopackを使用したNext.jsで`experimental.urlImports`をサポートする予定はありません。
- [`:import`と`:export`のICSS規則](https://github.com/css-modules/icss)
  - Turbopackが使用するCSSパーサーである[Lightning CSS](https://lightningcss.dev/css-modules.html)がこれらの規則をサポートしていないため、Turbopackを使用したNext.jsにおいて`:import`と`:export`のICSS規則をサポートする予定はありません。
- edge runtimeでの`unstable_allowDynamic`構成

## トレースファイルの生成

トレースファイルにより、Next.jsのチームはパフォーマンスメトリクスとメモリ使用率の調査と改善を行えます。トレースファイルを生成するには、`next dev --turbo`コマンドに`NEXT_TURBOPACK_TRACING=1`を追加します。これで`.next/trace.log`ファイルが生成されます。

Turbopackのパフォーマンスとメモリ使用に関する問題を報告する際には、[GitHub](https://github.com/vercel/next.js)のissueにトレースファイルを含めてください。
---
title: 'Turbopack'
description: 'TurbopackはJavaScriptとTypeScriptに最適化されたインクリメンタルバンドラーで、Rustで記述され、Next.jsに組み込まれています。'
---

[Turbopack](https://turbo.build/pack)はJavaScriptとTypeScriptに最適化されたインクリメンタルバンドラーで、Rustで記述され、Next.jsに組み込まれています。

## 使用法 {#usage}

Turbopackは、Next.jsの`pages`ディレクトリと`app`ディレクトリの両方で利用可能で、ローカル開発の速度を向上させます。Turbopackを有効にするには、Next.js開発サーバーを起動する際に`--turbopack`フラグを使用してください。

```json title="package.json" highlight={3}
{
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  }
}
```

## サポートされている機能 {#supported-features}

Next.jsにおけるTurbopackは、ほとんどのユーザーに対して設定不要で動作し、より高度なユースケースに対して拡張可能です。現在サポートされているTurbopackの機能について詳しく知るには、[APIリファレンス](/docs/app/api-reference/next-config-js/turbo)をご覧ください。

## サポートされていない機能 {#unsupported-features}

Turbopackは現在、`next dev`のみをサポートしており、`next build`をサポートしていません。私たちは現在、安定性に向けてビルドのサポートに取り組んでいます。

現在サポートされていない機能は以下の通りです：

- Turbopackは[Lightning CSS](https://lightningcss.dev/)を活用しており、使用頻度の低いCSS Modulesの一部機能をサポートしていません
  - 単独の疑似クラスとしての`:local`および`:global`。関数バリアントのみがサポートされています（例：`:global(a)`）。
  - CSS変数に置き換えられた@valueルール。
  - `:import`および`:export`のICSSルール。
- [無効なCSSコメント構文](https://stackoverflow.com/questions/51843506/are-double-slash-comments-valid-in-css)（例：`//`）
  - CSSコメントは仕様に従って`/* comment */`の形式で記述する必要があります。
  - Sassなどのプリプロセッサーはこの代替コメント構文をサポートしています。
- `next.config.js`の[`webpack()`](/docs/app/api-reference/next-config-js/webpack)構成
  - TurbopackはWebpackを置き換えるため、webpackの構成はサポートされていません。
  - Turbopackを構成するには、[ドキュメントを参照](/docs/app/api-reference/next-config-js/turbo)してください。
  - Webpack loaders](/docs/app/api-reference/next-config-js/turbo#configuring-webpack-loaders)のサブセットは、Turbopackでサポートされています。
- Babel (`.babelrc`)
  - Turbopackはトランスパイルと最適化のすべてに[SWC](/docs/architecture/nextjs-compiler#why-swc)コンパイラを活用しています。これにより、Babelはデフォルトでは含まれません。
  - `.babelrc`ファイルがある場合、Next.jsがよく使用されるBabelプラグインをSWC変換として有効化できるため、もう必要ないかもしれません。詳しくは[コンパイラのドキュメント](/docs/architecture/nextjs-compiler#supported-features)をご覧ください。
  - 特定のユースケースがカバーされていないことを確認した後、依然としてBabelを使用する必要がある場合、Turbopackの[カスタムwebpack loadersのサポート](/docs/app/api-reference/next-config-js/turbo#configuring-webpack-loaders)を活用して`babel-loader`を含めることができます。
- App Routerでのrootレイアウト自動作成。
  - この動作は入力ファイルを変更するため、現在サポートされていません。代わりに、希望する場所に手動でroot レイアウトを追加するようにエラーが表示されます。
- `@next/font`（レガシーフォントサポート）。
  - `@next/font`は`next/font`に置き換えられました。[`next/font`](/docs/app/building-your-application/optimizing/fonts)はTurbopackと完全に互換性があります。
- [Relay変換](/docs/architecture/nextjs-compiler#relay)
  - 将来的にこれを実装する予定です。
- `pages/_document.tsx`での`.css`インポートのブロック
  - 現在、webpackではNext.jsが`pages/_document.tsx`での`.css`ファイルのインポートをブロックしています
  - 将来的にこの警告を実装する予定です。
- [`experimental.typedRoutes`](https://nextjs.org/docs/app/api-reference/next-config-js/typedRoutes)
  - 将来的にこれを実装する予定です。
- `experimental.nextScriptWorkers`
  - 将来的にこれを実装する予定です。
- `experimental.sri.algorithm`
  - 将来的にこれを実装する予定です。
- `experimental.fallbackNodePolyfills`
  - 将来的にこれを実装する予定です。
- `experimental.esmExternals`
  - 現在、Next.jsにおけるTurbopackでのesmExternalsのレガシー構成をサポートする予定はありません。
- [AMP](https://nextjs.org/docs/canary/pages/building-your-application/configuring/amp)。
  - 現在、Next.jsにおけるTurbopackでのAMPサポートを計画していません。
- Yarn PnP
  - 現在、Next.jsにおけるTurbopackでのYarn PnPサポートを計画していません。
- [`experimental.urlImports`](/docs/app/api-reference/next-config-js/urlImports)
  - 現在、Next.jsにおけるTurbopackでの`experimental.urlImports`サポートを計画していません。
- [`:import`および`:export`のICSSルール](https://github.com/css-modules/icss)
  - 現在、Next.jsにおけるTurbopackでの`:import`および`:export`のICSSルールサポートを計画していません。Turbopackが利用するCSSパーサーである[Lightning CSS](https://lightningcss.dev/css-modules.html)はこれらのルールをサポートしていません。
- edge runtimeにおける`unstable_allowDynamic`構成

## トレースファイルの生成 {#generating-trace-files}

トレースファイルは、Next.jsチームがパフォーマンス指標とメモリ使用量を調査し、改善するのに役立ちます。トレースファイルを生成するには、`next dev --turbopack`コマンドに`NEXT_TURBOPACK_TRACING=1`を追加して実行してください。これにより`.next/trace.log`ファイルが生成されます。

Turbopackのパフォーマンスとメモリ使用量に関連する問題を報告する際には、[GitHub](https://github.com/vercel/next.js)でトレースファイルを含めてください。

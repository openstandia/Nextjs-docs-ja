---
title: 'Turbopack'
description: 'TurbopackはJavaScriptとTypeScriptに最適化されたインクリメンタルバンドラーで、Rustで書かれており、Next.jsに組み込まれています。'
---

[Turbopack](https://turbo.build/pack)はJavaScriptとTypeScriptに最適化されたインクリメンタルバンドラーで、Rustで書かれており、Next.jsに組み込まれています。

## 使用法 {#usage}

TurbopackはNext.jsにおいて、ローカル開発を高速化するために`pages`ディレクトリと`app`ディレクトリの両方で使用できます。Turbopackを有効にするには、Next.jsの開発サーバーを実行するときに`--turbopack`フラグを使用してください。

```json title="package.json" highlight={3}
{
  "scripts": {
    "dev": "next dev --turbopack",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  }
}
```

## 対応機能 {#supported-features}

Next.jsでのTurbopackは、ほとんどのユーザーにとって設定不要で使用でき、より高度なユースケースにも拡張可能です。現在Turbopackでサポートされている機能について詳しくは、[APIリファレンス](/docs/app/api-reference/config/next-config-js/turbo)をご覧ください。

## 未対応機能 {#unsupported-features}

Turbopackは現在、`next dev`のみをサポートしており、`next build`はサポートしていません。安定性に向けての開発を進めているところです。

現在、以下の機能はサポートされていません：

- Turbopackは、いくつかの低利用のCSS Modules機能をサポートしていない[Lightning CSS](https://lightningcss.dev/)を利用しています
  - 独立した擬似クラスとしての`:local`と`:global`。関数バリアントのみがサポートされています。例えば、`:global(a)`です。
  - CSS変数によって置き換えられた@valueルール。
  - `:import`と`:export`のICSSルール。
- [無効なCSSコメント構文](https://stackoverflow.com/questions/51843506/are-double-slash-comments-valid-in-css) `//` のようなもの
  - CSSのコメントは仕様に従って`/* comment */`として書かれるべきです。
  - Sassのようなプリプロセッサはコメントのためのこの代替構文をサポートしています。
- `next.config.js`内の[`webpack()`](/docs/app/api-reference/config/next-config-js/webpack)設定
  - TurbopackはWebpackを置き換えるため、Webpack設定はサポートされていません。
  - Turbopackを設定するには、[ドキュメントを参照](/docs/app/api-reference/config/next-config-js/turbo)してください。
  - Turbopackでは[Webpack loaders](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders)のサブセットがサポートされています。
- Babel (`.babelrc`)
  - Turbopackは、すべてのトランスパイルと最適化に[SWC](/docs/architecture/nextjs-compiler#why-swc)コンパイラを利用しています。これにより、Babelはデフォルトで含まれていません。
  - `.babelrc`ファイルがある場合、Next.jsには有効化できる共通のBabelプラグインを用いたSWCトランスフォームが含まれているため、もはや必要でないかもしれません。このことについて詳しくは、[コンパイラのドキュメント](/docs/architecture/nextjs-compiler#supported-features)を参照してください。
  - 特定のユースケースがカバーされていないことを確認した後でまだ必要な場合、Turbopackの[カスタムwebpackロードのサポート](/docs/app/api-reference/config/next-config-js/turbo#configuring-webpack-loaders)を利用して`babel-loader`を含めることができます。
- App Routerでのroot レイアウトを自動作成
  - この動作は入力ファイルを変更するため、現在サポートされていないため、目的の場所にroot レイアウトを手動で追加するようにエラーメッセージが表示されます。
- `@next/font`（旧フォントサポート）
  - `@next/font`は`next/font`を支持して廃止されています。[`next/font`](/docs/app/building-your-application/optimizing/fonts)はTurbopackと完全に互換性があります。
- [Relay transforms](/docs/architecture/nextjs-compiler#relay)
  - 今後実装を予定しています。
- `pages/_document.tsx`内の`.css`インポートのブロック
  - 現在、Webpackを用いてNext.jsは`pages/_document.tsx`内の`.css`ファイルのインポートをブロックしています。
  - この警告の実装を将来的に予定しています。
- [`experimental.typedRoutes`](https://nextjs.org/docs/app/api-reference/config/next-config-js/typedRoutes)
  - 今後実装を予定しています。
- `experimental.nextScriptWorkers`
  - 今後実装を予定しています。
- `experimental.sri.algorithm`
  - 今後実装を予定しています。
- `experimental.fallbackNodePolyfills`
  - 今後実装を予定しています。
- `experimental.esmExternals`
  - 次のバージョンのNext.jsでのレガシーなesmExternals設定サポートの計画はありません。
- [AMP](https://nextjs.org/docs/canary/pages/building-your-application/configuring/amp)
  - 次のバージョンのNext.jsでのAMPサポートの計画はありません。
- Yarn PnP
  - 次のバージョンのNext.jsでのYarn PnPサポートの計画はありません。
- [`experimental.urlImports`](/docs/app/api-reference/config/next-config-js/urlImports)
  - 次のバージョンのNext.jsでの`experimental.urlImports`サポートの計画はありません。
- [`:import`と`:export`のICSSルール](https://github.com/css-modules/icss)
  - Turbopackが使用するCSSパーサーである[Lightning CSS](https://lightningcss.dev/css-modules.html)がこれらのルールをサポートしていないため、`:import`と`:export`のICSSルールのサポートは予定されていません。
- edge runtimeでの`unstable_allowDynamic`設定

## トレースファイルの生成 {#generating-trace-files}

トレースファイルは、Next.jsチームがパフォーマンス指標とメモリ使用率を調査して改善するのを助けます。トレースファイルを生成するには、`next dev --turbopack`コマンドに`NEXT_TURBOPACK_TRACING=1`を追加してください。これにより、`.next/trace.log`ファイルが生成されます。

Turbopackのパフォーマンスとメモリ使用量に関連する問題を報告する際には、[GitHub](https://github.com/vercel/next.js)のissueにトレースファイルを含めてください。

---
title: cookies
description: cookies関数のAPIリファレンスです
---

`cookies`関数は、[サーバーコンポーネント](/docs/app/building-your-application/rendering/server-components)からHTTPの入力リクエストのクッキーを読み取るか、[サーバーアクション](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[ルートハンドラー](/docs/app/building-your-application/routing/route-handlers)で出力リクエストのクッキーを書き込むことができます。

```tsx filename="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default function Page() {
  const cookieStore = cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

```js filename="app/page.js" switcher
import { cookies } from 'next/headers'

export default function Page() {
  const cookieStore = cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

## リファレンス

### メソッド

以下のメソッドが利用可能です。

| メソッド                     | 戻り値の型          | 説明                                                                 |
| --------------------------- | ------------------ | ------------------------------------------------------------------- |
| `get('name')`               | Object             | クッキー名を受け取り、その名前と値を持つオブジェクトを返します                                                |
| `getAll()`                  | Array of objects   | 一致する名前を持つすべてのクッキーのリストを返します                                                      |
| `has('name')`               | Boolean            | クッキー名を受け取り、クッキーが存在するかどうかに基づいてブール値を返します                                       |
| `set(name, value, options)` | -                  | クッキー名、値、オプションを受け取り、出力リクエストのクッキーを設定します                                         |
| `delete(name)`              | -                  | クッキー名を受け取り、クッキーを削除します                                                               |
| `clear()`                   | -                  | すべてのクッキーを削除します                                                                        |
| `toString()`                | String             | クッキーの文字列表現を返します                                                                |

### オプション

クッキーを設定する際には、`options`オブジェクトの以下のプロパティがサポートされています。

| オプション          | 型                                     | 説明                                                                        |
| ----------------- | -------------------------------------- | -------------------------------------------------------------------------  |
| `name`            | String                                 | クッキーの名前を指定します                                                             |
| `value`           | String                                 | クッキーに保存される値を指定します                                                        |
| `expires`         | Date                                   | クッキーが失効する正確な日付を定義します                                                      |
| `maxAge`          | Number                                 | クッキーの寿命を秒単位で設定します                                                        |
| `domain`          | String                                 | クッキーが有効なドメインを指定します                                                        |
| `path`            | String                                 | ドメイン内の特定のパスにクッキーのスコープを限定します                                             |
| `secure`          | Boolean                                | セキュリティを強化するために、HTTPS接続でのみクッキーが送信されるようにします                           |
| `httpOnly`        | Boolean                                | HTTPリクエストにクッキーを制限し、クライアントサイドのアクセスを防ぎます                                 |
| `sameSite`        | Boolean, `'lax'`, `'strict'`, `'none'` | クッキーのクロスサイトリクエストの動作を制御します                                              |
| `priority`        | String (`"low"`, `"medium"`, `"high"`) | クッキーの優先順位を指定します                                                       |
| `encode('value')` | Function                               | クッキーの値をエンコードするために使用される関数を指定します                                     |
| `partitioned`     | Boolean                                | クッキーが[分割されている](https://github.com/privacycg/CHIPS)かどうかを示します           |

これらのオプションについて詳しくは、[MDNドキュメント](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)を参照してください。

## 注意事項

- `cookies()`は、その戻り値が事前に知られていない[動的関数](/docs/app/building-your-application/rendering/server-components#dynamic-functions)です。レイアウトやページで使用すると、ルートが[動的レンダリング](/docs/app/building-your-application/rendering/server-components#dynamic-rendering)に切り替わります。
- `.delete()`メソッドは以下の場合にのみ呼び出すことができます：
  - [サーバーアクション](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[ルートハンドラー](/docs/app/building-your-application/routing/route-handlers)内
  - `.set()`が呼び出される同じドメインに属している場合。また、削除するクッキーのプロトコル（HTTPまたはHTTPS）と同じプロトコルでコードを実行する必要があります。
- HTTPではストリーミング開始後にクッキーを設定することは許可されていないため、[サーバーアクション](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[ルートハンドラー](/docs/app/building-your-application/routing/route-handlers)で`.set()`を使用する必要があります。

## 例

### クッキーの取得

`cookies().get('name')`メソッドを使用して、単一のクッキーを取得できます。

```tsx filename="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default function Page() {
  const cookieStore = cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

```jsx filename="app/page.js" switcher
import { cookies } from 'next/headers'

export default function Page() {
  const cookieStore = cookies()
  const theme = cookieStore.get('theme')
  return '...'
}
```

### すべてのクッキーの取得

`cookies().getAll()`メソッドを使用して、一致する名前を持つすべてのクッキーを取得できます。`name`が指定されていない場合、利用可能なすべてのクッキーを返します。

```tsx filename="app/page.tsx" switcher
import { cookies } from 'next/headers'

export default function Page() {
  const cookieStore = cookies()
  return cookieStore.getAll().map((cookie) => (
    <div key={cookie.name}>
      <p>Name: {cookie.name}</p>
      <p>Value: {cookie.value}</p>
    </div>
  ))
}
```

```jsx filename="app/page.js" switcher
import { cookies } from 'next/headers'

export default function Page() {
  const cookieStore = cookies()
  return cookieStore.getAll().map((cookie) => (
    <div key={cookie.name}>
      <p>Name: {cookie.name}</p>
      <p>Value: {cookie.value}</p>
    </div>
  ))
}
```

### クッキーの設定

`cookies().set(name, value, options)`メソッドを[サーバーアクション](/docs/app/building-your-application/data-fetching/server-actions-and-mutations)または[ルートハンドラー](/docs/app/building-your-application/routing/route-handlers)内で使用して、クッキーを設定できます。[`options`オブジェクト](#options)はオプションです。

```tsx filename="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

async function create(data) {
  cookies().set('name', 'lee')
  // または
  cookies().set('name', 'lee', { secure: true })
  // または
  cookies().set({
    name: 'name',
    value: 'lee',
    httpOnly: true,
    path: '/',
  })
}
```

```js filename="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

async function create(data) {
  cookies().set('name', 'lee')
  // または
  cookies().set('name', 'lee', { secure: true })
  // または
  cookies().set({
    name: 'name',
    value: 'lee',
    httpOnly: true,
    path: '/',
  })
}
```

### クッキーが存在するかの確認

`cookies().has(name)`メソッドを使用して、クッキーが存在するかを確認できます。

```tsx filename="app/page.ts" switcher
import { cookies } from 'next/headers'

export default function Page() {
  const cookieStore = cookies()
  const hasCookie = cookieStore.has('theme')
  return '...'
}
```

```jsx filename="app/page.js" switcher
import { cookies } from 'next/headers'

export default function Page() {
  const cookieStore = cookies()
  const hasCookie = cookieStore.has('theme')
  return '...'
}
```

### クッキーの削除

クッキーを削除する方法は3つあります。

`delete()`メソッドを使用する：

```tsx filename="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

async function delete(data) {
  cookies().delete('name')
}
```

```js filename="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

async function delete(data) {
  cookies().delete('name')
}
```

同じ名前と空の値を持つ新しいクッキーを設定する：

```tsx filename="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

async function delete(data) {
  cookies().set('name', '')
}
```

```js filename="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

async function delete(data) {
  cookies().set('name', '')
}
```

`maxAge`を0に設定すると、クッキーはすぐに失効します。`maxAge`は秒単位の値を受け入れます。

```tsx filename="app/actions.ts" switcher
'use server'

import { cookies } from 'next/headers'

async function delete(data) {
  cookies().set('name', 'value', { maxAge: 0 })
}
```

```js filename="app/actions.js" switcher
'use server'

import { cookies } from 'next/headers'

async function delete(data) {
  cookies().set('name', 'value', { maxAge: 0 })
}
```

## バージョン履歴

| バージョン   | 変更内容                 |
| --------- | --------------------- |
| `v13.0.0` | `cookies`が導入されました |

---
title: 'generateViewport'
description: 'generateViewport 関数のAPIリファレンス。'
related:
  title: 'Next Steps'
  description: 'すべてのMetadata APIオプションを参照。'
  links:
    - app/api-reference/file-conventions/metadata
    - app/building-your-application/optimizing/metadata
---

静的な`viewport`オブジェクトや動的な`generateViewport`関数を使って、ページの初期ビューポートをカスタマイズできます。

> **Good to know**:
>
> - `viewport`オブジェクトと`generateViewport`関数のエクスポートは**Server Componentsのみサポートされています**。
> - 同じルートセグメントから`viewport`オブジェクトと`generateViewport`関数の両方をエクスポートすることはできません。
> - `metadata`エクスポートの移行から来ている場合は、[metadata-to-viewport-export コードモッド](/docs/app/building-your-application/upgrading/codemods#metadata-to-viewport-export)を使用して変更を更新できます。

## `viewport`オブジェクト

ビューポートオプションを定義するには、`layout.jsx`または`page.jsx`ファイルから`viewport`オブジェクトをエクスポートします。

```tsx filename="layout.tsx | page.tsx" switcher
import type { Viewport } from 'next'

// ビューポートオブジェクトをエクスポート
export const viewport: Viewport = {
  themeColor: 'black', // テーマカラーを黒に設定
}

export default function Page() {}
```

```jsx filename="layout.jsx | page.jsx" switcher
// ビューポートオブジェクトをエクスポート
export const viewport = {
  themeColor: 'black', // テーマカラーを黒に設定
}

export default function Page() {}
```

## `generateViewport` 関数

`generateViewport`は、1つ以上のビューポートフィールドを含む[`Viewport`オブジェクト](#viewport-fields)を返すべきです。

```tsx filename="layout.tsx | page.tsx" switcher
// generateViewport関数のエクスポート
export function generateViewport({ params }) {
  return {
    themeColor: '...', // 動的にテーマカラーを設定
  }
}
```

```jsx filename="layout.js | page.js" switcher
// generateViewport関数のエクスポート
export function generateViewport({ params }) {
  return {
    themeColor: '...', // 動的にテーマカラーを設定
  }
}
```

> **Good to know**:
>
> - ビューポートがランタイム情報に依存しない場合は、`generateViewport`ではなく静的な[`viewport`オブジェクト](#the-viewport-object)を使用して定義すべきです。

## ビューポートフィールド

### `themeColor`

[`theme-color`](https://developer.mozilla.org/docs/Web/HTML/Element/meta/name/theme-color)について詳しく学ぶ

**シンプルなテーマカラー**

```tsx filename="layout.tsx | page.tsx" switcher
import type { Viewport } from 'next'

// ビューポートオブジェクトをエクスポート
export const viewport: Viewport = {
  themeColor: 'black', // テーマカラーを黒に設定
}
```

```jsx filename="layout.jsx | page.jsx" switcher
// ビューポートオブジェクトをエクスポート
export const viewport = {
  themeColor: 'black', // テーマカラーを黒に設定
}
```

```html filename="<head> output" hideLineNumbers
<meta name="theme-color" content="black" />
```

**メディア属性と一緒に**

```tsx filename="layout.tsx | page.tsx" switcher
import type { Viewport } from 'next'

// ビューポートオブジェクトをエクスポート
export const viewport: Viewport = {
  themeColor: [
    { media: '(prefers-color-scheme: light)', color: 'cyan' }, // 明るい色スキーム用に設定
    { media: '(prefers-color-scheme: dark)', color: 'black' }, // 暗い色スキーム用に設定
  ],
}
```

```jsx filename="layout.jsx | page.jsx" switcher
// ビューポートオブジェクトをエクスポート
export const viewport = {
  themeColor: [
    { media: '(prefers-color-scheme: light)', color: 'cyan' }, // 明るい色スキーム用に設定
    { media: '(prefers-color-scheme: dark)', color: 'black' }, // 暗い色スキーム用に設定
  ],
}
```

```html filename="<head> output" hideLineNumbers
<meta name="theme-color" media="(prefers-color-scheme: light)" content="cyan" />
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black" />
```

### `width`, `initialScale`, `maximumScale` and `userScalable`

> **Good to know**: `viewport`メタタグは自動的に設定され、手動での構成は通常不要です。デフォルトが十分です。ただし、情報を完備するために提供しています。

```tsx filename="layout.tsx | page.tsx" switcher
import type { Viewport } from 'next'

// ビューポートオブジェクトをエクスポート
export const viewport: Viewport = {
  width: 'device-width', // デバイスの幅に設定
  initialScale: 1, // 初期スケールを1に設定
  maximumScale: 1, // 最大スケールを1に設定
  userScalable: false, // ユーザーによる拡大縮小を禁止
  // また、あまり一般的でない
  // interactiveWidget: 'resizes-visual',
}
```

```jsx filename="layout.jsx | page.jsx" switcher
// ビューポートオブジェクトをエクスポート
export const viewport = {
  width: 'device-width', // デバイスの幅に設定
  initialScale: 1, // 初期スケールを1に設定
  maximumScale: 1, // 最大スケールを1に設定
  userScalable: false, // ユーザーによる拡大縮小を禁止
  // また、あまり一般的でない
  // interactiveWidget: 'resizes-visual',
}
```

```html filename="<head> output" hideLineNumbers
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
/>
```

### `colorScheme`

[`color-scheme`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta/name#:~:text=color%2Dscheme%3A%20specifies,of%20the%20following%3A)について詳しく学ぶ

```tsx filename="layout.tsx | page.tsx" switcher
import type { Viewport } from 'next'

// ビューポートオブジェクトをエクスポート
export const viewport: Viewport = {
  colorScheme: 'dark', // 色スキームを暗に設定
}
```

```jsx filename="layout.jsx | page.jsx" switcher
// ビューポートオブジェクトをエクスポート
export const viewport = {
  colorScheme: 'dark', // 色スキームを暗に設定
}
```

```html filename="<head> output" hideLineNumbers
<meta name="color-scheme" content="dark" />
```

## 型

`Viewport`型を使用することで、ビューポートオブジェクトに型の安全性を追加できます。IDEで[組み込みのTypeScriptプラグイン](/docs/app/building-your-application/configuring/typescript)を使用している場合、手動で型を追加する必要はありませんが、希望する場合は明示的に追加することもできます。

### `viewport`オブジェクト

```tsx
import type { Viewport } from 'next'

// ビューポートオブジェクトをエクスポート
export const viewport: Viewport = {
  themeColor: 'black', // テーマカラーを黒に設定
}
```

### `generateViewport`関数

#### 通常の関数

```tsx
import type { Viewport } from 'next'

// generateViewport関数をエクスポート
export function generateViewport(): Viewport {
  return {
    themeColor: 'black', // テーマカラーを黒に設定
  }
}
```

#### セグメントprops付き

```tsx
import type { Viewport } from 'next'

type Props = {
  params: { id: string }
  searchParams: { [key: string]: string | string[] | undefined }
}

// generateViewport関数をエクスポート
export function generateViewport({ params, searchParams }: Props): Viewport {
  return {
    themeColor: 'black', // テーマカラーを黒に設定
  }
}

export default function Page({ params, searchParams }: Props) {}
```

#### JavaScriptプロジェクト

JavaScriptプロジェクトの場合、JSDocを使用して型の安全性を追加できます。

```js
/** @type {import("next").Viewport} */
// ビューポートオブジェクトをエクスポート
export const viewport = {
  themeColor: 'black', // テーマカラーを黒に設定
}
```

## バージョン履歴

| Version   | Changes                                       |
| --------- | --------------------------------------------- |
| `v14.0.0` | `viewport`と`generateViewport`が導入されました。 |
---
title: 'fetch'
description: '拡張されたfetch関数のAPIリファレンス；'
---

Next.jsは、サーバー上の各リクエストがその独自の永続的なキャッシングと再検証のセマンティクスを設定できるように、[Web `fetch()` API](https://developer.mozilla.org/docs/Web/API/Fetch_API)を拡張しています；

ブラウザにおいて、`cache` オプションはフェッチリクエストが_ブラウザの_HTTPキャッシュとどのように相互作用するかを示します；この拡張により、`cache` は_サーバーサイド_のフェッチリクエストがフレームワークの永続的な[データキャッシュ](/docs/app/building-your-application/caching#data-cache)とどのように相互作用するかを示します；

`fetch` を `async` と `await` を用いて直接サーバーコンポーネント内で呼び出すことができます；

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
export default async function Page() {
  let data = await fetch('https://api.vercel.app/blog')
  let posts = await data.json()
  return (
    <ul>
      {posts.map((post) => (
        <li key={post.id}>{post.title}</li>
      ))}
    </ul>
  )
}
```
</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
export default async function Page() {
  let data = await fetch('https://api.vercel.app/blog')
  let posts = await data.json()
  return (
    <ul>
      {posts.map((post) => (
        <li key={post.id}>{post.title}</li>
      ))}
    </ul>
  )
}
```
</TabItem>
</Tabs>

## `fetch(url, options)` {#fetch-url-options}

Next.jsは[Web `fetch()` API](https://developer.mozilla.org/docs/Web/API/Fetch_API)を拡張しているため、[利用可能なネイティブオプション](https://developer.mozilla.org/docs/Web/API/fetch#parameters)を使用できます；

### `options.cache` {#options-cache}

リクエストがNext.jsの[データキャッシュ](/docs/app/building-your-application/caching#data-cache)とどのように相互作用するかを設定します；

```ts
fetch(`https://...`, { cache: 'force-cache' | 'no-store' })
```

- **`force-cache`**（デフォルト）: Next.jsはデータキャッシュの中から一致するリクエストを探します
  - 一致するリクエストが存在し、新鮮である場合は、キャッシュから返されます
  - 一致するリクエストが存在しない、または古くなっている場合、Next.jsはリモートサーバーからリソースをフェッチし、ダウンロードしたリソースでキャッシュを更新します
- **`no-store`**: Next.jsは、キャッシュをチェックせずにリモートサーバーからリソースを毎回フェッチし、ダウンロードしたリソースでキャッシュを更新しません；

### `options.next.revalidate` {#options-next-revalidate}

```ts
fetch(`https://...`, { next: { revalidate: false | 0 | number } })
```

リソースのキャッシュ寿命を（秒単位で）設定します；

- **`false`** - リソースを無期限にキャッシュします； `revalidate: Infinity`にセマンティックに等しいです；HTTPキャッシュは時間とともに古いリソースを削除する場合があります；
- **`0`** - リソースのキャッシュを防ぎます；
- **`number`** - （秒数）リソースが最大で `n` 秒のキャッシュ寿命を持つべきであることを指定します；

> **知っておくと良いこと**:
>
> - 個々の`fetch()`リクエストが、ルートの[デフォルトの`revalidate`](/docs/app/api-reference/file-conventions/route-segment-config#revalidate)よりも低い`revalidate`数を設定した場合、ルート全体の再検証間隔が短縮されます；
> - 同じルート内で同じURLを持つ2つのフェッチリクエストが異なる`revalidate`値を持つ場合、より低い値が使用されます；
> - 便利なことに、`revalidate`が数値に設定されている場合、`cache`オプションを設定する必要はありません；
> - `{ revalidate: 3600, cache: 'no-store' }`のような矛盾したオプションはエラーを引き起こします；

### `options.next.tags` {#options-next-tags}

```ts
fetch(`https://...`, { next: { tags: ['collection'] } })
```

リソースのキャッシュタグを設定します；データは[`revalidateTag`](https://nextjs.org/docs/app/api-reference/functions/revalidateTag)を使用してオンデマンドで再検証できます；カスタムタグの最大長は256文字で、タグ項目の最大数は64です；

## トラブルシューティング {#troubleshooting}

### 開発環境でFetch `cache: 'no-store'`が新しいデータを表示しない {#fetch-cache-no-store-not-showing-fresh-data-in-development}

Next.jsは、ローカル開発での高速なレスポンスと課金されるAPIコールのコストを削減するために、ホットモジュール置換（HMR）中のサーバーコンポーネントで`fetch`のレスポンスをキャッシュします；

デフォルトでは、[HMRキャッシュ](/docs/app/api-reference/next-config-js/serverComponentsHmrCache)は`cache: 'no-store'`オプションを含むすべてのフェッチリクエストに適用されます；このため、キャッシュされていないリクエストはHMRの更新間で新しいデータを表示しません；ただし、ナビゲーションやページ全体のリロード時にはキャッシュがクリアされます；

詳細については[`serverComponentsHmrCache`](/docs/app/api-reference/next-config-js/serverComponentsHmrCache)のドキュメントをご覧ください；

## バージョン履歴 {#version-history}

| バージョン | 変更内容        |
| ---------- | ---------------- |
| `v13.0.0`  | `fetch`が導入されました |

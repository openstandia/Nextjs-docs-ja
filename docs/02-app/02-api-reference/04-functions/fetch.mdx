---
title: 'fetch'
description: '拡張されたfetch関数のAPIリファレンスです。'
---

Next.jsは、サーバー上で各リクエストが独自の持続的なキャッシュと再検証セマンティクスを設定できるように、[Web `fetch()` API](https://developer.mozilla.org/docs/Web/API/Fetch_API)を拡張しています。

ブラウザでは、`cache`オプションはフェッチリクエストが_ブラウザの_HTTPキャッシュとどのようにやり取りするかを示します。この拡張により、`cache`は_サーバーサイドの_フェッチリクエストがフレームワークの持続的な[Data Cache](/docs/app/building-your-application/caching#data-cache)とどのようにやり取りするかを示します。

サーバーコンポーネント内で、`fetch`を`async`と`await`と共に直接呼び出すことができます。

<Tabs>
<TabItem value="tsx" label="TypeScript">

```tsx title="app/page.tsx" switcher
export default async function Page() {
  let data = await fetch('https://api.vercel.app/blog')
  let posts = await data.json()
  return (
    <ul>
      {posts.map((post) => (
        <li key={post.id}>{post.title}</li>
      ))}
    </ul>
  )
}
```
</TabItem>
<TabItem value="jsx" label="JavaScript">

```jsx title="app/page.js" switcher
export default async function Page() {
  let data = await fetch('https://api.vercel.app/blog')
  let posts = await data.json()
  return (
    <ul>
      {posts.map((post) => (
        <li key={post.id}>{post.title}</li>
      ))}
    </ul>
  )
}
```
</TabItem>
</Tabs>


## `fetch(url, options)`

Next.jsは[Web `fetch()` API](https://developer.mozilla.org/docs/Web/API/Fetch_API)を拡張しているため、[ネイティブオプション](https://developer.mozilla.org/docs/Web/API/fetch#parameters)を自由に利用できます。

### `options.cache`

リクエストがNext.jsの[Data Cache](/docs/app/building-your-application/caching#data-cache)とどのようにやり取りするかを設定します。

```ts
fetch(`https://...`, { cache: 'force-cache' | 'no-store' })
```

- **`force-cache`**（デフォルト）: Next.jsはData Cache内の一致するリクエストを探します
  - 一致があり、それが新鮮な場合はキャッシュから返されます
  - 一致がないか古い一致の場合、Next.jsはリモートサーバーからリソースをフェッチし、ダウンロードされたリソースでキャッシュを更新します
- **`no-store`**: Next.jsは毎回キャッシュを確認せずにリモートサーバーからリソースをフェッチし、ダウンロードされたリソースでキャッシュは更新しません

### `options.next.revalidate`

```ts
fetch(`https://...`, { next: { revalidate: false | 0 | number } })
```

リソースのキャッシュ寿命を秒単位で設定します。

- **`false`** - リソースを無期限にキャッシュします。セマンティクス的には`revalidate: Infinity`に相当します。HTTPキャッシュは時間とともに古いリソースを削除することがあります。
- **`0`** - リソースのキャッシュを防ぐ
- **`number`** - （秒単位で）リソースに最大で`n`秒のキャッシュ寿命を持たせる

> **Good to know**:
>
> - 個々の`fetch()`リクエストがルートの[デフォルト`revalidate`](/docs/app/api-reference/file-conventions/route-segment-config#revalidate)より低い`revalidate`数を設定する場合、ルート全体の再検証間隔が短縮されます。
> - 同じルート内で同じURLの2つのフェッチリクエストが異なる`revalidate`値を持つ場合、低い方の値が使用されます。
> - 便宜上、`revalidate`を数値で設定する場合は、`cache`オプションを設定する必要はありません。
> - `{ revalidate: 3600, cache: 'no-store' }`のような矛盾するオプションはエラーを引き起こします。

### `options.next.tags`

```ts
fetch(`https://...`, { next: { tags: ['collection'] } })
```

リソースのキャッシュタグを設定します。データは、[`revalidateTag`](https://nextjs.org/docs/app/api-reference/functions/revalidateTag)を使用してオンデマンドで再検証できます。カスタムタグの最大長は256文字で、最大タグアイテム数は64です。

## トラブルシューティング

### 開発環境で`cache: 'no-store'`のフェッチが新しいデータを表示しない

Next.jsは、ローカル開発においてコスト削減や応答速度向上のために、Hot Module Replacement (HMR)中にサーバーコンポーネントでの`fetch`レスポンスをキャッシュします。

デフォルトでは、[HMRキャッシュ](/docs/app/api-reference/next-config-js/serverComponentsHmrCache)は全てのフェッチリクエストに適用され、`cache: 'no-store'`オプションを持つリクエストも含まれます。これにより、未キャッシュのリクエストではHMRリフレッシュ間で新しいデータが表示されません。ただし、ナビゲーションやフルページのリロード時にはキャッシュはクリアされます。

詳細については、[`serverComponentsHmrCache`](/docs/app/api-reference/next-config-js/serverComponentsHmrCache)ドキュメントを参照してください。

## バージョン履歴

| バージョン   | 変更点          |
| --------- | ---------------- |
| `v13.0.0` | `fetch`が導入されました |

---
title: 'exportPathMap（廃止予定）'
nav_title: 'exportPathMap'
description: '`next export`を使用する際にHTMLファイルとしてエクスポートされるページをカスタマイズします。'
---

{/* このドキュメントの内容は、app router と pages router の間で共有されています。Pages Router に特化したコンテンツを追加するには、`<PagesOnly>Content</PagesOnly>` コンポーネントを使用できます。共有されたコンテンツはコンポーネントでラップしないでください。 */}

> この機能は `next export` に限定されており、現在は `pages` と `getStaticPaths`、または `app` と `generateStaticParams` の使用が推奨されています。

<details>
  <summary>例</summary>

- [Static Export](https://github.com/vercel/next.js/tree/canary/examples/with-static-export)

</details>

`exportPathMap` を使用すると、エクスポート時にリクエストパスをページの宛先にマッピングすることができます。`exportPathMap` に定義されたパスは、[`next dev`](/docs/app/api-reference/cli/next#next-dev-options)を使用している場合にも利用可能です。

次に例を示します。この例では、以下のページを持つアプリのためのカスタム `exportPathMap` を作成します。

- `pages/index.js`
- `pages/about.js`
- `pages/post.js`

`next.config.js` を開き、以下の `exportPathMap` 設定を追加します：

```js title="next.config.js"
module.exports = {
  exportPathMap: async function (
    defaultPathMap,
    { dev, dir, outDir, distDir, buildId }
  ) {
    return {
      '/': { page: '/' },
      '/about': { page: '/about' },
      '/p/hello-nextjs': { page: '/post', query: { title: 'hello-nextjs' } },
      '/p/learn-nextjs': { page: '/post', query: { title: 'learn-nextjs' } },
      '/p/deploy-nextjs': { page: '/post', query: { title: 'deploy-nextjs' } },
    }
  },
}
```

> **Good to know**: `exportPathMap` 内の `query` フィールドは、[自動的に静的最適化されたページ](https://nextjs.org/docs/canary/pages/building-your-application/rendering/automatic-static-optimization)や [`getStaticProps` ページ](https://nextjs.org/docs/canary/pages/building-your-application/data-fetching/get-static-props)では使用できません。これらのページはビルド時にHTMLファイルとしてレンダリングされ、`next export` 中に追加のクエリ情報を提供することはできません。

ページはその後、HTMLファイルとしてエクスポートされます。たとえば、`/about` は `/about.html` になります。

`exportPathMap` は `async` 関数で、2つの引数を受け取ります。1つ目の引数は Next.js によって使用されるデフォルトのマップである `defaultPathMap` です。2つ目の引数は次のフィールドを持つオブジェクトです：

- `dev` - `exportPathMap` が開発中に呼び出される場合は `true`。`next export` を実行しているときは `false`。開発中は `exportPathMap` がルートを定義するために使用されます
- `dir` - プロジェクトディレクトリへの絶対パス
- `outDir` - `out/` ディレクトリへの絶対パス（`-o` で構成可能）（#customizing-the-output-directory）。`dev` が `true` の場合、`outDir` の値は `null` になります
- `distDir` - `.next/` ディレクトリへの絶対パス（[`distDir`](https://nextjs.org/docs/canary/pages/api-reference/next-config-js/distDir) 設定で構成可能）
- `buildId` - 生成されたビルドID

返されるオブジェクトは、`key` が `pathname` で `value` が次のフィールドを受け入れるオブジェクトのページマップです：

- `page`: `String` - レンダリングする `pages` ディレクトリ内のページ
- `query`: `Object` - プリレンダリング時に `getInitialProps` に渡される `query` オブジェクト。デフォルトは `{}`

> エクスポートされた `pathname` はファイル名とすることも可能です（たとえば、`/readme.md`）。ただし、その内容を提供する際に `.html` とは異なる場合は、`Content-Type` ヘッダーを `text/html` に設定する必要があるかもしれません。

## 末尾のスラッシュを追加する

Next.js を設定して、ページを `index.html` ファイルとしてエクスポートし、末尾にスラッシュを要求するようにすることができます。たとえば、`/about` は `/about/index.html` となり、`/about/` を介してルーティング可能になります。この動作は Next.js 9 以前のデフォルトの動作でした。

以前の動作に戻り、末尾にスラッシュを追加するには、`next.config.js` を開いて `trailingSlash` 設定を有効にします：

```js title="next.config.js"
module.exports = {
  trailingSlash: true,
}
```

## 出力ディレクトリのカスタマイズ

<AppOnly>

[`next export`](/docs/app/building-your-application/deploying/static-exports) はデフォルトで `out` を出力ディレクトリとして使用します。`-o` 引数を使用してカスタマイズすることができます：

</AppOnly>

<PagesOnly>

[`next export`](https://nextjs.org/docs/canary/pages/building-your-application/deploying/static-exports) はデフォルトで `out` を出力ディレクトリとして使用します。`-o` 引数を使用してカスタマイズすることができます：

</PagesOnly>

```bash title="Terminal"
next export -o outdir
```

> **注意**: `exportPathMap` を使用することは廃止されており、`pages` 内の `getStaticPaths` で上書きされます。これらを一緒に使用することは推奨されません。
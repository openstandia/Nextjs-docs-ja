---
title: 'プロダクションチェックリスト'
description: 'Next.jsアプリケーションをプロダクションに導入する前に、最高のパフォーマンスとユーザーエクスペリエンスを確保するための推奨事項を紹介します。'
---

Next.jsアプリケーションをプロダクションに導入する前に、最適なユーザーエクスペリエンス、パフォーマンス、安全性を実現するためのいくつかの最適化やパターンを考慮すべきです。

このページでは、[アプリケーションをビルドするとき](#during-development)、[プロダクションに進む前](#before-going-to-production)、および[デプロイ後](#after-deployment)に参考にできるベストプラクティスと、知っておくべき[Next.jsの自動最適化](#automatic-optimizations)を紹介します。

## 自動最適化 {#automatic-optimizations}

これらのNext.jsの最適化はデフォルトで有効で、設定は不要です：

<AppOnly>

- **[Server Components](/docs/app/building-your-application/rendering/server-components):** Next.jsはデフォルトでServer Componentを使用します。Server Componentはサーバー上で実行され、クライアントサイドでのJavaScriptのレンダリングを必要としません。そのため、クライアントサイドJavaScriptバンドルのサイズに影響を与えません。必要に応じて、インタラクティブ性のために[Client Component](/docs/app/building-your-application/rendering/client-components)を使用できます。
- **[コード分割](/docs/app/building-your-application/routing/linking-and-navigating#how-routing-and-navigation-works):** Server Componentはルートセグメントごとに自動的なコード分割を可能にします。適切な場合は、Client Componentやサードパーティライブラリーの[遅延読み込み](/docs/app/building-your-application/optimizing/lazy-loading)を検討してください。
- **[プリフェッチ](/docs/app/building-your-application/routing/linking-and-navigating#2-prefetching):** 新しいルートへのリンクがユーザーのビューポートに入ると、Next.jsはバックグラウンドでそのルートをプリフェッチします。これにより、新しいルートへのナビゲーションがほぼ瞬時に行われます。必要に応じてプリフェッチをオプトアウトできます。
- **[静的レンダリング](/docs/app/building-your-application/rendering/server-components#static-rendering-default):** Next.jsはビルド時にサーバー上でServer ComponentとClient Componentを静的にレンダリングし、アプリケーションのパフォーマンスを向上させるためにキャッシュします。必要に応じて特定のルートに[動的レンダリング](/docs/app/building-your-application/rendering/server-components#dynamic-rendering)を選択できます。 {/* TODO: PPRが安定したら更新 */}
- **[キャッシング](/docs/app/building-your-application/caching):** Next.jsは、データリクエスト、Server ComponentやClient Componentのレンダリング結果、静的アセットなどをキャッシュして、サーバー、データベース、バックエンドサービスへのネットワークリクエスト数を減らします。必要に応じてキャッシングをオプトアウトすることができます。

</AppOnly>

<PagesOnly>

- **[コード分割](https://nextjs.org/docs/canary/pages/building-your-application/routing/pages-and-layouts):** Next.jsは自動的にアプリケーションコードをページごとにコード分割します。これにより、ナビゲーション時に現在のページに必要なコードだけが読み込まれます。適切な場合は、サードパーティライブラリーの[遅延読み込み](https://nextjs.org/docs/canary/pages/building-your-application/optimizing/lazy-loading)を検討してください。
- **[プリフェッチ](https://nextjs.org/docs/canary/pages/api-reference/components/link#prefetch):** 新しいルートへのリンクがユーザーのビューポートに入ると、Next.jsはバックグラウンドでそのルートをプリフェッチします。これにより、新しいルートへのナビゲーションがほぼ瞬時になります。必要に応じてプリフェッチをオプトアウトしてください。
- **[自動静的最適化](https://nextjs.org/docs/canary/pages/building-your-application/rendering/automatic-static-optimization):** Next.jsはページがブロッキングデータ要件を持たない場合に、ページが静的である（プリレンダリング可能である）と自動的に判断します。最適化されたページはキャッシュされ、エンドユーザーに複数のCDNロケーションから配信されます。必要に応じて[サーバーサイドレンダリング](https://nextjs.org/docs/canary/pages/building-your-application/data-fetching/get-server-side-props)を選択できます。

</PagesOnly>

これらのデフォルト設定は、アプリケーションのパフォーマンスを向上させ、各ネットワークリクエストで転送されるコストとデータ量を削減することを目的としています。

## 開発中に {#during-development}

アプリケーションを構築する際には、以下の機能を使用して、最高のパフォーマンスとユーザーエクスペリエンスを確保することをおすすめします：

### ルーティングとレンダリング {#routing-and-rendering}

<AppOnly>

- **[レイアウト](/docs/app/building-your-application/routing/layouts-and-templates#layouts):** レイアウトを使用して、ページ間でUIを共有し、ナビゲーション時に[部分レンダリング](/docs/app/building-your-application/routing/linking-and-navigating#4-partial-rendering)を可能にします。
- **[`<Link>`コンポーネント](/docs/app/building-your-application/routing/linking-and-navigating#link-component):** `<Link>`コンポーネントを使用して[クライアントサイドナビゲーションとプリフェッチ](/docs/app/building-your-application/routing/linking-and-navigating#how-routing-and-navigation-works)を行います。
- **[エラーハンドリング](/docs/app/building-your-application/routing/error-handling):** カスタムエラーページを作成することで、プロダクションにおいて[全体エラー](/docs/app/building-your-application/routing/error-handling)や[404エラー](/docs/app/api-reference/file-conventions/not-found)を優雅に処理します。
- **[コンポジションパターン](/docs/app/building-your-application/rendering/composition-patterns):** Server ComponentとClient Component向けの推奨されるコンポジションパターンに従い、クライアントサイドJavaScriptバンドルを不必要に増やすことを避けるために[`"use client"`境界](/docs/app/building-your-application/rendering/composition-patterns#moving-client-components-down-the-tree)の配置を確認します。
- **[動的API](/docs/app/building-your-application/rendering/server-components#dynamic-apis):** [`cookies`](/docs/app/api-reference/functions/cookies)や[`searchParams`](/docs/app/api-reference/file-conventions/page#searchparams-optional) propのような動的APIは、ルート全体を[動的レンダリング](/docs/app/building-your-application/rendering/server-components#dynamic-rendering)にオプトインさせることに注意してください（Root Layoutで使用される場合は、アプリケーション全体）。動的APIの使用が意図的であることを確認し、適宜`<Suspense>`境界でラップしてください。

> **知っておくと良い情報**: [部分プリレンダリング（実験的）](https://nextjs.org/blog/next-14#partial-prerendering-preview)は、ルートの一部を動的にすることを可能にし、ルート全体を動的レンダリングにオプトインすることなく行うことができます。

</AppOnly>

<PagesOnly>

- **[`<Link>`コンポーネント](https://nextjs.org/docs/canary/pages/building-your-application/routing/linking-and-navigating):** `<Link>`コンポーネントを使用してクライアントサイドナビゲーションとプリフェッチを行います。
- **[カスタムエラー](https://nextjs.org/docs/canary/pages/building-your-application/routing/custom-error):** 500エラーや404エラーを優雅に処理します。

</PagesOnly>

### データフェッチとキャッシング {#data-fetching-and-caching}

<AppOnly>

- **[Server Component](/docs/app/building-your-application/data-fetching/fetching):** Server Componentsを使用してデータをサーバー上でフェッチするメリットを活用します。
- **[ルートハンドラー](/docs/app/building-your-application/routing/route-handlers):** Client Componentからバックエンドのリソースにアクセスするためにルートハンドラーを使用します。ただし、追加のサーバーリクエストを避けるため、Server Componentsからルートハンドラーを呼び出さないでください。
- **[ストリーミング](/docs/app/building-your-application/routing/loading-ui-and-streaming):** サーバーからクライアントにUIを逐次送信するためにローディングUIとReact Suspenseを使用し、データがフェッチされる間、ルート全体がブロックされるのを防ぎます。
- **[並列データフェッチ](/docs/app/building-your-application/data-fetching/fetching#parallel-and-sequential-data-fetching):** 必要に応じてデータを並列にフェッチすることでネットワークウォーターフォールを縮小します。また、必要に応じてデータを[プリロードすること](/docs/app/building-your-application/data-fetching/fetching#preloading-data)を検討してください。
- **[データキャッシング](/docs/app/building-your-application/caching#data-cache):** データリクエストがキャッシュされているかどうかを確認し、必要に応じてキャッシングを選択します。`fetch`を使用しないリクエストがキャッシュされることを確認し、キャッシュされることを確認してください。
- **[静的画像](/docs/app/building-your-application/optimizing/static-assets):** `public`ディレクトリを使用して、アプリケーションの静的アセット（例：画像）を自動的にキャッシュします。

</AppOnly>

<PagesOnly>

- **[APIルート](https://nextjs.org/docs/canary/pages/building-your-application/routing/api-routes):** ルートハンドラーを使用してバックエンドリソースにアクセスし、クライアントに機密情報をさらさないようにします。
- **[データキャッシング](https://nextjs.org/docs/canary/pages/building-your-application/data-fetching/get-static-props):** データリクエストがキャッシュされているかどうかを確認し、必要に応じてキャッシングを選択します。`getStaticProps`を使用しないリクエストが適切にキャッシュされることを確認してください。
- **[インクリメンタル静的再生成](https://nextjs.org/docs/canary/pages/building-your-application/data-fetching/incremental-static-regeneration):** インクリメンタル静的再生成を使用して静的ページをビルド後に更新し、サイト全体を再ビルドすることなく行います。
- **[静的画像](https://nextjs.org/docs/canary/pages/building-your-application/optimizing/static-assets):** `public`ディレクトリを使用して、アプリケーションの静的アセット（例：画像）を自動的にキャッシュします。

</PagesOnly>

### UIとアクセシビリティ {#ui-and-accessibility}

<AppOnly>

- **[フォームとバリデーション](/docs/app/building-your-application/data-fetching/server-actions-and-mutations#forms):** フォームの送信、サーバーサイドのバリデーション、エラーの処理にServer Actionsを使用します。

</AppOnly>

- **[フォントモジュール](/docs/app/building-your-application/optimizing/fonts):** フォントモジュールを使用してフォントを最適化し、フォントファイルを他の静的アセットと共に自動的にホスティングし、外部ネットワークリクエストを削減し、[レイアウトシフト](https://web.dev/articles/cls)を減らします。
- **[`<Image>`コンポーネント](/docs/app/building-your-application/optimizing/images):** Imageコンポーネントを使用して画像を最適化し、自動的に画像を最適化し、レイアウトシフトを防ぎ、WebPやAVIFなどの現代のフォーマットで画像を提供します。
- **[`<Script>`コンポーネント](/docs/app/building-your-application/optimizing/scripts):** Scriptコンポーネントを使用してサードパーティスクリプトを最適化し、スクリプトを自動的に遅延させ、メインスレッドをブロックしないようにします。
- **[ESLint](/docs/architecture/accessibility#linting):** 組み込みの`eslint-plugin-jsx-a11y`プラグインを使用して、アクセシビリティの問題を早期に発見します。

### セキュリティ {#security}

<AppOnly>

- **[汚染](/docs/app/building-your-application/data-fetching/fetching#preventing-sensitive-data-from-being-exposed-to-the-client):** データオブジェクトや特定の値を汚染することで、機密データがクライアントに露出するのを防ぎます。
- **[Server Actions](/docs/app/building-your-application/data-fetching/server-actions-and-mutations#authentication-and-authorization):** ユーザーがServer Actionsを呼び出す権限があることを確認します。[セキュリティプラクティス](https://nextjs.org/blog/security-nextjs-server-components-actions)を確認してください。

</AppOnly>

- **[環境変数](/docs/app/building-your-application/configuring/environment-variables):** `.env.*`ファイルが`.gitignore`に追加されていることを確認し、公開変数のみが`NEXT_PUBLIC_`でプレフィックスされていることを確認します。
- **[コンテンツセキュリティポリシー](/docs/app/building-your-application/configuring/content-security-policy):** クロスサイトスクリプティング、クリックジャッキング、その他のコードインジェクション攻撃など、さまざまなセキュリティ脅威からアプリケーションを守るために、コンテンツセキュリティポリシーを追加することを検討してください。

### メタデータとSEO {#metadata-and-seo}

<AppOnly>

- **[メタデータAPI](/docs/app/building-your-application/optimizing/metadata):** メタデータAPIを使用して、ページタイトル、説明などを追加し、アプリケーションの検索エンジン最適化（SEO）を向上させます。
- **[Open Graph（OG）画像](/docs/app/api-reference/file-conventions/metadata/opengraph-image):** ソーシャル共有に備えてOG画像を作成します。
- **[サイトマップ](/docs/app/api-reference/functions/generate-sitemaps)および[ロボット](/docs/app/api-reference/file-conventions/metadata/robots):** サーチエンジンがページをクロールし、インデックスするのを助けるために、サイトマップとロボットファイルを生成します。

</AppOnly>

<PagesOnly>

- **[`<Head>`コンポーネント](https://nextjs.org/docs/canary/pages/api-reference/components/head):** `next/head`コンポーネントを使用してページタイトル、説明などを追加します。

</PagesOnly>

### 型安全性 {#type-safety}

- **TypeScriptと[TSプラグイン](/docs/app/building-your-application/configuring/typescript):** TypeScriptとTypeScriptプラグインを使用して、型安全性を向上させ、エラーを早期に発見するのに役立てます。

## プロダクションに進む前に {#before-going-to-production}

プロダクションに進む前に、`next build`を実行してアプリケーションをローカルでビルドし、ビルドエラーをキャッチした後、`next start`を実行してプロダクションに似た環境でアプリケーションのパフォーマンスを測定できます。

### コアWeb指標 {#core-web-vitals}

- **[Lighthouse](https://developers.google.com/web/tools/lighthouse):** インコグニートでLighthouseを実行して、ユーザーがサイトをどのように体験するかをより良く理解し、改善のための領域を特定します。これはシミュレーションされたテストであり、コアWeb指標などのフィールドデータの検討と組み合わせる必要があります。

<AppOnly>

- **[`useReportWebVitals`フック](/docs/app/api-reference/functions/use-report-web-vitals):** このフックを使用して、[コアWeb指標](https://web.dev/articles/vitals)データを分析ツールに送信します。

</AppOnly>

### バンドルの分析 {#analyzing-bundles}

[`@next/bundle-analyzer`プラグイン](/docs/app/building-your-application/optimizing/package-bundling#analyzing-javascript-bundles)を使用して、JavaScriptバンドルのサイズを分析し、アプリケーションのパフォーマンスに影響を与える可能性のある大きなモジュールや依存関係を特定します。

さらに、次のツールはアプリケーションに新しい依存関係を追加することの影響を理解するのに役立ちます：

- [Import Cost](https://marketplace.visualstudio.com/items?itemName=wix.vscode-import-cost)
- [Package Phobia](https://packagephobia.com/)
- [Bundle Phobia](https://bundlephobia.com/)
- [bundlejs](https://bundlejs.com/)

## デプロイ後 {#after-deployment}

アプリケーションをどこにデプロイするかによって、アプリケーションのパフォーマンスを監視し、改善するための追加のツールや統合にアクセスできる場合があります。

Vercelデプロイメントでは、以下をお勧めします：

- **[分析ツール](https://vercel.com/analytics?utm_source=next-site&utm_campaign=nextjs-docs&utm_medium=docs):** ユニークビジター数、ページビューなど、アプリケーションのトラフィックを理解するのに役立つ組み込みの分析ダッシュボード。
- **[スピードインサイト](https://vercel.com/docs/speed-insights?utm_source=next-site&utm_campaign=nextjs-docs&utm_medium=docs):** 訪問者データに基づく実世界のパフォーマンスインサイトを提供し、フィールド内でのWebサイトの実際のパフォーマンスを把握するのに役立つツール。
- **[ログ](https://vercel.com/docs/observability/runtime-logs?utm_source=next-site&utm_campaign=nextjs-docs&utm_medium=docs):** プロダクションでアプリケーションをデバッグし、監視するためのランタイムおよびアクティビティログ。もしくは、[統合ページ](https://vercel.com/integrations?utm_source=next-site&utm_campaign=nextjs-docs&utm_medium=docs)を参照してサードパーティのツールやサービスのリストを確認する。

> **知っておくと良い情報:**
>
> Vercelでのプロダクションデプロイメントのベストプラクティスを包括的に理解するには、Webサイトのパフォーマンス向上のための詳細な戦略を含む[Vercelプロダクションチェックリスト](https://vercel.com/docs/production-checklist?utm_source=next-site&utm_campaign=nextjs-docs&utm_medium=docs)を参照してください。

これらの推奨事項に従うことで、ユーザーにとって、より高速で信頼性が高く安全なアプリケーションを構築するのに役立ちます。
